<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @reamsid_L DBE-3000-030  lijia -->
<mapper namespace="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.relate.ninteishinsakaiiinguide.INinteiShinsakaiIinGuideMapper">

    <resultMap id="result_NinteiShinsakaiIinGuideEntity" type="jp.co.ndensan.reams.db.dbz.entity.db.relate.ninteishinsakaiiinguide.NinteiShinsakaiIinGuideEntity" autoMapping="true">
        <result column="shinsakaiIinCode" property="shinsakaiIinCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result column="shinsakaiIinShimei" property="shinsakaiIinName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler" />
        <result column="shinsakaiIinKanaShimei" property="shinsakaiIinKanaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaKanaMeishoTypeHandler" />
        <result column="seibetsu" property="seibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result column="shinsakaiIinShikakuCode" property="shinsakaiIinShikaku" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
    </resultMap>

    <select resultOrdered="true" id="get審査会委員一覧情報" resultMap="result_NinteiShinsakaiIinGuideEntity" 
            parameterType="jp.co.ndensan.reams.db.dbz.definition.mybatisprm.ninteishinsakaiiinguide.NinteiShinsakaiIinGuideMapperParameter">
        SELECT
        rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinCode" AS "shinsakaiIinCode",
        rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShimei" AS "shinsakaiIinShimei",
        rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinKanaShimei" AS "shinsakaiIinKanaShimei",
        rgdb."DbT5594ShinsakaiIinJoho"."seibetsu" AS "seibetsu",
        rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShikakuCode" AS "shinsakaiIinShikakuCode" 
        FROM
        rgdb."DbT5594ShinsakaiIinJoho"
        <where>        
            <if test="isShinsakaiIinKaishiYMDFlag">
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinCode" <![CDATA[>=]]> #{shinsakaiIinCodeFrom}
            </if>
            <if test="isShinsakaiIinShuryoYMDFlag">
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinCode" <![CDATA[<=]]> #{shinsakaiIinCodeTo}
            </if>
            <if test="isShinsakaiIinShimeiFlag">
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShimei"  LIKE '%' || #{shinsakaiIinShimei} || '%' 
            </if>
            <if test="isSeibetsuFlag">
                AND rgdb."DbT5594ShinsakaiIinJoho"."seibetsu" = #{seibetsu}
            </if>
            <if test="isShinsakaiIinShikakuCodeFlag">
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShikakuCode" = #{shinsakaiIinShikakuCode}
            </if>
            <if test="kikenFlag.toString() == 'key0'">
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinKaishiYMD" <![CDATA[<=]]> #{systemDate}
                AND rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShuryoYMD" <![CDATA[>=]]> #{systemDate}
            </if>
            <if test="kikenFlag.toString() == 'key2'">
                AND (rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinKaishiYMD" <![CDATA[>=]]> #{systemDate}
                OR rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinShuryoYMD" <![CDATA[<=]]> #{systemDate})
            </if>
            <if test="haishiFlag.toString() == 1">
                AND rgdb."DbT5594ShinsakaiIinJoho"."haishiFlag" = true
            </if>
            <if test="haishiFlag.toString() == 2">
                AND rgdb."DbT5594ShinsakaiIinJoho"."haishiFlag" = false
            </if>
            <if test="isShosaiJoken">
                AND EXISTS (
                SELECT
                'X'
                FROM
                rgdb."DbT5595KaigoNinteiShinsakaiIinShozokuKikanJoho" as DbT5595
                WHERE
                rgdb."DbT5594ShinsakaiIinJoho"."shinsakaiIinCode" = DbT5595."shinsakaiIinCode"
                <if test="isShujiiIryokikanCodeFlag">
                    AND DbT5595."shujiiIryokikanCode" = #{shujiiIryokikanCode}
                </if>
                <if test="isNinteiChosainNoFlag">
                    AND DbT5595."ninteichosaItakusakiCode" = #{ninteiChosainNo}
                </if> 
                <if test="isSonotaKikanCodeFlag">
                    AND DbT5595."sonotaKikanCode" = #{sonotaKikanCode}
                </if>
                <if test="isShoKisaiHokenshaNoFlag">
                    AND DbT5595."shoKisaiHokenshaNo" = #{shoKisaiHokenshaNo}
                </if>
                )
            </if>
        </where>
        LIMIT(#{maxKensu})
    </select>
</mapper>