<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 調査委託先＆調査員ガイドの取得のマッピング用XMLです。 -->
<mapper namespace="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.chosaitakusakiandchosainguide.IChosaItakusakiAndChosainGuideMapper">
 <resultMap id="resultMap_getKijuntsukiShichosonjoho" type="jp.co.ndensan.reams.db.dbz.entity.db.relate.iknijuntsukishichosonjoho.IKijuntsukiShichosonjohoRelateEntity" autoMapping="true">
        <result property="ninteichosaItakusakiCode" column="DbT4910_ninteichosaItakusakiCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jigyoshaMeisho" column="DbT4910_jigyoshaMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jigyoshaMeishoKana" column="DbT4910_jigyoshaMeishoKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosaItakuKubun" column="DbT4910_chosaItakuKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jokyoFlag" column="DbT4910_jokyoFlag" />
        <result property="ninteiChosainCode" column="DbT4913_ninteiChosainCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosainShimei" column="DbT4913_chosainShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosainKanaShimei" column="DbT4913_chosainKanaShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jokyoFlag2" column="DbT4913_jokyoFlag" />  
    </resultMap>
    <select id="getKijuntsukiShichosonjoho" resultMap="resultMap_getKijuntsukiShichosonjoho" parameterType="jp.co.ndensan.reams.db.dbz.definition.param.ikninteichosaitakusakijoho.ChosaItakusakiAndChosainGuideParameter" fetchSize="500">
        SELECT
           DbT4910."ninteichosaItakusakiCode" as "DbT4910_ninteichosaItakusakiCode" ,
           DbT4910."jigyoshaMeisho" as "DbT4910_jigyoshaMeisho",
           DbT4910."jigyoshaMeishoKana" as"DbT4910_jigyoshaMeishoKana" ,
           DbT4910."chosaItakuKubun" as "DbT4910_chosaItakuKubun" ,
           DbT4910."jokyoFlag" as "DbT4910_jokyoFlag",
           DbT4913."ninteiChosainCode" as"DbT4913_ninteiChosainCode" ,
           DbT4913."chosainShimei" as "DbT4913_chosainShimei",
           DbT4913."chosainKanaShimei" as "DbT4913_chosainKanaShimei",
           DbT4913."jokyoFlag" as "DbT4913_jokyoFlag"
           FROM
            rgdb."DbT4910NinteichosaItakusakiJoho" as DbT4910
           LEFT JOIN
            rgdb."DbT4913ChosainJoho" as DbT4913
           ON
            DbT4910."ninteichosaItakusakiCode" = DbT4913."ninteiChosaItakusakiCode"
           AND
            DbT4910."shichosonCode" = DbT4913."shichosonCode"
           <if test="認定調査員コードFROMフラグ">
               AND
               DbT4913."ninteiChosaItakusakiCode" <![CDATA[>=]]> #{認定調査員コードFROM}   
           </if>
           <if test="認定調査員コードToフラグ">
              AND
              DbT4913."ninteiChosaItakusakiCode" <![CDATA[<=]]> #{認定調査員コードTo}
           </if>
           <if test="調査員状況フラグ">
               AND
               DbT4913."jokyoFlag" = TRUE
           </if>
           <if test="認定調査状況無効フラグ">
               AND
               DbT4913."jokyoFlag" = FALSE
           </if>
           <if test="調査員名称フラグ">
              AND
               DbT4913."chosainShimei" LIKE '%'||#{調査員名称}||'%'
           </if>
           <if test="調査員カナフラグ">
              AND
                DbT4913."chosainKanaShimei" LIKE '%'||#{調査員カナ}||'%'
           </if>   
           WHERE
            DbT4913."shichosonCode" =#{市町村コード}
           <if test="認定調査委託先コードFROMフラグ">
               AND
                DbT4910."ninteichosaItakusakiCode"<![CDATA[>=]]> #{認定調査委託先コードFROM}
          </if>
          <if test="認定調査委託先コードToフラグ">
              AND
                DbT4910."ninteichosaItakusakiCode"<![CDATA[<=]]> #{認定調査委託先コードTo} 
          </if>
          <if test="認定調査状況フラグ">
             AND 
             DbT4910."jokyoFlag" = TRUE    
          </if>
          <if test="認定調査状況無効フラグ">
             AND
             DbT4910."jokyoFlag" = FALSE
          </if>
          <if test="認定調査委託先名称フラグ">
             AND
               DbT4910."jigyoshaMeisho" LIKE '%'||#{認定調査委託先名称}||'%'             
          </if>
          <if test="認定調査委託先カナフラグ">
              AND
               DbT4910."jigyoshaMeishoKana"  LIKE '%'||#{認定調査委託先カナ}||'%'  
          </if>
          <if test="usesSaidaiHyojiKensu" >
              LIMIT #{saidaiHyojiKensu}
          </if>
           
    </select>
    <select id="getKijuntsukiShichoson" resultMap="resultMap_getKijuntsukiShichosonjoho" 
            parameterType="jp.co.ndensan.reams.db.dbz.definition.param.ikninteichosaitakusakijoho.ChosaItakusakiAndChosainGuideParameter" fetchSize="500">
        SELECT
           DbT5910."ninteichosaItakusakiCode" as "DbT4910_ninteichosaItakusakiCode" ,
           DbT5910."jigyoshaMeisho" as "DbT4910_jigyoshaMeisho",
           DbT5910."jigyoshaMeishoKana" as"DbT4910_jigyoshaMeishoKana" ,
           DbT5910."chosaItakuKubun" as "DbT4910_chosaItakuKubun" ,
           DbT5910."jokyoFlag" as "DbT4910_jokyoFlag",
           DbT5913."ninteiChosainCode" as"DbT4913_ninteiChosainCode" ,
           DbT5913."chosainShimei" as "DbT4913_chosainShimei",
           DbT5913."chosainKanaShimei" as "DbT4913_chosainKanaShimei",
           DbT5913."jokyoFlag" as "DbT4913_jokyoFlag"
           FROM
            rgdb."DbT5910NinteichosaItakusakiJoho" as DbT5910
           LEFT JOIN
            rgdb."DbT5913ChosainJoho" as DbT5913
           ON
            DbT5910."ninteichosaItakusakiCode" = DbT5913."ninteiChosaItakusakiCode"
           AND
            DbT5910."shichosonCode" = DbT5913."shichosonCode"
             <if test="認定調査員コードFROMフラグ">
               AND
               DbT5913."ninteiChosaItakusakiCode" <![CDATA[>=]]> #{認定調査員コードFROM}   
           </if>
           <if test="認定調査員コードToフラグ">
              AND
              DbT5913."ninteiChosaItakusakiCode" <![CDATA[<=]]> #{認定調査員コードTo}
           </if>
           <if test="調査員状況フラグ">
               AND
               DbT5913."jokyoFlag" = TRUE
           </if>
           <if test="認定調査状況無効フラグ">
               AND
               DbT5913."jokyoFlag" = FALSE
           </if>
           <if test="調査員名称フラグ">
              AND
               DbT5913."chosainShimei" LIKE '%'||#{調査員名称}||'%'
           </if>
           <if test="調査員カナフラグ">
              AND
                DbT5913."chosainKanaShimei" LIKE '%'||#{調査員カナ}||'%'
           </if>
            WHERE
            DbT5913."shichosonCode" =#{市町村コード}
             <if test="認定調査委託先コードFROMフラグ">
               AND
                DbT5910."ninteichosaItakusakiCode"<![CDATA[>=]]> #{認定調査委託先コードFROM}
          </if>
          <if test="認定調査委託先コードToフラグ">
              AND
                DbT5910."ninteichosaItakusakiCode"<![CDATA[<=]]> #{認定調査委託先コードTo} 
          </if>
          <if test="認定調査状況フラグ">
             AND 
             DbT5910."jokyoFlag" = TRUE    
          </if>
          <if test="認定調査状況無効フラグ">
             AND
             DbT5910."jokyoFlag" = FALSE
          </if>
          <if test="認定調査委託先名称フラグ">
             AND
               DbT5910."jigyoshaMeisho" LIKE '%'||#{認定調査委託先名称}||'%'             
          </if>
          <if test="認定調査委託先カナフラグ">
              AND
               DbT5910."jigyoshaMeishoKana"  LIKE '%'||#{認定調査委託先カナ}||'%'  
          </if>
          <if test="usesSaidaiHyojiKensu" >
              LIMIT #{saidaiHyojiKensu}
          </if>
           
    </select>
</mapper>

