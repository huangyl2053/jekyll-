<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @reamsid_L DBD-4910-040 donghj -->
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->


<mapper namespace="jp.co.ndensan.reams.db.dbd.persistence.db.mapper.relate.hikazenenkintaishoshadoutei.IShimeiKanaTotsugoMapper">

    <resultMap id="resultMap_該当年金情報なし一時" type="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd8100202.ShimeiKanaTotsugoResultEntity" autoMapping="true">
        <result property="dtレコード区分" column="dtRekoDoKubunn" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt市町村コード" column="dtShichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt年金保険者コード" column="dtNennkinnHokenshaCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt通知内容コード" column="dtTsuuchiContentCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt予備1" column="dtYobi1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt制度コード" column="dtSeidoCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt作成年月日" column="dtCreateYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearTypeHandler" />
        <result property="dt基礎年金番号" column="dtKisoNennkinnNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt年金コード" column="dtNennkinnCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt予備2" column="dtYobi2" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt生年月日" column="dtSeinenngappi" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt性別" column="dtSeibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dtカナ氏名" column="dtKanaShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dtシフトコード1" column="dtShifutoCode1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt漢字氏名" column="dtKanjiShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dtシフトコード2" column="dtShifutoCode2" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt郵便番号" column="dtYubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler" />
        <result property="dtカナ住所" column="dtKanajusyo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dtシフトコード3" column="dtShifutoCode3" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt漢字住所" column="dtKanjijusyo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dtシフトコード4" column="dtShifutoCode4" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt対象年" column="dtTaisyoYear" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt訂正表示" column="dtTeiseiHyouji" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt各種区分" column="dtKakushuKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt処理結果" column="dtShoriResult" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt予備3" column="dtYobi3" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt予備4" column="dtYobi4" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt金額1" column="dtkinngaku1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="dt金額予備1" column="dtKinngakuYobi1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="dt金額予備2" column="dtKinngakuYobi2" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="dt予備5" column="dtYobi5" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt共済年金証書記号番号" column="dtKyousaiNennkinnShoushoKigouNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="被保険者番号" column="hihokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler" />
        <result property="識別コード" column="shikibetsuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ShikibetsuCodeTypeHandler" />
        <result property="世帯コード" column="shotaiCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="宛名カナ氏名" column="atenaKanaShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="宛名生年月日" column="atenaSeinenngappi" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="宛名性別" column="atenaSeibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />

    </resultMap>

    <select id="get氏名カナ突合結果一時" resultMap="resultMap_該当年金情報なし一時" resultOrdered="true" fetchSize="500">
        SELECT
        突合対象情報."dtRekoDoKubunn",
        突合対象情報."dtShichosonCode",
        突合対象情報."dtNennkinnHokenshaCode",
        突合対象情報."dtTsuuchiContentCode",
        突合対象情報."dtYobi1",
        突合対象情報."dtSeidoCode",
        突合対象情報."dtCreateYMD",
        突合対象情報."dtKisoNennkinnNo",
        突合対象情報."dtNennkinnCode",
        突合対象情報."dtYobi2",
        突合対象情報."dtSeinenngappi",
        突合対象情報."dtSeibetsu",
        突合対象情報."dtKanaShimei",
        突合対象情報."dtShifutoCode1",
        突合対象情報."dtKanjiShimei",
        突合対象情報."dtShifutoCode2",
        突合対象情報."dtYubinNo",
        突合対象情報."dtKanajusyo",
        突合対象情報."dtShifutoCode3",
        突合対象情報."dtKanjijusyo",
        突合対象情報."dtShifutoCode4",
        突合対象情報."dtTaisyoYear",
        突合対象情報."dtTeiseiHyouji",
        突合対象情報."dtKakushuKubun",
        突合対象情報."dtShoriResult",
        突合対象情報."dtYobi3",
        突合対象情報."dtYobi4",
        突合対象情報."dtkinngaku1",
        突合対象情報."dtKinngakuYobi1",
        突合対象情報."dtKinngakuYobi2",
        突合対象情報."dtYobi5",
        突合対象情報."dtKyousaiNennkinnShoushoKigouNo",
        氏名カナ突合データ."hihokenshaNo",
        氏名カナ突合データ."shikibetsuCode",
        氏名カナ突合データ."shotaiCode",
        氏名カナ突合データ."atenaKanaShimei",
        氏名カナ突合データ."atenaSeinenngappi",
        氏名カナ突合データ."atenaSeibetsu"
        FROM
        "NenkinNoTotsugoGaitouJohoNasiTempTable"
        AS 突合対象情報
        LEFT OUTER JOIN(
        SELECT
        実績."hihokenshaNo",
        実績."shikibetsuCode",
        実績."shotaiCode",
        実績."atenaKanaShimei",
        実績."atenaSeinenngappi",
        実績."atenaSeibetsu"
        FROM
        "JissekiDataIchijiSakuseiTempTable"
        AS 実績
        GROUP BY
        "hihokenshaNo",
        "shikibetsuCode",
        "shotaiCode",
        "atenaKanaShimei",
        "atenaSeinenngappi",
        "atenaSeibetsu"
        )AS 氏名カナ突合データ
        ON 突合対象情報."dtKanaShimei" = 氏名カナ突合データ."atenaKanaShimei"
        AND 突合対象情報."dtSeinenngappi" = 氏名カナ突合データ."atenaSeinenngappi"
        AND 突合対象情報."dtSeibetsu" = 氏名カナ突合データ."atenaSeibetsu"
    </select>

    <resultMap id="resultMap_氏名カナ突合結果一時" type="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd8100202.ShimeiKanaTotsugoKensuJohoEntity" autoMapping="true">
        <result property="dt年金保険者コード" column="dtNennkinnHokenshaCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt年金コード" column="dtNennkinnCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt基礎年金番号" column="dtKisoNennkinnNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt対象年" column="dtTaisyoYear" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="dt作成年月日" column="dtCreateYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler" />
        <result property="件数" column="件数" />
    </resultMap>

    <select id="get氏名カナ突合結果件数一時" resultMap="resultMap_氏名カナ突合結果一時" resultOrdered="true" fetchSize="500">
        SELECT
        氏名カナ突合結果一時."dtNennkinnHokenshaCode"  AS dtNennkinnHokenshaCode,
        氏名カナ突合結果一時."dtNennkinnCode"          AS dtNennkinnCode,
        氏名カナ突合結果一時."dtKisoNennkinnNo"        AS dtKisoNennkinnNo,
        氏名カナ突合結果一時."dtTaisyoYear"        AS dtTaisyoYear,
        氏名カナ突合結果一時."dtCreateYMD"             AS dtCreateYMD,
        COUNT(*)  AS 件数
        FROM
        "ShimeiKanaTotsugoResultTempTable"
        AS 氏名カナ突合結果一時
        GROUP BY
        dtNennkinnHokenshaCode,
        dtNennkinnCode,
        dtKisoNennkinnNo,
        dtTaisyoYear,
        dtCreateYMD
    </select>
    <select id="get非課税年金対象者情報" resultType="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd8100202.ShimeiKanaTotsugoSedJohoEntity" fetchSize="500" resultOrdered="true" >
        SELECT
        A."dtRekoDoKubunn" AS DTレコード区分,
        A."dtShichosonCode" AS DT市町村コード,
        A."dtNennkinnHokenshaCode" AS DT年金保険者コード,
        A."dtTsuuchiContentCode" AS DT通知内容コード,
        A."dtYobi1" AS DT予備1,
        A."dtSeidoCode" AS DT制度コード,
        A."dtCreateYMD" AS DT作成年月日,
        A."dtKisoNennkinnNo" AS DT基礎年金番号,
        A."dtNennkinnCode" AS DT年金コード,
        A."dtYobi2" AS DT予備2,
        A."dtSeinenngappi" AS DT生年月日,
        A."dtSeibetsu" AS DT性別,
        A."dtKanaShimei" AS DTカナ氏名,
        A."dtShifutoCode1" AS DTシフトコード1,
        A."dtKanjiShimei" AS DT漢字氏名,
        A."dtShifutoCode2" AS DTシフトコード2,
        A."dtYubinNo" AS DT郵便番号,
        A."dtKanajusyo" AS DTカナ住所,
        A."dtShifutoCode3" AS DTシフトコード3,
        A."dtKanjijusyo" AS DT漢字住所,
        A."dtShifutoCode4" AS DTシフトコード4,
        A."dtTaisyoYear" AS DT対象年,
        A."dtTeiseiHyouji" AS DT訂正表示,
        A."dtKakushuKubun" AS DT各種区分,
        A."dtShoriResult" AS DT処理結果,
        A."dtYobi3" AS DT予備3,
        A."dtYobi4" AS DT予備4,
        A."dtkinngaku1" AS DT金額1,
        A."dtKinngakuYobi1" AS DT金額予備1,
        A."dtKinngakuYobi2" AS DT金額予備2,
        A."dtYobi5" AS DT予備5,
        A."dtKyousaiNennkinnShoushoKigouNo" AS DT共済年金証書記号番号,
        A."hihokenshaNo" AS 被保険者番号,
        A."shikibetsuCode" AS 識別コード,
        A."shotaiCode" AS 世帯コード,
        A."atenaKanaShimei" AS 宛名カナ氏名,
        A."atenaSeinenngappi" AS 宛名生年月日,
        A."atenaSeibetsu" AS 宛名性別
        FROM "ShimeiKanaTotsugoResultTempTable" AS A
        INNER JOIN
        ( SELECT
        "dtNennkinnHokenshaCode",
        "dtNennkinnCode",
        "dtKisoNennkinnNo",
        "dtTaisyoYear",
        "dtCreateYMD",
        "count"
        FROM
        "ShimeiKanaTotsugoKensuTempTable"
        WHERE
        "count" = 1) AS B
        ON
        A."dtNennkinnHokenshaCode" = B."dtNennkinnHokenshaCode" AND
        A."dtNennkinnCode" = B."dtNennkinnCode" AND
        A."dtKisoNennkinnNo" = B."dtKisoNennkinnNo" AND
        A."dtTaisyoYear" = B."dtTaisyoYear" AND
        A."dtCreateYMD" = B."dtCreateYMD"
        WHERE A."hihokenshaNo" IS NOT NULL AND A."hihokenshaNo" != ''
    </select>

    <select id="get該当者なし情報" resultType="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd8100202.ShimeiKanaTotsugoGaitousyaNasiJohoEntity" fetchSize="500" resultOrdered="true" >
        SELECT
        A."dtRekoDoKubunn" AS DTレコード区分,
        A."dtShichosonCode" AS DT市町村コード,
        A."dtNennkinnHokenshaCode" AS DT年金保険者コード,
        A."dtTsuuchiContentCode" AS DT通知内容コード,
        A."dtYobi1" AS DT予備1,
        A."dtSeidoCode" AS DT制度コード,
        A."dtCreateYMD" AS DT作成年月日,
        A."dtKisoNennkinnNo" AS DT基礎年金番号,
        A."dtNennkinnCode" AS DT年金コード,
        A."dtYobi2" AS DT予備2,
        A."dtSeinenngappi" AS DT生年月日,
        A."dtSeibetsu" AS DT性別,
        A."dtKanaShimei" AS DTカナ氏名,
        A."dtShifutoCode1" AS DTシフトコード1,
        A."dtKanjiShimei" AS DT漢字氏名,
        A."dtShifutoCode2" AS DTシフトコード2,
        A."dtYubinNo" AS DT郵便番号,
        A."dtKanajusyo" AS DTカナ住所,
        A."dtShifutoCode3" AS DTシフトコード3,
        A."dtKanjijusyo" AS DT漢字住所,
        A."dtShifutoCode4" AS DTシフトコード4,
        A."dtTaisyoYear" AS DT対象年,
        A."dtTeiseiHyouji" AS DT訂正表示,
        A."dtKakushuKubun" AS DT各種区分,
        A."dtShoriResult" AS DT処理結果,
        A."dtYobi3" AS DT予備3,
        A."dtYobi4" AS DT予備4,
        A."dtkinngaku1" AS DT金額1,
        A."dtKinngakuYobi1" AS DT金額予備1,
        A."dtKinngakuYobi2" AS DT金額予備2,
        A."dtYobi5" AS DT予備5,
        A."dtKyousaiNennkinnShoushoKigouNo" AS DT共済年金証書記号番号,
        A."hihokenshaNo" AS 被保険者番号,
        A."shikibetsuCode" AS 識別コード,
        A."shotaiCode" AS 世帯コード,
        A."atenaKanaShimei" AS 宛名カナ氏名,
        A."atenaSeinenngappi" AS 宛名生年月日,
        A."atenaSeibetsu" AS 宛名性別
        FROM "ShimeiKanaTotsugoResultTempTable" AS A
        INNER JOIN
        ( SELECT
        "dtNennkinnHokenshaCode",
        "dtNennkinnCode",
        "dtKisoNennkinnNo",
        "dtTaisyoYear",
        "dtCreateYMD",
        "count"
        FROM
        "ShimeiKanaTotsugoKensuTempTable"
        WHERE
        "count" = 1) AS B
        ON A."dtNennkinnHokenshaCode" = B."dtNennkinnHokenshaCode"
        AND A."dtNennkinnCode" = B."dtNennkinnCode"
        AND A."dtKisoNennkinnNo" = B."dtKisoNennkinnNo"
        AND A."dtTaisyoYear" = B."dtTaisyoYear"
        AND A."dtCreateYMD" = B."dtCreateYMD"
        WHERE (A."hihokenshaNo" IS NOT NULL OR A."hihokenshaNo" != '')
    </select>

    <select id="get同一人情報" resultType="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd8100202.ShimeiKanaTotsugoTouItuninJohoEntity" fetchSize="500" resultOrdered="true" >
        SELECT
        A."dtRekoDoKubunn" AS DTレコード区分,
        A."dtShichosonCode" AS DT市町村コード,
        A."dtNennkinnHokenshaCode" AS DT年金保険者コード,
        A."dtTsuuchiContentCode" AS DT通知内容コード,
        A."dtYobi1" AS DT予備1,
        A."dtSeidoCode" AS DT制度コード,
        A."dtCreateYMD" AS DT作成年月日,
        A."dtKisoNennkinnNo" AS DT基礎年金番号,
        A."dtNennkinnCode" AS DT年金コード,
        A."dtYobi2" AS DT予備2,
        A."dtSeinenngappi" AS DT生年月日,
        A."dtSeibetsu" AS DT性別,
        A."dtKanaShimei" AS DTカナ氏名,
        A."dtShifutoCode1" AS DTシフトコード1,
        A."dtKanjiShimei" AS DT漢字氏名,
        A."dtShifutoCode2" AS DTシフトコード2,
        A."dtYubinNo" AS DT郵便番号,
        A."dtKanajusyo" AS DTカナ住所,
        A."dtShifutoCode3" AS DTシフトコード3,
        A."dtKanjijusyo" AS DT漢字住所,
        A."dtShifutoCode4" AS DTシフトコード4,
        A."dtTaisyoYear" AS DT対象年,
        A."dtTeiseiHyouji" AS DT訂正表示,
        A."dtKakushuKubun" AS DT各種区分,
        A."dtShoriResult" AS DT処理結果,
        A."dtYobi3" AS DT予備3,
        A."dtYobi4" AS DT予備4,
        A."dtkinngaku1" AS DT金額1,
        A."dtKinngakuYobi1" AS DT金額予備1,
        A."dtKinngakuYobi2" AS DT金額予備2,
        A."dtYobi5" AS DT予備5,
        A."dtKyousaiNennkinnShoushoKigouNo" AS DT共済年金証書記号番号,
        A."hihokenshaNo" AS 被保険者番号,
        A."shikibetsuCode" AS 識別コード,
        A."shotaiCode" AS 世帯コード,
        A."atenaKanaShimei" AS 宛名カナ氏名,
        A."atenaSeinenngappi" AS 宛名生年月日,
        A."atenaSeibetsu" AS 宛名性別
        FROM "ShimeiKanaTotsugoResultTempTable" AS A
        INNER JOIN
        ( SELECT
        "dtNennkinnHokenshaCode",
        "dtNennkinnCode",
        "dtKisoNennkinnNo",
        "dtTaisyoYear",
        "dtCreateYMD",
        "count"
        FROM
        "ShimeiKanaTotsugoKensuTempTable"
        WHERE
        "count" <![CDATA[>]]> 1) AS B
        ON
        A."dtNennkinnHokenshaCode" = B."dtNennkinnHokenshaCode"
        AND A."dtNennkinnCode" = B."dtNennkinnCode"
        AND A."dtKisoNennkinnNo" = B."dtKisoNennkinnNo"
        AND A."dtTaisyoYear" = B."dtTaisyoYear"
        AND A."dtCreateYMD" = B."dtCreateYMD"
    </select>
</mapper>
