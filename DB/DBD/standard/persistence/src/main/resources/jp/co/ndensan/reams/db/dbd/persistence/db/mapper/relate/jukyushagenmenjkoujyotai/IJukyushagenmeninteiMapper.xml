<?xml version="1.0" encoding="UTF-8"?>
<!--To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.-->

<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @reamsid_L DBD-3770-060 liuwei2 -->
<mapper namespace="jp.co.ndensan.reams.db.dbd.persistence.db.mapper.relate.jukyushagenmenjkoujyotai.IJukyushagenmeninteiMapper">
    <select
        resultOrdered="true"
        id="get認定状況情報"
        parameterType="jp.co.ndensan.reams.db.dbd.definition.mybatisprm.dbd104010.DBD104010MybatisParameter"
        resultMap="ResultMap_NinteiyotaiTwoEntity" fetchSize="500">

        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '01' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '02' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '03' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '04' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE
        NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '05' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '06' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '07' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag

        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '08' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '09' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '10' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '11' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag

        union
        select
        '1' as tableFlag,
        (case when 受給者情報."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '12' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '01' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '02' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '03' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag




        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END )as flag,
        '04' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END )as flag,
        '05' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '06' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' end )as flag,
        '07' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '08' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '09' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '10' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '11' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        select
        '1' as tableFlag,
        (case when 受給者情報."gengakuKubun" = #{減額区分_市町村民税非課税} then '2' when 受給者情報."gengakuKubun" = #{減額区分_老齢福祉年金受給}  then '3' else '4' END)as flag,
        '12' flag1,
        count( case substring(受給者情報."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報."kyuSochishaFlag" =  true then 受給者情報."ketteiYMD" end )as 措置者件数
        from (SELECT
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiKubun",
        "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD",
        "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD",
        "DbT4012HyojunFutangakuGemmen"."gengakuKubun",
        "DbT4012HyojunFutangakuGemmen"."gengakugoKingaku",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4012HyojunFutangakuGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4012HyojunFutangakuGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4012HyojunFutangakuGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4012HyojunFutangakuGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4012HyojunFutangakuGemmen"."tekiyoShuryoYMD"
        </if>)

        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4012HyojunFutangakuGemmen"."hihokenshaNo",
        "DbT4012HyojunFutangakuGemmen"."rirekiNo",
        "DbT4012HyojunFutangakuGemmen"."shinseiYMD",
        "DbT4012HyojunFutangakuGemmen"."ketteiYMD")AS 受給者情報
        group by flag


        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '01' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '02' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '03' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '04' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '05' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '06' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '07' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '08' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '09' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '10' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '11' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when 受給者情報22."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '12' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '01' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '02' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '03' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '04' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報22
        group by tableFlag,flag


        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '05' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '06' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '07' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '08' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '09' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '10' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '11' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag

        union
        SELECT
        '2' as tableFlag,
        (case when  '91' <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '95' THEN '2'
        when '96'  <![CDATA[<=]]> 受給者情報22."kyuhuritsu"  AND 受給者情報22."kyuhuritsu" <![CDATA[<=]]> '99' THEN '3' else '4'  END)as flag,
        '12' flag1,
        count( case substring(受給者情報22."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報22."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報22."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報22."kyuSochishaFlag" =  true then 受給者情報22."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4014RiyoshaFutangakuGengaku"."kyuhuritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4014RiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4014RiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4014RiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4014RiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4014RiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4014RiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4014RiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4014RiyoshaFutangakuGengaku"."ketteiYMD"
        )
        as 受給者情報22
        group by tableFlag,flag



        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '01' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '02' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '03' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '04' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '05' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '06' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '07' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '08' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '09' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '10' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '11' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when 受給者情報33."ketteiKubun"<![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '2'
        when 受給者情報33."ketteiKubun" <![CDATA[=]]> #{決定区分承認する} AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '7'
        else '-1' END)as flag,
        '12' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '01' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '02' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '03' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '04' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '05' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '06' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '07' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '08' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '09' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '10' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag

        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '11' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag


        union
        SELECT
        '3' as tableFlag,
        (case when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '3'
        when '90' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '95' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '8'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '4'
        when '96' <![CDATA[<=]]> 受給者情報33."kyufuritsu" and 受給者情報33."kyufuritsu" <![CDATA[<=]]> '99' AND 受給者情報33."hobetsuKubun" <![CDATA[<>]]> #{法別区分施行時ホームヘルプ} then '9'
        when ('90' <![CDATA[>]]> 受給者情報33."kyufuritsu" or 受給者情報33."kyufuritsu" <![CDATA[>]]> '99') AND 受給者情報33."hobetsuKubun" <![CDATA[=]]> #{法別区分施行時ホームヘルプ} then '5'
        else '10' END)as flag,
        '12' flag1,
        count( case substring(受給者情報33."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報33."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報33."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報33."kyuSochishaFlag" =  true then 受給者情報33."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiKubun",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."kyufuritsu",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hobetsuKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4016HomonKaigoRiyoshaFutangakuGengaku"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."hihokenshaNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."rirekiNo",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."shinseiYMD",
        "DbT4016HomonKaigoRiyoshaFutangakuGengaku"."ketteiYMD"
        )as 受給者情報33
        group by tableFlag,flag



        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '01' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '02' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '03' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag



        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '04' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '05' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '06' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '07' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '08' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '09' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '10' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '11' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '12' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '01' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '02' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '03' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",

        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,

        '04' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '05' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '06' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '07' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '08' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '09' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '10' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '11' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag

        union
        SELECT
        '4' as tableFlag,
        (case when 受給者情報44."keigenritsu_Bunshi" = '12.5' then '2'
        when 受給者情報44."keigenritsu_Bunshi" = '25' then '3'
        when 受給者情報44."keigenritsu_Bunshi" = '50' then '4'
        else '5' END)as flag,
        '12' flag1,
        count( case substring(受給者情報44."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報44."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報44."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報44."kyuSochishaFlag" = true then 受給者情報44."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD",


        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bunshi",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."keigenritsu_Bumbo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kakuninNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."gemmenKubun",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."kyotakuServiceGentei",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"
        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"
        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."hihokenshaNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."rirekiNo",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."shinseiYMD",
        "DbT4017ShakaiFukushiHojinRiyoshaFutanKeigen"."ketteiYMD"
        )
        as  受給者情報44
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '01' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '02' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '03' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'03') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag



        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '04' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '05' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '06' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '07' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '08' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '09' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '10' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '11' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."ketteiKubun" = '1' then '1' else '-1' END)as flag,
        '12' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '01' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '02' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '03' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'03') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,

        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '04' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '05' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '06' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '07' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '08' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '09' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '10' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag


        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '11' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag

        union
        SELECT
        '5' as tableFlag,
        (case when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階1} then '6'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階2} then '5'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階3} then '4'
        when 受給者情報55."riyoshaFutanDankai" = #{利用者負担段階_課税層} then '3'
        else '2' END)as flag,
        '12' flag1,
        count( case substring(受給者情報55."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報55."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報55."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報55."kyuSochishaFlag" = true then 受給者情報55."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyusochishaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."riyoshaFutanDankai",
        "DbT4018KaigoHokenFutanGendogakuNintei"."kyokaisoGaitoshaKubun",
        "DbT4018KaigoHokenFutanGendogakuNintei"."gekihenKanwaSochiTaishoshaKubun",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4018KaigoHokenFutanGendogakuNintei"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4018KaigoHokenFutanGendogakuNintei"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4018KaigoHokenFutanGendogakuNintei"."hihokenshaNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."rirekiNo",
        "DbT4018KaigoHokenFutanGendogakuNintei"."shinseiYMD",
        "DbT4018KaigoHokenFutanGendogakuNintei"."ketteiYMD"
        )
        as  受給者情報55
        group by tableFlag,flag



        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '01' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '02' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '03' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'03') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '04' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '05' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '06' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '07' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '08' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '09' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '10' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '11' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."ketteiKubun" = '1' then '1' else '4' END)as flag,
        '12' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag




        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '01' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'01') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'01')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'01',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0131') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '02' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間終了日},1,4),'02') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'02')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'02',#{基準日付2}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '03' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'03') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間終了日},1,4),'03')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'03',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0331') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag



        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '04' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'04') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'04')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'04',#{基準日付4}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0430') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '05' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'05') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'05')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'05',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0531') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '06' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'06') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'06')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'06',#{基準日付6}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0630') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '07' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'07') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'07')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'07',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0731') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '08' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'08') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'08')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'08',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0831') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '09' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'09') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'09')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'09',#{基準日付9}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'0930') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '10' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'10') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'10')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'10',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1031') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '11' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'11') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'11')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'11',#{基準日付11}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1130') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag


        union
        SELECT
        '6' as tableFlag,
        (case when 受給者情報66."keigenritsu" = '10' then '2' else '3' END)as flag,
        '12' flag1,
        count( case substring(受給者情報66."ketteiYMD",1,6) when concat(substring(#{抽出期間開始日},1,4),'12') then 受給者情報66."ketteiYMD" end )as 月件数,
        count( case when substring(受給者情報66."ketteiYMD",1,6) = concat(substring(#{抽出期間開始日},1,4),'12')
        AND 受給者情報66."kyuSochishaFlag" =true then 受給者情報66."ketteiYMD" end )as 措置者件数
        from
        (SELECT
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiKubun",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."keigenritsu",
        受給."kyuSochishaFlag", 直近被保.*,
        宛名."seinengappiYMD"
        FROM rgdb."DbT4020TokubetsuchiikiKasanGemmen"
        INNER JOIN(
        SELECT
        "DbV1001HihokenshaDaicho"."shichosonCode",
        "DbV1001HihokenshaDaicho"."shikibetsuCode",
        "DbV1001HihokenshaDaicho"."hihokenshaNo",
        "DbV1001HihokenshaDaicho"."koikinaiTokureiSochimotoShichosonCode"
        FROM rgdb."DbV1001HihokenshaDaicho"
        )AS 直近被保
        ON 直近被保."hihokenshaNo" =   "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        INNER JOIN
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmParamClassShikibetsuTaisho"/>
        AS 宛名
        ON
        宛名."shikibetsuCode" = 直近被保."shikibetsuCode"

        INNER JOIN (
        SELECT
        "DbT4001JukyushaDaicho"."hihokenshaNo" AS hihokenshaNo,
        "DbT4001JukyushaDaicho"."ninteiYukoKikanKaishiYMD",
        "DbT4001JukyushaDaicho"."ninteiYukoKikanShuryoYMD",
        "DbT4001JukyushaDaicho"."ninteiYMD",
        "DbT4001JukyushaDaicho"."kyuSochishaFlag",
        "DbT4001JukyushaDaicho"."rirekiNo",
        "DbT4001JukyushaDaicho"."edaban",
        被保.*
        FROM rgdb."DbT4001JukyushaDaicho"

        INNER JOIN (
        SELECT
        "DbT1001HihokenshaDaicho"."shichosonCode",
        "DbT1001HihokenshaDaicho"."shikibetsuCode",
        "DbT1001HihokenshaDaicho"."shikakuShutokuYMD",
        "DbT1001HihokenshaDaicho"."shikakuSoshitsuYMD",
        "DbT1001HihokenshaDaicho"."hihokennshaKubunCode",
        "DbT1001HihokenshaDaicho"."hihokenshaNo",
        "DbT1001HihokenshaDaicho"."idoYMD",
        "DbT1001HihokenshaDaicho"."edaNo"
        FROM rgdb."DbT1001HihokenshaDaicho"
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT1001HihokenshaDaicho" AS 被保2
        WHERE  被保2."hihokenshaNo" = "DbT1001HihokenshaDaicho"."hihokenshaNo"
        AND 被保2."shikakuShutokuYMD" = "DbT1001HihokenshaDaicho"."shikakuShutokuYMD"
        AND ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[<]]> 被保2."idoYMD"
        OR ("DbT1001HihokenshaDaicho"."idoYMD" <![CDATA[=]]> 被保2."idoYMD"
        AND   "DbT1001HihokenshaDaicho"."edaNo" <![CDATA[<]]> 被保2."edaNo"))
        )
        ) AS 被保
        ON 被保."hihokenshaNo" = "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (被保."shikakuShutokuYMD" <![CDATA[<=]]> "DbT4001JukyushaDaicho"."ninteiYMD"
        AND ("DbT4001JukyushaDaicho"."ninteiYMD"  <![CDATA[<=]]> 被保."shikakuSoshitsuYMD"
        OR  被保."shikakuSoshitsuYMD" = '' OR 被保."shikakuSoshitsuYMD" IS NULL))
        WHERE NOT EXISTS(
        SELECT 1
        FROM rgdb."DbT4001JukyushaDaicho" AS 受給3
        WHERE 受給3."hihokenshaNo" =  "DbT4001JukyushaDaicho"."hihokenshaNo"
        AND (受給3."rirekiNo" <![CDATA[>]]>  "DbT4001JukyushaDaicho"."rirekiNo"
        OR ( 受給3."rirekiNo" = "DbT4001JukyushaDaicho"."rirekiNo"
        AND 受給3."edaban" <![CDATA[>]]> "DbT4001JukyushaDaicho"."edaban"))
        )
        )AS 受給
        ON 受給.hihokenshaNo = "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo"
        AND (
        <if test="基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        <if test="!基準日flag" >
            受給."ninteiYukoKikanKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> 受給."ninteiYukoKikanShuryoYMD"
        </if>
        OR 受給."ninteiYukoKikanShuryoYMD" = '')
        WHERE ("DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD" <![CDATA[<=]]> #{抽出期間終了日}
        OR  #{抽出期間開始日} <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD")
        AND (
        <if test="基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日})
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'12',#{基準日}) <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>
        <if test="!基準日flag" >
            "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoKaishiYMD"  <![CDATA[<=]]> concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231')
            AND concat(substring("DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD",1,4),'1231') <![CDATA[<=]]> "DbT4020TokubetsuchiikiKasanGemmen"."tekiyoShuryoYMD"
        </if>)
        <if test="宛名生年月日1" >
            AND #{年齢基準日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日2" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]>  #{年齢基準日to}
        </if>
        <if test="宛名生年月日3" >
            AND #{生年月日from} <![CDATA[<=]]> 宛名."seinengappiYMD"
        </if>
        <if test="宛名生年月日4" >
            AND  宛名."seinengappiYMD" <![CDATA[<=]]> #{生年月日to}
        </if>
        <if test="直近被保" >
            AND  （直近被保."shichosonCode" = #{市町村コード}
            OR 直近被保."koikinaiTokureiSochimotoShichosonCode" = #{市町村コード}）
        </if>
        ORDER BY
        "DbT4020TokubetsuchiikiKasanGemmen"."hihokenshaNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."rirekiNo",
        "DbT4020TokubetsuchiikiKasanGemmen"."shinseiYMD",
        "DbT4020TokubetsuchiikiKasanGemmen"."ketteiYMD"
        )
        as  受給者情報66
        group by tableFlag,flag

        order by tableFlag,flag,flag1
    </select>


    <resultMap id="ResultMap_NinteiyotaiTwoEntity" type="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd104010.NinteiyotaiTwoEntity" autoMapping="true">

        <result property="kensu" column="月件数" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="sotishakensu" column="措置者件数" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="flag" column="flag" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="flag1" column="flag1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />
        <result property="tableFlag" column="tableFlag" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler" />

    </resultMap>
</mapper>
