<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--@reamsid_L DBD-2030-020 x_miaocl-->
<mapper namespace="jp.co.ndensan.reams.db.dbd.persistence.db.mapper.relate.koshinoshirasetsuchi.IKoshinOshiraseTsuchiMapper">
    <resultMap id="resultMap_get帳票出力用情報取得" type="jp.co.ndensan.reams.db.dbd.entity.db.relate.dbd511002.KoshinOshiraseTsuchiUpdateEntity" autoMapping="true">
        <result property="koroshoIfShikibetsuCode" column="厚労省IF識別コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="hihokenshaNo" column="被保険者番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="hihokenshaName" column="被保険者氏名" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="hihokenshaKana" column="被保険者氏名カナ" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaKanaMeishoTypeHandler"/>
        <result property="ninteiShinseiYMD" column="認定申請年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="ninteiShinseiRiyu" column="認定申請理由" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="ninteiShinseiShinseijiKubunCode" column="認定申請区分_申請時_コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="ninteiShinseiHoreiKubunCode" column="認定申請区分_法令_コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="nyushoShisetsuCode" column="入所施設コード" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.JigyoshaNoTypeHandler"/>
        <result property="seinengappiYMD" column="生年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="seibetsu" column="性別" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="telNo" column="電話番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="yubinNo" column="郵便番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="jusho" column="住所" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler"/>
        <result property="shinseishoKanriNo" column="申請書管理番号" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShinseishoKanriNoTypeHandler"/>
        <result property="ninteiYMD" column="認定年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="ninteiYukoKikanKaishiYMD" column="認定有効期間開始年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="ninteiYukoKikanShuryoYMD" column="認定有効期間終了年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="yokaigoJotaiKubunCode" column="要介護認定状態区分コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="shichosonCode" column="市町村コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="shichosonMeisho" column="市町村名称" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jigyoshaNo" column="居宅支援事業者コード" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.JigyoshaNoTypeHandler"/>
        <result property="jigyoshaMeisho" column="居宅支援事業者名称" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jigyoshaName" column="入所施設事業者名称" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaKanaMeishoTypeHandler"/>
        <association property="psmEntity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.UaFt200FindShikibetsuTaishoEntity"/>
    </resultMap>
    <select resultOrdered="true" id="get帳票出力用情報取得"  
            resultMap="resultMap_get帳票出力用情報取得" 
            parameterType="jp.co.ndensan.reams.db.dbd.definition.mybatisprm.dbd511002.KoshinOshiraseTsuchiMyBatisParameter" fetchSize="500">
        SELECT
        要介護認定申請情報."koroshoIfShikibetsuCode" AS 厚労省IF識別コード,
        要介護認定申請情報."hihokenshaNo" AS 被保険者番号,
        要介護認定申請情報."hihokenshaName" AS 被保険者氏名,
        要介護認定申請情報."hihokenshaKana" AS 被保険者氏名カナ,
        要介護認定申請情報."ninteiShinseiYMD" AS 認定申請年月日,
        要介護認定申請情報."ninteiShinseiRiyu" AS 認定申請理由,
        要介護認定申請情報."ninteiShinseiShinseijiKubunCode" AS 認定申請区分_申請時_コード,
        要介護認定申請情報."ninteiShinseiHoreiKubunCode" AS 認定申請区分_法令_コード,
        要介護認定申請情報."nyushoShisetsuCode" AS 入所施設コード,
        要介護認定申請情報."seinengappiYMD" AS 生年月日,
        要介護認定申請情報."seibetsu" AS 性別,
        要介護認定申請情報."telNo" AS 電話番号,
        要介護認定申請情報."yubinNo" AS 郵便番号,
        要介護認定申請情報."jusho" AS 住所,
        要介護認定申請情報."shinseishoKanriNo" AS 申請書管理番号,
        受給者台帳Newest."ninteiYMD" AS 認定年月日,
        受給者台帳Newest."ninteiYukoKikanKaishiYMD" AS 認定有効期間開始年月日,
        受給者台帳Newest."ninteiYukoKikanShuryoYMD" AS 認定有効期間終了年月日,
        受給者台帳Newest."yokaigoJotaiKubunCode" AS 要介護認定状態区分コード,
        構成市町村マスタ."shichosonCode" AS 市町村コード,
        構成市町村マスタ."shichosonMeisho" AS 市町村名称,
        認定調査委託先情報 ."jigyoshaNo"AS 居宅支援事業者コード,
        認定調査委託先情報 ."jigyoshaMeisho" AS 居宅支援事業者名称,
        介護事業者."jigyoshaName" AS 入所施設事業者名称,
        <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho" />
        FROM
        rgdb."DbT4101NinteiShinseiJoho" AS 要介護認定申請情報
        INNER JOIN rgdb."DbT7051KoseiShichosonMaster" AS 構成市町村マスタ
        ON 要介護認定申請情報."shoKisaiHokenshaNo" = 構成市町村マスタ."shoKisaiHokenshaNo"
        INNER JOIN rgdb."DbV4001JukyushaDaicho" AS 受給者台帳Newest
        ON 要介護認定申請情報."shinseishoKanriNo" = 受給者台帳Newest."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT4910NinteichosaItakusakiJoho" AS 認定調査委託先情報
        ON 要介護認定申請情報."ninteiChosaItakusakiCode" = 認定調査委託先情報."ninteichosaItakusakiCode"
        AND 構成市町村マスタ."shichosonCode" = 認定調査委託先情報."shichosonCode"
        AND 認定調査委託先情報."jokyoFlag" = True
        LEFT JOIN rgdb."DbT7060KaigoJigyosha" AS 介護事業者
        ON 要介護認定申請情報."nyushoShisetsuCode" = 介護事業者."jigyoshaNo"
        AND NOT EXISTS (SELECT 1
        FROM rgdb."DbT7060KaigoJigyosha" AS A
        WHERE 介護事業者."jigyoshaNo" = A."jigyoshaNo"
        AND 介護事業者."yukoKaishiYMD" &lt; A."yukoKaishiYMD"
        )
        LEFT JOIN
        rgua."UaFt200FindShikibetsuTaisho"('','',FALSE,'DB',FALSE,'','','','','','','','','','','',true,
      '','','','','','','',true,'','','','','','','','','','','',true,true,true,true,true,true,true,true,true,true,
      true,'','','','','','','','',true,'','',true,true,true,'','','','','','','','','','','','','','','','','','','{}') AS "ShikibetsuTaisho" 
    ON "ShikibetsuTaisho"."shikibetsuCode" = 要介護認定申請情報."shikibetsuCode"
        WHERE
        要介護認定申請情報."shinseishoKanriNo" IN
                            <foreach item="申請書管理番号リスト" index="index" collection="申請書管理番号リスト" open="(" separator="," close=")">
                                #{申請書管理番号リスト}
                            </foreach>
        AND 受給者台帳Newest."ninteiYukoKikanShuryoYMD" <![CDATA[>=]]> #{抽出対象期間_開始}
        AND 受給者台帳Newest."ninteiYukoKikanShuryoYMD" <![CDATA[<=]]> #{抽出対象期間_終了}
        AND 要介護認定申請情報."logicalDeletedFlag" = False
        ORDER BY
        #{出力順FLAG}
    </select>
</mapper>
             