<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- ビジネス設計_DBAMN41002_介護事業者・施設管理 -->
<mapper namespace="jp.co.ndensan.reams.db.dba.persistence.db.mapper.relate.kaigojigyoshashisetsukanri.IKaigoJigyoshaShisetsuKanriMapper">

    <!--テーブルDbT7060KaigoJigyoshaの項目をDbT7060KaigoJigyoshaEntityの項目にマッピングします。-->
    <resultMap id="resultMap_getShikakuJohoEntity" type="jp.co.ndensan.reams.db.dba.entity.db.relate.kaigojigyoshashisetsukanrio.KaigoJigyoshaShisetsuKanriRelateEntity" autoMapping="true">
       <id property="dbT7060KaigoJigyoshaEntity.jigyoshaNo" column="dbT7060KaigoJigyoshaEntity.jigyoshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
       <id property="dbT7060KaigoJigyoshaEntity.yukoKaishiYMD" column="dbT7060KaigoJigyoshaEntity.yukoKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <association property="dbT7060KaigoJigyoshaEntity" resultMap="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7060KaigoJigyoshaMapper.ResultMap_DbT7060KaigoJigyoshaEntity"/>
        <association property="dbT7062KaigoJigyoshaDaihyoshaEntity" resultMap="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7062KaigoJigyoshaDaihyoshaMapper.ResultMap_DbT7062KaigoJigyoshaDaihyoshaEntity"/>
    </resultMap>
    <resultMap id="resultMap_getKaigoJigyoshaRelateEntity" type="jp.co.ndensan.reams.db.dba.entity.db.relate.kaigojigyoshashisetsukanrio.KaigoJigyoshaRelateEntity" autoMapping="true">
        <result property="yukoKaishiYMD" column="DbT7060_yukoKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="yukoShuryoYMD" column="DbT7060_yukoShuryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="jigyoshaNo" column="DbT7060_jigyoshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="yukoKaishiYMD2" column="DbT1005_yukoKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="yukoShuryoYMD2" column="DbT7060_yukoShuryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="jigyoshaNo2" column="DbT1005_jigyoshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>
    <resultMap id="resultMap_getKaigoJogaiTokureiRelateEntity" type="jp.co.ndensan.reams.db.dba.entity.db.relate.kaigojigyoshashisetsukanrio.KaigoJogaiTokureiRelateEntity" autoMapping="true">
        <result property="yukoKaishiYMD" column="DbT7063_yukoKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="yukoShuryoYMD" column="DbT7063_yukoShuryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="jigyoshaName" column="DbT7063_jigyoshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="kanrishaName" column="DbT7063_kanrishaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="serviceShuruiCode" column="DbT7063_serviceShuruiCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>
    <select id="getJigyoshaJoho" resultMap="resultMap_getShikakuJohoEntity"
            parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.kaigojigyoshashisetsukanrio.KaigoJigyoshaShisetsuKanriMapperParameter" fetchSize="500">
        SELECT
        DbT7060.*,
        DbT7062.*
        FROM
        rgdb."DbT7060KaigoJigyosha" as DbT7060
        INNER JOIN
        rgdb."DbT7062KaigoJigyoshaDaihyosha" as DbT7062
        ON
        DbT7060."jigyoshaNo" =  DbT7062."jigyoshaNo"
        AND
        DbT7060."yukoKaishiYMD" = DbT7062."yukoKaishiYMD"
        AND
        DbT7062."isDeleted"<![CDATA[<>]]> TRUE
        WHERE
        DbT7060."jigyoshaNo" = #{jigyoshaNo}
        AND
        DbT7060."yukoKaishiYMD" = #{yukoKaishiYMD}
        AND
        DbT7060."isDeleted"<![CDATA[<>]]> TRUE
    </select>
    <select id="getServiceItiranJoho" resultMap="resultMap_getKaigoJogaiTokureiRelateEntity"
             parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.kaigojigyoshashisetsukanrio.KaigoJogaiTokureiParameter" fetchSize="500">
        SELECT
        DbT7063."yukoKaishiYMD" as "DbT7063_yukoKaishiYMD",
        DbT7063."yukoShuryoYMD" as "DbT7063_yukoShuryoYMD",
        DbT7063."jigyoshaName" as "DbT7063_jigyoshaName",
        DbT7063."kanrishaName" as "DbT7063_kanrishaName",
        DbT7063."serviceShuruiCode" as "DbT7063_serviceShuruiCode"
        FROM
        rgdb."DbT7060KaigoJigyosha" as DbT7060
        LEFT JOIN
        rgdb."DbT7063KaigoJigyoshaShiteiService" as DbT7063
        ON
        DbT7060."jigyoshaNo" = DbT7063."jigyoshaNo"
        AND NOT((DbT7060."yukoKaishiYMD"<![CDATA[>]]>DbT7063."yukoKaishiYMD"
        AND
        (DbT7060."yukoKaishiYMD"<![CDATA[>=]]>DbT7063."yukoShuryoYMD"))
        OR
        (DbT7060."yukoShuryoYMD"<![CDATA[<=]]>DbT7063."yukoKaishiYMD"
        AND
        DbT7060."yukoShuryoYMD"<![CDATA[<]]>DbT7063."yukoShuryoYMD")

        )
        AND
        DbT7063."isDeleted"<![CDATA[<>]]> TRUE
        WHERE
        DbT7060."jigyoshaNo" = #{jigyoshaNo}
        AND
        DbT7060."yukoKaishiYMD" = #{yukoKaishiYMD}
        AND
        DbT7060."isDeleted" <![CDATA[<>]]> TRUE
        ORDER BY
        DbT7063."serviceShuruiCode" asc, DbT7063."yukoKaishiYMD" desc

    </select>
    <select id="getCheckKikanJufuku" resultMap="resultMap_getKaigoJigyoshaRelateEntity"
             parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.kaigojigyoshashisetsukanrio.KaigoJigyoshaParameter" fetchSize="500">
        SELECT
        DbT7060."yukoKaishiYMD" as "DbT7060_yukoKaishiYMD" ,
        DbT7060."yukoShuryoYMD" as "DbT7060_yukoShuryoYMD" ,
        DbT7060."jigyoshaNo" as "DbT7060_jigyoshaNo"
        FROM
        rgdb."DbT7060KaigoJigyosha" as DbT7060
        WHERE
        DbT7060."jigyoshaNo" = #{jigyoshaNo}
        AND
        ((DbT7060."yukoKaishiYMD"<![CDATA[<=]]> #{yukoKaishiYMD}
        AND (DbT7060."yukoShuryoYMD"<![CDATA[>]]> #{yukoKaishiYMD}))
        OR(DbT7060."yukoKaishiYMD"<![CDATA[<]]> #{yukoShuryoYMD}
        AND DbT7060."yukoShuryoYMD"<![CDATA[>=]]> #{yukoShuryoYMD}
        )
        OR((DbT7060."yukoKaishiYMD"<![CDATA[<=]]> #{yukoKaishiYMD}
        AND DbT7060."yukoShuryoYMD"<![CDATA[>=]]> #{yukoShuryoYMD})
        )
        )
        AND
        DbT7060."isDeleted"<![CDATA[=]]>TRUE
    </select>
    <select id="getCheckKikanJufukui" resultMap="resultMap_getKaigoJigyoshaRelateEntity"
             parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.kaigojigyoshashisetsukanrio.KaigoJigyoshaParameter" fetchSize="500">
        SELECT
        DbT1005."jigyoshaNo" as "DbT1005_jigyoshaNo" ,
        DbT1005."yukoKaishiYMD" as "DbT1005_yukoKaishiYMD",
        DbT1005."yukoShuryoYMD" as "DbT1005_yukoShuryoYMD"
        FROM
        rgdb."DbT1005KaigoJogaiTokureiTaishoShisetsu" as DbT1005
        WHERE
        DbT1005".jigyoshaNo"= #{jigyoshaNo}
        AND
        DbT1005."jigyoshaShubetsu"= #{jigyoshaShubetsu}
        AND
        DbT1005."isDeleted"<![CDATA[<>]]>TRUE
        AND
        (( DbT1005."yukoKaishiYMD"<![CDATA[<=]]> #{yukoKaishiYMD}
        AND (DbT1005."yukoShuryoYMD"<![CDATA[>]]> #{yukoKaishiYMD} ))
        OR(DbT1005."yukoKaishiYMD"<![CDATA[<]]> #{yukoShuryoYMD}
        AND DbT1005."yukoShuryoYMD"<![CDATA[>=]]> #{yukoShuryoYMD}
        )
        OR((DbT1005."yukoKaishiYMD"<![CDATA[<=]]> #{yukoKaishiYMD}
        AND DbT1005."yukoShuryoYMD"<![CDATA[>=]]> #{yukoShuryoYMD})
        )
        )
    </select>
</mapper>
