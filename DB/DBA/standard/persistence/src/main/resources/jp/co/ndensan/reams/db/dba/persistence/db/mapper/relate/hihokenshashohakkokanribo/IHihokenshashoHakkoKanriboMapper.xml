<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @reamsid_L DBA-0600-020 zhangguopeng -->
<mapper namespace="jp.co.ndensan.reams.db.dba.persistence.db.mapper.relate.hihokenshashohakkokanribo.IHihokenshashoHakkoKanriboMapper">

    <resultMap id="resultMap_get証発行管理リスト情報" type="jp.co.ndensan.reams.db.dba.entity.db.relate.hihokenshashohakkokanribo.AkasiHakouKanriEntity" autoMapping="true">
        <result property="hihokenshaNo" column="shoKofuKaishu_hihokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shichosonCode" column="shoKofuKaishu_shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler"/>
        <result property="shikibetsuCode" column="shoKofuKaishu_shikibetsuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ShikibetsuCodeTypeHandler"/>
        <result property="kofuYMD" column="shoKofuKaishu_kofuYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="yukoKigenYMD" column="shoKofuKaishu_yukoKigenYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="kofuJiyuCode" column="shoKofuKaishu_kofuJiyu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="kaishuYMD" column="shoKofuKaishu_kaishuYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="kaishuJiyuCode" column="shoKofuKaishu_kaishuJiyu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="shoYoshikiKubunCode" column="shoKofuKaishu_shoYoshikiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <association property="宛名Entity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.UaFt200FindShikibetsuTaishoEntity"/>
    </resultMap>
    
    <select resultOrdered="true" id="get証発行管理リスト情報"
            resultMap="resultMap_get証発行管理リスト情報"
            parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.hihokenshashohakkokanribo.HihokenshashoHakkoKanriboMybatisParameter" fetchSize="500">
        SELECT
            ShoKofuKaishu."hihokenshaNo" AS "shoKofuKaishu_hihokenshaNo",
            ShoKofuKaishu."shichosonCode" AS "shoKofuKaishu_shichosonCode",
            ShoKofuKaishu."shikibetsuCode" AS "shoKofuKaishu_shikibetsuCode",
            ShoKofuKaishu."kofuYMD" AS "shoKofuKaishu_kofuYMD",
            ShoKofuKaishu."yukoKigenYMD" AS "shoKofuKaishu_yukoKigenYMD",
            ShoKofuKaishu."kofuJiyu" AS "shoKofuKaishu_kofuJiyu",
            ShoKofuKaishu."kaishuYMD" AS "shoKofuKaishu_kaishuYMD",
            ShoKofuKaishu."kaishuJiyu" AS "shoKofuKaishu_kaishuJiyu",
            ShoKofuKaishu."shoYoshikiKubunCode" AS "shoKofuKaishu_shoYoshikiKubunCode",
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho" />
        FROM
            rgdb."DbT7037ShoKofuKaishu" AS ShoKofuKaishu
        LEFT JOIN
           <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmShikibetsuTaisho" />
           AS <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />
        ON ShoKofuKaishu."shikibetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."shikibetsuCode"
        WHERE
            ShoKofuKaishu."logicalDeletedFlag" = 'false'
        <if test="kofuJiyulist.size() > 0">
            AND
            ShoKofuKaishu."kofuJiyu" IN
            <foreach
                collection="kofuJiyulist"
                item="code"
                open="("
                separator=","
                close=")">
                #{code}
            </foreach>
        </if>
        <if test="kaishuJiyulist.size() > 0">
            AND
            ShoKofuKaishu."kaishuJiyu" IN
            <foreach
                collection="kaishuJiyulist"
                item="code"
                open="("
                separator=","
                close=")">
                #{code}
            </foreach>
        </if>
        AND
        ShoKofuKaishu."kofuShoShurui" = #{akasihakouMod}
        <if test="iskoufukayisihi">
            AND ShoKofuKaishu."kofuYMD" <![CDATA[>=]]> #{koufukayisihi}
        </if>
        <if test="iskoufuShuryouhi">
            AND ShoKofuKaishu."kofuYMD" <![CDATA[<=]]> #{koufusiuryouhi}
        </if>
        <if test="iskaisyuKayisihi">
            AND ShoKofuKaishu."kaishuYMD" <![CDATA[>=]]> #{kasyuukayisihi}
        </if>
        <if test="iskaisyuShuryouhi">
            AND ShoKofuKaishu."kaishuYMD" <![CDATA[<=]]> #{kasyuusiuryouhi}
        </if>
        ORDER BY ShoKofuKaishu."hihokenshaNo" ${出力順}
    </select>
    
    <select resultOrdered="true" id="get証発行管理リスト最新情報"
            resultMap="resultMap_get証発行管理リスト情報"
            parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.hihokenshashohakkokanribo.HihokenshashoHakkoKanriboMybatisParameter" fetchSize="500">
        SELECT
            ShoKofuKaishu."hihokenshaNo" AS "shoKofuKaishu_hihokenshaNo",
            ShoKofuKaishu."shichosonCode" AS "shoKofuKaishu_shichosonCode",
            ShoKofuKaishu."shikibetsuCode" AS "shoKofuKaishu_shikibetsuCode",
            ShoKofuKaishu."kofuYMD" AS "shoKofuKaishu_kofuYMD",
            ShoKofuKaishu."yukoKigenYMD" AS "shoKofuKaishu_yukoKigenYMD",
            ShoKofuKaishu."kofuJiyu" AS "shoKofuKaishu_kofuJiyu",
            ShoKofuKaishu."kaishuYMD" AS "shoKofuKaishu_kaishuYMD",
            ShoKofuKaishu."kaishuJiyu" AS "shoKofuKaishu_kaishuJiyu",
            ShoKofuKaishu."shoYoshikiKubunCode" AS "shoKofuKaishu_shoYoshikiKubunCode",
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho" />
        FROM (SELECT *
               FROM (SELECT T7037.*
                     , ROW_NUMBER() OVER ( 
                       PARTITION BY
                         T7037."hihokenshaNo" 
                       ORDER BY
                         T7037."kofuYMD" DESC
                         , T7037."hakkoShoriTimestamp" DESC
                     ) AS rank_number 
                   FROM
                     rgdb."DbT7037ShoKofuKaishu" AS T7037
                 ) AS T1 
               WHERE T1.rank_number = 1
               ) AS ShoKofuKaishu
        LEFT JOIN
           <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmShikibetsuTaisho" />
           AS <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />
        ON ShoKofuKaishu."shikibetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."shikibetsuCode"
        WHERE
           ShoKofuKaishu."logicalDeletedFlag" = 'false'
        <if test="kofuJiyulist.size() > 0">
            AND
            ShoKofuKaishu."kofuJiyu" IN
            <foreach
                collection="kofuJiyulist"
                item="code"
                open="("
                separator=","
                close=")">
                #{code}
            </foreach>
        </if>
        <if test="kaishuJiyulist.size() > 0">
            AND
            ShoKofuKaishu."kaishuJiyu" IN
            <foreach
                collection="kaishuJiyulist"
                item="code"
                open="("
                separator=","
                close=")">
                #{code}
            </foreach>
        </if>
        AND
        ShoKofuKaishu."kofuShoShurui" = #{akasihakouMod}
        <if test="iskoufukayisihi">
            AND ShoKofuKaishu."kofuYMD" <![CDATA[>=]]> #{koufukayisihi}
        </if>
        <if test="iskoufuShuryouhi">
            AND ShoKofuKaishu."kofuYMD" <![CDATA[<=]]> #{koufusiuryouhi}
        </if>
        <if test="iskaisyuKayisihi">
            AND ShoKofuKaishu."kaishuYMD" <![CDATA[>=]]> #{kasyuukayisihi}
        </if>
        <if test="iskaisyuShuryouhi">
            AND ShoKofuKaishu."kaishuYMD" <![CDATA[<=]]> #{kasyuusiuryouhi}
        </if>
        ORDER BY ShoKofuKaishu."hihokenshaNo" ${出力順}
    </select>
</mapper>