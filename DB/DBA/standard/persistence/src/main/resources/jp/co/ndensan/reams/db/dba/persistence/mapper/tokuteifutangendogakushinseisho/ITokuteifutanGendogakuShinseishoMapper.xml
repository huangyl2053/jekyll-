<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- どのマッパーインターフェースと対応するかを指定する -->

<mapper namespace="jp.co.ndensan.reams.db.dba.persistence.mapper.tokuteifutangendogakushinseisho.ITokuteifutanGendogakuShinseishoMapper">
    <select id="get最新異動日データ" resultType="jp.co.ndensan.reams.db.dbz.entity.db.basic.DbT1001HihokenshaDaichoEntity" 
    parameterType="jp.co.ndensan.reams.db.dba.definition.core.tokuteifutangendogakushinseisho.TokuteifutanGendogakuShinseishoMybatisParameter"   fetchSize="500">
        SELECT
            "hihokenshaNo",
            "shikibetsuCode",
            "shichosonCode",
            "koikinaiTokureiSochimotoShichosonCode"
        FROM 
            rgdb."DbT1001HihokenshaDaicho"
        WHERE 
            "logicalDeletedFlag" = FALSE
        <if test="is被保険者番号_FLG" >
            AND  "hihokenshaNo" = #{被保険者番号}
        </if>
        <if test="is識別コード_FLG" >
            AND  "shikibetsuCode" = #{識別コード}
        </if>
        ORDER BY "idoYMD" DESC, "edaNo" DESC limit 1
    </select>

    <select id="getPsm" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.UaFt200FindShikibetsuTaishoEntity"
            parameterType="jp.co.ndensan.reams.db.dba.definition.core.tokuteifutangendogakushinseisho.PsmTokuteifutanGendogakudoMybatisParameter" 
            fetchSize="500">
        SELECT
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho" />
        FROM
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmShikibetsuTaisho" />
            AS <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />
    </select>
    
    <select id="get保険者名称" resultType="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"
            parameterType="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler" 
            fetchSize="500">
        SELECT
            "hokenjaName"
        FROM
            rgur."UrT0507Hokenja"
        WHERE
            "hokenjaShubetsu" = '08'
        AND 
            "hokenjaNo" = #{証記載保険者番号}
    </select>
</mapper>
