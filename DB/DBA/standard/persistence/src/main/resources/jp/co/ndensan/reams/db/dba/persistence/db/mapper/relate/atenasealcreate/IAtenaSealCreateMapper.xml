<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- @reamsid_L DBA-1210-030 zhengsongling -->
<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dba.persistence.db.mapper.relate.atenasealcreate.IAtenaSealCreateMapper">
     <resultMap id="resultMap_getTekiyoKaisha" type="jp.co.ndensan.reams.db.dba.entity.db.relate.atenasealcreate.AtenaSealCreateRelateEntity" autoMapping="true">
<result property="被保険者番号" column="被保険者番号" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler"/>
<association property="psmEntity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.UaFt200FindShikibetsuTaishoEntity"/>
<association property="atesakiEntity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.resultAtesakiEntity"/>
     </resultMap>
    <select resultOrdered="true" id="getTekiyoKaisha" resultMap="resultMap_getTekiyoKaisha"
            parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.atenasealcreate.AtenaSealCreateMybatisParameter"
            fetchSize="500">
      SELECT
            T1001."hihokenshaNo" AS "被保険者番号",
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho" />
              <if test="is送付先または代納人">
            ,<include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.columns_Atesaki" />
              </if>
      FROM
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmShikibetsuTaisho"/>
            AS <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />
      INNER JOIN
            rgdb."DbT1001HihokenshaDaicho" AS T1001
      ON
            T1001."shikibetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."shikibetsuCode"
      AND
            T1001."hihokennshaKubunCode" IN 
             <foreach collection="資格区分" item="資格区分" open="(" separator="," close=")"> #{資格区分} </foreach>
      AND
            T1001."logicalDeletedFlag" =FALSE
      LEFT JOIN
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.tableName_PsmAtesaki" /> AS "Atesaki"
      ON
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."shikibetsuCode" = "Atesaki"."shikibetsuCode"
      AND
          "Atesaki"."juminShubetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminShubetsuCode"
      AND
           "Atesaki"."juminJotaiCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminJotaiCode"    
      WHERE
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminShubetsuCode" IN
          <foreach collection="住民種別" item="住民種別" open="(" separator="," close=")"> #{住民種別} </foreach>
      AND
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminJotaiCode" IN 
            <foreach collection="住民状態" item="住民状態" open="(" separator="," close=")"> #{住民状態} </foreach>
      <if test="is年齢到達日">
          <if test="is第1号開始年月日">
      AND
              #{kankaishibi_第１号} <![CDATA[<=]]> <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD"  
      AND
           <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD" <![CDATA[<=]]> #{shuuryoubi_第１号}         
          </if>
       <if test="is第2号開始年月日">
      AND
              #{kankaishibi_第２号} <![CDATA[<=]]> <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD"  
      AND
           <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD" <![CDATA[<=]]> #{shuuryoubi_第２号}         
          </if>
          <if test="is資格区分_全て">
      AND
              (#{kankaishibi_第１号} <![CDATA[<=]]> <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD"
      OR
              #{kankaishibi_第２号} <![CDATA[<=]]> <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD" )  
      AND
              (<include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD" <![CDATA[<=]]>#{shuuryoubi_第１号}
      OR
              <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."seinengappiYMD" <![CDATA[<=]]>#{shuuryoubi_第２号})
          </if>
      </if>
      <if test="has市町村指定">
      AND
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."genLasdecCode" = #{shichousonshitei}
      </if>
    </select>
    
     <resultMap id="resultMap_getHihokenshadai" type="jp.co.ndensan.reams.db.dba.entity.db.relate.atenasealcreate.AtenaSealCreateRelateEntity" autoMapping="true">
<result property="被保険者番号" column="被保険者番号" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler"/>
<result property="市町村コード" column="市町村コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler"/>
<result property="識別コード" column="識別コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ShikibetsuCodeTypeHandler"/>
<association property="psmEntity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.UaFt200FindShikibetsuTaishoEntity"/>
<association property="atesakiEntity" resultMap="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.resultAtesakiEntity"/>
     </resultMap>
     <select  resultOrdered="true" id="getHihokenshadai" resultMap="resultMap_getHihokenshadai"
            parameterType="jp.co.ndensan.reams.db.dba.definition.mybatisprm.atenasealcreate.AtenaSealCreateMybatisParameter"
            fetchSize="500">
        SELECT
            T1001."hihokenshaNo" AS "被保険者番号",
            T1001."shichosonCode" AS "市町村コード",
            T1001."shikibetsuCode" AS "識別コード",
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.columns_ShikibetsuTaisho"/>
            <if test="is送付先または代納人">
           , <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.columns_Atesaki"/>
            </if>
      FROM
            <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.tableName_PsmShikibetsuTaisho"/>
            AS <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>
      INNER JOIN
            rgdb."DbT1001HihokenshaDaicho" AS T1001
     ON
            T1001."shikibetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>."shikibetsuCode"
      AND
            T1001."hihokennshaKubunCode" IN  
            <foreach collection="資格区分" item="資格区分" open="(" separator="," close=")"> #{資格区分} </foreach>
      AND
            T1001."shikakuSoshitsuYMD" = '99999999'
      AND
            T1001."logicalDeletedFlag" = FALSE
     <if test="isDBA業務コード">
         <if test="is第1号開始年月日">
      AND
              #{kankaishibi_第１号} <![CDATA[<=]]> T1001."shikakuShutokuYMD"
      AND
           T1001."shikakuShutokuYMD" <![CDATA[<=]]> #{shuuryoubi_第１号}
          </if>
            <if test="is第2号開始年月日">
      AND
              #{kankaishibi_第２号} <![CDATA[<=]]> T1001."shikakuShutokuYMD" 
      AND
           T1001."shikakuShutokuYMD" <![CDATA[<=]]> #{shuuryoubi_第２号}
          </if>
          <if test="is資格区分_全て">
      AND
              (#{kankaishibi_第１号} <![CDATA[<=]]> T1001."shikakuShutokuYMD"
      OR
              #{kankaishibi_第２号} <![CDATA[<=]]> T1001."shikakuShutokuYMD" )
      AND
              (T1001."shikakuShutokuYMD" <![CDATA[<=]]>#{shuuryoubi_第１号}
      OR
              T1001."shikakuShutokuYMD" <![CDATA[<=]]>#{shuuryoubi_第２号})
          </if>
      </if>
                <if test="is抽出対象者1">
      AND
              T1001."jushochiTokureiFlag" = '1'
                </if>
                <if test="is市町村指定">
      AND
              T1001."shichosonCode" = #{shichousonshitei}
                </if>
      LEFT JOIN
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt250FindAtesakiMapper.tableName_PsmAtesaki"/> AS "Atesaki"
      ON
          <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>."shikibetsuCode" = "Atesaki"."shikibetsuCode"
      AND
          "Atesaki"."gyomuCode" = 'DBA'
      AND
          "Atesaki"."juminShubetsuCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminShubetsuCode"
      AND
           "Atesaki"."juminJotaiCode" = <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho" />."juminJotaiCode"
      WHERE
      <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>."juminShubetsuCode" IN
      <foreach collection="住民種別" item="住民種別" open="(" separator="," close=")"> #{住民種別} </foreach>
      AND
      <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>."juminJotaiCode" IN
      <foreach collection="住民状態" item="住民状態" open="(" separator="," close=")"> #{住民状態} </foreach>
      <if test="has市町村指定">
      AND
           <include refid="jp.co.ndensan.reams.ua.uax.persistence.db.mapper.IUaFt200FindShikibetsuTaishoFunctionMapper.as_ShikibetsuTaisho"/>."genLasdecCode" = #{shichousonshitei}
      </if>
    </select>

<resultMap id="resultMap_getIChiJiTBLEntity" type="jp.co.ndensan.reams.db.dba.entity.db.relate.atenasealcreate.IChiJiTBLEntity" autoMapping="true">
<result property="エラー区分" column="エラー区分" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="証記載保険者番号" column="証記載保険者番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="被保険者番号" column="被保険者番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="キー1" column="キー1" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="キー2" column="キー2" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="キー3" column="キー3" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="キー4" column="キー4" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="キー5" column="キー5" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="被保険者カナ氏名" column="被保険者カナ氏名" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="被保険者氏名" column="被保険者氏名" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
<result property="備考" column="備考" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
     </resultMap>
<select  resultOrdered="true" id="getIChiJiTBLEntity" resultMap="resultMap_getIChiJiTBLEntity"
            fetchSize="500">
    SELECT 
            "TBL"."errorCode" AS "エラー区分",
            "TBL"."ariShikusaihokenshaBongou" AS "証記載保険者番号",
            "TBL"."hihoKenshaNo" AS "被保険者番号",
            "TBL"."key1" AS "キー1",
            "TBL"."key2" AS "キー2",
            "TBL"."key3" AS "キー3",
            "TBL"."key4" AS "キー4",
            "TBL"."key5" AS "キー5",
            "TBL"."kanaShimei" AS "被保険者カナ氏名",
            "TBL"."shiMei" AS "被保険者氏名",
            "TBL"."biKou" AS "備考"
        FROM
            "ShorikekkarisutoichijiTBL" AS "TBL"
</select>
</mapper>