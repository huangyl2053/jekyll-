<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 受領委任契約（福祉用具購入費・住宅改修費）登録・追加・修正・照会のマッピング用XMLです。 -->
<!-- @reamsid_L DBC-2180-030 x_miaocl -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.relate.dbc050010.IGdaekomimeisaiFurikomiMapper">

    <resultMap id="resultMap_HanyouRisutoSyuturyokuEntity" type="jp.co.ndensan.reams.db.dbc.entity.db.relate.dbc050010.GdaekomiDetaiResultEntity" autoMapping="true">
        <id property="高額介護サービス費支給判定結果Entity.hiHokenshaNo" column="dbT3057KogakuShikyuHanteiKekka_hihokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給申請Entity.hiHokenshaNo" column="dbT3056KogakuShikyuShinsei_hihokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給判定結果Entity.serviceTeikyoYM" column="dbT3057KogakuShikyuHanteiKekka_serviceTeikyoYM" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearMonthTypeHandler"/>
        <id property="高額介護サービス費支給申請Entity.serviceTeikyoYM" column="dbT3056KogakuShikyuShinsei_serviceTeikyoYM" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearMonthTypeHandler"/>
        <id property="高額介護サービス費支給判定結果Entity.shoKisaiHokenshaNo" column="dbT3057KogakuShikyuHanteiKekka_shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShoKisaiHokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給申請Entity.shoKisaiHokenshaNo" column="dbT3056KogakuShikyuShinsei_shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShoKisaiHokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給判定結果Entity.rirekiNo" column="dbT3057KogakuShikyuHanteiKekka_rirekiNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <id property="高額介護サービス費支給申請Entity.rirekiNo" column="dbT3056KogakuShikyuShinsei_rirekiNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <id property="高額介護サービス費支給審査決定list.hiHokenshaNo" column="dbT3058KogakuShikyuShinsaKettei_hihokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.HihokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給審査決定list.serviceTeikyoYM" column="dbT3058KogakuShikyuShinsaKettei_serviceTeikyoYM" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearMonthTypeHandler"/>
        <id property="高額介護サービス費支給審査決定list.shoKisaiHokenshaNo" column="dbT3058KogakuShikyuShinsaKettei_shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShoKisaiHokenshaNoTypeHandler"/>
        <id property="高額介護サービス費支給審査決定list.rirekiNo" column="dbT3058KogakuShikyuShinsaKettei_rirekiNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <association property="高額介護サービス費支給判定結果Entity" resultMap="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3057KogakuShikyuHanteiKekkaMapper.ResultMap_DbT3057KogakuShikyuHanteiKekkaEntity"/>
       <association property="高額介護サービス費支給申請Entity" resultMap="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3056KogakuShikyuShinseiMapper.ResultMap_DbT3056KogakuShikyuShinseiEntity"/>
       <collection property="高額介護サービス費支給審査決定list" resultMap="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3058KogakuShikyuShinsaKetteiMapper.ResultMap_DbT3058KogakuShikyuShinsaKetteiEntity"/>
    </resultMap> 
    <select id="get高額データ取得"
            resultMap="resultMap_HanyouRisutoSyuturyokuEntity"
            parameterType="jp.co.ndensan.reams.db.dbc.definition.mybatisprm.dbc050010.KogakuFurikomiMybatisParameter" 
            fetchSize="500" resultOrdered="true">
        SELECT
            判定結果.*,
            支給申請.*,
            審査決定.*
        FROM
            (<include refid="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3057KogakuShikyuHanteiKekkaMapper.noDeleted_DbT3057KogakuShikyuHanteiKekka" />) AS 判定結果
        INNER JOIN
            (<include refid="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3056KogakuShikyuShinseiMapper.noDeleted_DbT3056KogakuShikyuShinsei" />) AS 支給申請
            ON
              判定結果."dbT3057KogakuShikyuHanteiKekka_hihokenshaNo" = 支給申請."dbT3056KogakuShikyuShinsei_hihokenshaNo"
            AND  判定結果."dbT3057KogakuShikyuHanteiKekka_serviceTeikyoYM" = 支給申請."dbT3056KogakuShikyuShinsei_serviceTeikyoYM"
            AND 判定結果."dbT3057KogakuShikyuHanteiKekka_shoKisaiHokenshaNo" = 支給申請."dbT3056KogakuShikyuShinsei_shoKisaiHokenshaNo"
            AND 判定結果."dbT3057KogakuShikyuHanteiKekka_rirekiNo" = 支給申請."dbT3056KogakuShikyuShinsei_rirekiNo"
        LEFT JOIN
            (<include refid="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.basic.IDbT3058KogakuShikyuShinsaKetteiMapper.noDeleted_DbT3058KogakuShikyuShinsaKettei" />) AS 審査決定
            ON  判定結果."dbT3057KogakuShikyuHanteiKekka_hihokenshaNo" = 審査決定."dbT3058KogakuShikyuShinsaKettei_hihokenshaNo"
            AND  判定結果."dbT3057KogakuShikyuHanteiKekka_serviceTeikyoYM" = 審査決定."dbT3058KogakuShikyuShinsaKettei_serviceTeikyoYM"
            AND 判定結果."dbT3057KogakuShikyuHanteiKekka_shoKisaiHokenshaNo" = 審査決定."dbT3058KogakuShikyuShinsaKettei_shoKisaiHokenshaNo"
            AND 判定結果."dbT3057KogakuShikyuHanteiKekka_rirekiNo" = 審査決定."dbT3058KogakuShikyuShinsaKettei_rirekiNo"
        WHERE
            ((判定結果."dbT3057KogakuShikyuHanteiKekka_shinsaHohoKubun" ='1'
                AND 審査決定."dbT3058KogakuShikyuShinsaKettei_shikyuKubunCode"='1')
            OR (判定結果."dbT3057KogakuShikyuHanteiKekka_shinsaHohoKubun" ='2'
                AND (判定結果."dbT3057KogakuShikyuHanteiKekka_shikyuKubunCode"='1')))
           <if test="口座の場合">
           AND 支給申請."dbT3056KogakuShikyuShinsei_shiharaiHohoKubunCode" ='2'
           </if> 
           <if test="窓口の場合">
           AND 支給申請."dbT3056KogakuShikyuShinsei_shiharaiHohoKubunCode"='1'
           </if> 
           <if test="振込データ作成済を除く">
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_furikomiMeisaishoSakuseiYMD" =''
           </if>     
           <if test="振込データ作成済のみ">
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_furikomiMeisaishoSakuseiYMD" =#{対象作成年月日}
           </if> 
           <if test="全て">
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_furikomiMeisaishoSakuseiYMD" <![CDATA[<>]]>''
           </if>   
           <if test="再処理フラグT">
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_furikomiMeisaishoSakuseiYMD" IN('',#{対象作成年月日})
           </if>  
           <if test="開始年月日T">
           AND #{開始年月日}<![CDATA[<=]]>判定結果."dbT3057KogakuShikyuHanteiKekka_ketteiTsuchishoSakuseiYMD"
           </if> 
           <if test="終了年月日T">
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_ketteiTsuchishoSakuseiYMD" <![CDATA[<=]]> #{終了年月日}
           </if> 
           <if test="開始受取年月T">
           AND  #{開始受取年月}<![CDATA[<=]]>審査決定."dbT3058KogakuShikyuShinsaKettei_ketteishaUketoriYM"
           </if> 
           <if test="終了受取年月T">
           AND 審査決定."dbT3058KogakuShikyuShinsaKettei_ketteishaUketoriYM" <![CDATA[<=]]> #{終了受取年月}
           </if> 
           AND 判定結果."dbT3057KogakuShikyuHanteiKekka_isDeleted" = FALSE
    </select>
</mapper>