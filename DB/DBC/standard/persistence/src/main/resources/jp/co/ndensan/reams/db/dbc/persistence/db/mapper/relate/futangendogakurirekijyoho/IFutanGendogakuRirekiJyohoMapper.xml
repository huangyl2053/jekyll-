<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 減免・減額履歴情報(画面)の負担限度額履歴情報取得のマッピング用XMLです。 -->
<!-- @reamsid_L DBC-4350-090 liuxiaoyu -->

<mapper namespace="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.relate.futangendogakurirekijyoho.IFutanGendogakuRirekiJyohoMapper">  
    <select id="get負担限度額履歴情報"
           resultMap="resultMap_FutanGendogakuRirekiJyohoEntity"
            parameterType="java.util.Map" fetchSize="500" resultOrdered="true">
        SELECT 
            CASE WHEN Dbt4018."kyusochishaKubun" = '1' OR Dbt4018."kyusochishaKubun" = '2' THEN '06'
                 WHEN Dbt4018."riyoshaFutanDankai" = '4' THEN '07'
                 ELSE '05' END AS 減免_減額種類,
            Dbt4018."tekiyoKaishiYMD" AS 適用開始日,
            Dbt4018."tekiyoShuryoYMD" AS 適用終了日,
            Dbt4018."shokuhiFutanGendogaku" AS 食費負担限度額,
            Dbt4018."unitTypeKoshitsu" AS ユニット型個室,
            Dbt4018."unitTypeJunKoshitsu" AS ユニット型準個室,
            Dbt4018."juraiTypeKoshitsu_Tokuyo" AS 従来型個室_特養等,
            Dbt4018. "juraiTypeKoshitsu_Roken_Ryoyo" AS 従来型個室_老健_療養等,
            Dbt4018."tashoshitsu" AS 多床室
        FROM
            rgdb."DbT4018KaigoHokenFutanGendogakuNintei" AS Dbt4018
        WHERE
            Dbt4018."hihokenshaNo" = #{被保険者番号}
       ORDER BY
           減免_減額種類 ASC,
           適用開始日 DESC
    </select>
    
    <resultMap id="resultMap_FutanGendogakuRirekiJyohoEntity" autoMapping="true"
               type="jp.co.ndensan.reams.db.dbc.entity.db.relate.futangendogakurirekijyoho.FutanGendogakuRirekiJyohoRelateEntity">
        <result property="減免_減額種類" column="減免_減額種類" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="適用開始日" column="適用開始日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="適用終了日" column="適用終了日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="食費負担限度額" column="食費負担限度額" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <result property="ユニット型個室" column="ユニット型個室" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <result property="ユニット型準個室" column="ユニット型準個室" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <result property="従来型個室_特養等" column="従来型個室_特養等" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <result property="従来型個室_老健_療養等" column="従来型個室_老健_療養等" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
        <result property="多床室" column="多床室" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.DecimalTypeHandler"/>
    </resultMap>
    
</mapper>