<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--@reamsid_L DBC-4350-080 liuxiaoyu-->
<mapper namespace="jp.co.ndensan.reams.db.dbc.persistence.db.mapper.relate.keikakurirekiichiran.IKeikakuRirekiIchiranMapper">
 <select resultOrdered="true" id="select居宅給付計画届出情報"
         resultType="jp.co.ndensan.reams.db.dbc.entity.db.relate.keikakurirekiichiran.KeikakuRirekiIchiranEnitity"
         parameterType="java.util.Map">
    SELECT * FROM     
         (SELECT
            'A' as "kyotakuKeikakuShurui",
             A."hihokenshaNo" as "hihokenshaNo",
             B."tekiyoKaishiYMD" as "tekiyoKaishiYMD",
             B."tekiyoShuryoYMD" as "tekiyoShuryoYMD",
             B."keikakuJigyoshaNo" as "keikakuJigyoshaNo",
             B."itakusakiJigyoshaNo" as "itakusakiJigyoshaNo",
             A."zanteiKubun" as "zanteiKubun"
          FROM    rgdb."DbT3005KyotakuKeikakuTodokede" as A
          INNER JOIN rgdb."DbT3006KyotakuKeikakuJigyoshaSakusei" as B
          ON      A."hihokenshaNo" =B."hihokenshaNo" 
              and    A."rirekiNo" = B."rirekiNo"
     
          UNION
     
          SELECT 
             'B' as "kyotakuKeikakuShurui",
              A2."hihokenshaNo" as "hihokenshaNo",
              C."tekiyoKaishiYMD" as "tekiyoKaishiYMD",
              C."tekiyoShuryoYMD" as "tekiyoShuryoYMD",
              ''  as  "keikakuJigyoshaNo",
              ''  as  "itakusakiJigyoshaNo",
              A2."zanteiKubun" as "zanteiKubun"
          FROM  rgdb."DbT3005KyotakuKeikakuTodokede" as A2
          INNER JOIN rgdb."DbT3007KyotakuKeikakuJikoSakusei" as C
          ON      A2."hihokenshaNo" =C."hihokenshaNo" 
              and    A2."rirekiNo" = C."rirekiNo"
          ) AS D
     WHERE
          D."hihokenshaNo" = #{被保険者番号}
     ORDER BY
          D."tekiyoKaishiYMD"  DESC  
     
</select>
</mapper>