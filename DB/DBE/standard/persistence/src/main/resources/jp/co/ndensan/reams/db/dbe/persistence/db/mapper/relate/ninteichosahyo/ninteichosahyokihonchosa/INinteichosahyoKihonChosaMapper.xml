<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 認定調査票（基本調査）のマッピング用XMLです。 -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.ninteichosahyo.ninteichosahyokihonchosa.INinteichosahyoKihonChosaMapper">

    <select id="select認定調査票_基本調査ByKey" resultMap="resultMap_NinteichosahyoKihonChosaEntity" fetchSize="500">
        <include refid="selectNinteichosahyoKihonChosaEntity" />
    </select>

    <select id="select認定調査票_基本調査リストBy主キー1" resultMap="resultMap_NinteichosahyoKihonChosaEntity" fetchSize="500">
        <include refid="selectNinteichosahyoKihonChosaEntity" />
    </select>

    <!-- TODO RelateEntityを取得できるSQLに修正してください。where句はMapperParameterクラスに合わせて修正します。 -->
    <sql id="selectNinteichosahyoKihonChosaEntity">
        SELECT
        dbT5203NinteichosahyoKihonChosa.*,
        dbT5211NinteichosahyoChosaItem.*,
        ninteichosahyoKihonChosaScore.*
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5203NinteichosahyoKihonChosaMapper.noDeleted_DbT5203NinteichosahyoKihonChosa" />) AS dbT5203NinteichosahyoKihonChosa
        LEFT JOIN
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5211NinteichosahyoChosaItemMapper.noDeleted_DbT5211NinteichosahyoChosaItem" />) AS dbT5211NinteichosahyoChosaItem
        ON
        dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_shinseishoKanriNo" = dbT5211NinteichosahyoChosaItem."dbT5211NinteichosahyoChosaItem_shinseishoKanriNo" AND
        dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_ninteichosaRirekiNo" = dbT5211NinteichosahyoChosaItem."dbT5211NinteichosahyoChosaItem_ninteichosaRirekiNo"
        LEFT JOIN 
        (   SELECT 
            dbT5204NinteichosahyoKihonChosaScore.*,
            dbT5212NinteichosahyoKihonChosaScoreItem.*
            FROM 
            (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5204NinteichosahyoKihonChosaScoreMapper.noDeleted_DbT5204NinteichosahyoKihonChosaScore" />) AS dbT5204NinteichosahyoKihonChosaScore
            LEFT JOIN
            (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5212NinteichosahyoKihonChosaScoreItemMapper.noDeleted_DbT5212NinteichosahyoKihonChosaScoreItem" />) AS dbT5212NinteichosahyoKihonChosaScoreItem
            ON
            dbT5204NinteichosahyoKihonChosaScore."dbT5204NinteichosahyoKihonChosaScore_shinseishoKanriNo" = dbT5212NinteichosahyoKihonChosaScoreItem."dbT5212NinteichosahyoKihonChosaScoreItem_shinseishoKanriNo" AND
            dbT5204NinteichosahyoKihonChosaScore."dbT5204NinteichosahyoKihonChosaScore_ninteichosaRirekiNo" = dbT5212NinteichosahyoKihonChosaScoreItem."dbT5212NinteichosahyoKihonChosaScoreItem_ninteichosaRirekiNo"
        ) AS ninteichosahyoKihonChosaScore
        ON
        dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_shinseishoKanriNo" = ninteichosahyoKihonChosaScore."dbT5204NinteichosahyoKihonChosaScore_shinseishoKanriNo" AND
        dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_ninteichosaRirekiNo" = ninteichosahyoKihonChosaScore."dbT5204NinteichosahyoKihonChosaScore_ninteichosaRirekiNo"
        WHERE
          dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_shinseishoKanriNo" = #{shinseishoKanriNo}
          AND dbT5203NinteichosahyoKihonChosa."dbT5203NinteichosahyoKihonChosa_ninteichosaRirekiNo" = #{ninteichosaRirekiNo}
    </sql>

    <!-- TODO RelateEntityの形に合わせてマッピング定義を修正してください。 -->
    <resultMap id="resultMap_NinteichosahyoKihonChosaEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninteichosahyo.ninteichosahyokihonchosa.NinteichosahyoKihonChosaEntity" autoMapping="true">
        <id property="認定調査票_基本調査Entity.shinseishoKanriNo" column="dbT5203NinteichosahyoKihonChosa_shinseishoKanriNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShinseishoKanriNoTypeHandler"/>
        <id property="認定調査票_基本調査Entity.ninteichosaRirekiNo" column="dbT5203NinteichosahyoKihonChosa_ninteichosaRirekiNo"/>
        <association property="認定調査票_基本調査Entity" resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5203NinteichosahyoKihonChosaMapper.ResultMap_DbT5203NinteichosahyoKihonChosaEntity"/>
        <collection property="認定調査票_基本調査_調査項目Entity" resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5211NinteichosahyoChosaItemMapper.ResultMap_DbT5211NinteichosahyoChosaItemEntity"/>
        <collection property="認定調査票_基本調査素点Entity" resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.ninteichosahyo.ninteichosahyokihonchosascore.INinteichosahyoKihonChosaScoreMapper.resultMap_NinteichosahyoKihonChosaScoreEntity"/>
    </resultMap>

</mapper>
