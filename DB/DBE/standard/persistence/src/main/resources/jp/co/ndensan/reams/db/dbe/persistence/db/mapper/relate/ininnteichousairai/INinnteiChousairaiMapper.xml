<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 認定調査依頼のマッピング用XMLです。 -->
<!-- @reamsid_L DBE-0010-010 sunhaidi -->
<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.ininnteichousairai.INinnteiChousairaiMapper">
    <select resultOrdered="true" id="select認定調査委託先件数" resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.NinnteiChousairaiParameter" fetchSize="1000">
        SELECT
            COUNT(*)
        FROM
            (SELECT *
             FROM rgdb."DbT5910NinteichosaItakusakiJoho"
             WHERE "DbT5910NinteichosaItakusakiJoho"."jokyoFlag" = TRUE
                   <if test= "!市町村コード.isEmpty()">
                   AND "DbT5910NinteichosaItakusakiJoho"."shichosonCode" = #{市町村コード}
                   </if>
                   <if test= "認定調査委託先コード!=null">
                   AND "DbT5910NinteichosaItakusakiJoho"."ninteichosaItakusakiCode" = #{認定調査委託先コード}
                   </if>
            ) AS "DbT5910NinteichosaItakusakiJoho"
    </select>

    <select resultOrdered="true" id="select認定調査委託先情報" resultMap="result_NinnteiChousairaiEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.NinnteiChousairaiParameter" fetchSize="1000">
        SELECT
            "DbT5910NinteichosaItakusakiJoho"."ninteichosaItakusakiCode" AS temp_ninteichosaitakusakicode,
            "DbT5910NinteichosaItakusakiJoho"."jigyoshaMeisho" AS temp_jigyoshameisho,
            "DbT5910NinteichosaItakusakiJoho"."waritsukeChiku" AS temp_waritsukechiku,
            "DbT5910NinteichosaItakusakiJoho"."waritsukeTeiin" AS temp_waritsuketeiin,
            "DbT5910NinteichosaItakusakiJoho"."jusho" AS temp_jusho,
            "DbT5910NinteichosaItakusakiJoho"."telNo" AS temp_telno,
            "DbT5910NinteichosaItakusakiJoho"."shichosonCode" AS temp_shichosoncode,
            "DbT7051KoseiShichosonMaster"."shichosonMeisho" AS shichosonmeisho,
            "DbT5910NinteichosaItakusakiJoho"."chosaItakuKubun" AS temp_chosaItakuKubun,
            case when waritsukezumi.waritsukecount is not null
                then waritsukezumi.waritsukecount
                else 0
            end AS temp_waritsukecount,
            "DbT7051KoseiShichosonMaster"."shoKisaiHokenshaNo" AS shokisaihokenshano,
            case when iraizumi.iraicount is not null
                then iraizumi.iraicount
                else 0
            end AS temp_iraicount
        FROM
            (SELECT *
             FROM rgdb."DbT5910NinteichosaItakusakiJoho"
             WHERE "DbT5910NinteichosaItakusakiJoho"."jokyoFlag" = TRUE
                   <if test= "!市町村コード.isEmpty()">
                   AND "DbT5910NinteichosaItakusakiJoho"."shichosonCode" = #{市町村コード}
                   </if>
                   <if test= "認定調査委託先コード!=null">
                   AND "DbT5910NinteichosaItakusakiJoho"."ninteichosaItakusakiCode" = #{認定調査委託先コード}
                   </if>
            ) AS "DbT5910NinteichosaItakusakiJoho"
            LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" AS "DbT7051KoseiShichosonMaster"
                ON "DbT7051KoseiShichosonMaster"."shichosonCode" = "DbT5910NinteichosaItakusakiJoho"."shichosonCode"
            LEFT JOIN
                (SELECT
                    dbt5101."shoKisaiHokenshaNo",
                    dbt5101."ninteiChosaItakusakiCode",
                    count(*) AS waritsukecount
                 FROM
                    rgdb."DbT5101NinteiShinseiJoho" dbt5101
                    INNER JOIN rgdb."DbT5201NinteichosaIraiJoho" AS dbt5201
                        ON dbt5201."shinseishoKanriNo"=dbt5101."shinseishoKanriNo"
                           AND dbt5201."ninteichosaIraiRirekiNo" = (SELECT MAX(rgdb."DbT5201NinteichosaIraiJoho"."ninteichosaIraiRirekiNo")
                                                                    FROM rgdb."DbT5201NinteichosaIraiJoho"
                                                                    WHERE dbt5101."shinseishoKanriNo" = "shinseishoKanriNo")
                           AND dbt5201."logicalDeletedFlag" = FALSE
                    INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS dbt5105
                        ON dbt5101."shinseishoKanriNo" = dbt5105."shinseishoKanriNo"
                           AND dbt5105."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
                           AND dbt5105."ninteichosaIraiKanryoYMD" IS NOT NULL
                           AND dbt5105."ninteichosaKanryoYMD" IS NULL
                 WHERE
                    dbt5101."shoriJotaiKubun" IN ('0', '3')
                    <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                    AND dbt5101."shoKisaiHokenshaNo" = #{証記載保険者番号}
                    </if>
                    AND dbt5101."logicalDeletedFlag" = FALSE
                GROUP BY
                    dbt5101."shoKisaiHokenshaNo",
                    dbt5101."ninteiChosaItakusakiCode"
                ) AS waritsukezumi
                ON "DbT7051KoseiShichosonMaster"."shoKisaiHokenshaNo"=waritsukezumi."shoKisaiHokenshaNo"
                   AND "DbT5910NinteichosaItakusakiJoho"."ninteichosaItakusakiCode"=waritsukezumi."ninteiChosaItakusakiCode"
            LEFT JOIN
                (SELECT
                    dbt5101."shoKisaiHokenshaNo",
                    dbt5201."ninteichosaItakusakiCode",
                    count(*) AS iraicount
                 FROM
                    rgdb."DbT5101NinteiShinseiJoho" dbt5101
                    INNER JOIN rgdb."DbT5201NinteichosaIraiJoho" AS dbt5201
                        ON dbt5201."shinseishoKanriNo"=dbt5101."shinseishoKanriNo"
                           AND #{依頼件数集計開始日} <![CDATA[<=]]> dbt5201."ninteichosaIraiYMD"
                           AND dbt5201."ninteichosaIraiYMD" <![CDATA[<=]]> #{依頼件数集計終了日}
                    INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS dbt5105
                        ON dbt5101."shinseishoKanriNo" = dbt5105."shinseishoKanriNo"
                           AND dbt5105."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
                           AND dbt5105."ninteichosaIraiKanryoYMD" IS NOT NULL
                WHERE
                    dbt5101."shoriJotaiKubun" IN ('0', '3')
                    <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                    AND dbt5101."shoKisaiHokenshaNo" = #{証記載保険者番号}
                    </if>
                    <if test="uses支所コード">
                    AND dbT5101a."shishoCode" = #{支所コード}
                    </if>
                    AND dbt5101."logicalDeletedFlag" = FALSE
                GROUP BY
                    dbt5101."shoKisaiHokenshaNo",
                    dbt5201."ninteichosaItakusakiCode"
                ) AS iraizumi
                ON "DbT7051KoseiShichosonMaster"."shoKisaiHokenshaNo"=iraizumi."shoKisaiHokenshaNo"
                   AND "DbT5910NinteichosaItakusakiJoho"."ninteichosaItakusakiCode"=iraizumi."ninteichosaItakusakiCode"
        ORDER BY
            temp_iraicount desc,
            temp_shichosoncode,
            temp_ninteichosaitakusakicode
        LIMIT
            #{最大表示件数}
    </select>

    <resultMap id="result_NinnteiChousairaiEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousairai.NinnteiChousairaiEntity">
        <result property="ninteichosaItakusakiCode" column="temp_ninteichosaitakusakicode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jigyoshaMeisho" column="temp_jigyoshameisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="waritsukeChiku" column="temp_waritsukechiku" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ChikuCodeTypeHandler"/>
        <result property="waritsukeTeiin" column="temp_waritsuketeiin"/>
        <result property="jusho" column="temp_jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="telNo" column="temp_telno" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="shichosonCode" column="temp_shichosoncode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler"/>
        <result property="chosaItakuKubun" column="temp_chosaItakuKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shichosonMeisho" column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="waritsukesumiKensu" column="temp_waritsukecount"/>
        <result property="shoKisaiHokenshaNo" column="shokisaihokenshano" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="iraiKensu" column="temp_iraicount"/>
    </resultMap>

    <select resultOrdered="true" id="select調査員" resultMap="result_ChousaIn"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.NinnteiChousairaiParameter" fetchSize="1000">
        SELECT
        "DbT5913ChosainJoho"."ninteiChosainCode" AS Temp_ninteiChosainCode,
        "DbT5913ChosainJoho"."chosainShimei" AS Temp_chosainShimei,
        "DbT5913ChosainJoho"."chosainKanaShimei" AS Temp_chosainKanaShimei,
        "DbT5913ChosainJoho"."seibetsu" AS Temp_seibetsu,
        "DbT5913ChosainJoho"."telNo" AS Temp_telNo,
        "DbT5913ChosainJoho"."chikuCode" AS Temp_chikuCode,
        "DbT5913ChosainJoho"."chosainShikaku" AS Temp_chosainShikaku,
        "DbT5913ChosainJoho"."chosaKanoNinzuPerMonth" AS chosaKanoNinzuPerMonth,
        A.waritsukeCount AS Temp_waritsukeCount
        FROM
        rgdb."DbT5913ChosainJoho"
        LEFT JOIN (
        SELECT
        dbT5913."shichosonCode",
        dbT5913."ninteiChosaItakusakiCode",
        dbT5913."ninteiChosainCode",
        COUNT(*) as waritsukeCount
        FROM
        (
        SELECT *
        FROM rgdb."DbT5101NinteiShinseiJoho" dbT5101a
        WHERE
        dbT5101a."shoriJotaiKubun" IN ('0','3')
        <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
            AND dbT5101a."shoKisaiHokenshaNo" = #{証記載保険者番号}
        </if>
        AND dbT5101a."logicalDeletedFlag" = FALSE
        AND dbT5101a."ninteiChosaItakusakiCode" = #{認定調査委託先コード}
        <if test="uses支所コード">
            AND dbT5101a."shishoCode" = #{支所コード}
        </if>
        AND dbT5101a."ninteiShinseiShinseijiKubunCode" NOT IN ('A','B')
        ) AS dbT5101
        INNER JOIN
        rgdb."DbT7051KoseiShichosonMaster" ON dbT5101."shoKisaiHokenshaNo" = "DbT7051KoseiShichosonMaster"."shoKisaiHokenshaNo"
        INNER JOIN
        (SELECT
        dbT5201Nintei."shinseishoKanriNo" AS "shinseishoKanriNo",
        dbT5201Nintei."ninteichosaIraiRirekiNo" AS "ninteichosaIraiRirekiNo",
        dbT5201Nintei."ninteichosaItakusakiCode" AS "ninteiChosaItakusakiCode"
        FROM
        rgdb."DbT5201NinteichosaIraiJoho" AS dbT5201Nintei
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS dbT5105
        ON dbT5201Nintei."shinseishoKanriNo" = dbT5105."shinseishoKanriNo"
        AND dbT5105."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND dbT5105."ninteiShinsakaiWariateKanryoYMD" IS NULL
        AND dbT5105."ninteiShinsakaiKanryoYMD" IS NULL
        AND dbT5105."centerSoshinYMD" IS NULL
        INNER JOIN
        (SELECT
        MAX(dbT5201NinteichosaIraiJoho."ninteichosaIraiRirekiNo") AS "ninteichosaIraiRirekiNo",
        dbT5201NinteichosaIraiJoho."shinseishoKanriNo" AS "shinseishoKanriNo"
        FROM
        rgdb."DbT5201NinteichosaIraiJoho" AS dbT5201NinteichosaIraiJoho
        GROUP BY
        dbT5201NinteichosaIraiJoho."shinseishoKanriNo"
        ) AS shinseishosaidairirekishoNo
        ON dbT5201Nintei."shinseishoKanriNo" = shinseishosaidairirekishoNo."shinseishoKanriNo"
        AND
        dbT5201Nintei."ninteichosaIraiRirekiNo" = shinseishosaidairirekishoNo."ninteichosaIraiRirekiNo"
        AND dbT5201Nintei."logicalDeletedFlag" = FALSE
        ) AS dbT5201Waritukezumi
        ON dbT5101."shinseishoKanriNo" = dbT5201Waritukezumi."shinseishoKanriNo"
        AND dbT5101."ninteiChosaItakusakiCode" = dbT5201Waritukezumi."ninteiChosaItakusakiCode"
        INNER JOIN rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
        ON dbT7051."shoKisaiHokenshaNo" = dbT5101."shoKisaiHokenshaNo"
        LEFT JOIN rgdb."DbT5913ChosainJoho" AS dbT5913
        ON dbT5913."shichosonCode" = dbT7051."shichosonCode"
        AND dbT5913."ninteiChosaItakusakiCode" = dbT5101."ninteiChosaItakusakiCode"
        AND dbT5913."ninteiChosainCode" = dbT5101."ninteiChosainCode"
        LEFT JOIN rgdb."DbT5910NinteichosaItakusakiJoho" AS dbT5910
        ON dbT5910."shichosonCode" = dbT7051."shichosonCode"
        AND dbT5910."ninteichosaItakusakiCode" = dbT5913."ninteiChosaItakusakiCode"
        GROUP BY
        dbT5913."shichosonCode",
        dbT5913."ninteiChosaItakusakiCode",
        dbT5913."ninteiChosainCode"
        ) AS A
        ON "DbT5913ChosainJoho"."shichosonCode" = A."shichosonCode"
        AND "DbT5913ChosainJoho"."ninteiChosaItakusakiCode" = A."ninteiChosaItakusakiCode"
        AND "DbT5913ChosainJoho"."ninteiChosainCode" = A."ninteiChosainCode"
        WHERE
        "DbT5913ChosainJoho"."ninteiChosaItakusakiCode" = #{認定調査委託先コード}
        <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
            AND "DbT5913ChosainJoho"."shichosonCode" IN (
            SELECT
            dbT7051."shichosonCode" AS shichosonCode
            FROM
            rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
            WHERE
            dbT7051."shoKisaiHokenshaNo" = #{証記載保険者番号}
            )
        </if>
        AND "DbT5913ChosainJoho"."jokyoFlag" = TRUE
    </select>

    <resultMap id="result_ChousaIn" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousairai.NinnteiChousairaiEntity">
        <result property="ninteiChosainNo" column="Temp_ninteiChosainCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosainShimei" column="Temp_chosainShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosainKanaShimei" column="Temp_chosainKanaShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="seibetsu" column="Temp_seibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="telNo" column="Temp_telNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="chikuCode" column="Temp_chikuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="chosainShikaku" column="Temp_chosainShikaku" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="waritsukesumiKensu" column="Temp_waritsukeCount"/>
        <result property="chosaKanoNinzuPerMonth" column="chosaKanoNinzuPerMonth" />
    </resultMap>

    <select resultOrdered="true" id="select割付済み申請者" resultMap="result_WaritsukeEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.NinnteiChousairaiParameter" fetchSize="1000">
        SELECT
            dbT5101."koroshoIfShikibetsuCode" AS "koroshoIfShikibetsuCode",
            dbT5101."hihokenshaNo" AS "hihokenshaNo",
            dbT5101."hihokenshaName" AS "hihokenshaName",
            dbT5101."seibetsu" AS "seibetsu",
            dbT5101."ninteiShinseiYMD" AS "ninteiShinseiYMD",
            dbT5101."ninteiShinseiShinseijiKubunCode" AS "ninteiShinseiKubunCode",
            dbT5101."chikuCode" AS "chikuCode",
            CASE WHEN "DbT5201NinteichosaIraiJoho"."ninteichosaIraiKubunCode" IS NOT NULL
                THEN "DbT5201NinteichosaIraiJoho"."ninteichosaIraiKubunCode"
                ELSE '0'
            END AS "chosaKubun",
            dbT5101."jusho" AS "jusho",
            dbT5101."hihokenshaKana" AS "hihokenshaKana",
            dbT5101."seinengappiYMD" AS "seinengappiYMD",
            dbT5101."yubinNo" AS "yubinNo",
            dbT5101."telNo" AS "telNo",
            dbT5101."homonChosasakiYubinNo" AS "homonChosasakiYubinNo",
            dbT5101."homonChosasakiJusho" AS "homonChosasakiJusho",
            dbT5101."homonChosasakiName" AS "homonChosasakiName",
            dbT5101."homonChosasakiTelNo" AS "homonChosasakiTelNo",
            dbT5101."ninteiShinseiYMD" AS "ninteiShinseiYMDKoShin",
            dbT5101."zenkaiNinteiYMD" AS "zenkaiNinteiYMD",
            dbT5101."zenYokaigoKubunCode" AS "zenYokaigoKubunCode",
            dbT5101."age" AS "age",
            dbT5911."iryoKikanMeisho" AS "iryoKikanMeisho",
            dbT5912."shujiiName" AS "shujiiName",
            dbT5910Zenkai."jigyoshaMeisho" AS "Temp_jigyoshaMeisho",
            dbT5911Zenkai."iryoKikanMeisho" AS "Temp_iryoKikanMeisho",
            dbT5912Zenkai."shujiiName" AS "Temp_shujiiName",
            dbT5913Zenkai."chosainShimei" AS "Temp_chosainShimei",
            dbT5101."shinseishoKanriNo" AS "shinseishoKanriNo",
            dbT5201Waritukezumi."ninteichosaIraiRirekiNo" AS "ninteichosaIraiRirekiNo",
            "DbT5201NinteichosaIraiJoho"."ninteiChosainCode" AS "ninteiChosainCode",
            dbT5101."shoKisaiHokenshaNo" AS "hokenshaNo",
            dbT5913."shichosonCode" AS "shichosonCode",
            G."renrakusakiShimei" AS "renrakusakiShimei",
            G."renrakusakiYubinNo" AS "renrakusakiYubinNo",
            G."renrakusakiTelNo" AS "renrakusakiTelNo",
            G."renrakusakiKeitaiTelNo" AS "renrakusakiKeitaiTelNo",
            G."renrakusakiJusho" AS "renrakusakiJusho",
            G."renrakusakiTuzukigara" AS "renrakusakiTuzukigara",
            <include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5105NinteiKanryoJohoMapper.allColumns_DbT5105NinteiKanryoJoho" />,
            <include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5201NinteichosaIraiJohoMapper.allColumns_DbT5201NinteichosaIraiJoho" />
        FROM
            (SELECT
                *
             FROM
                rgdb."DbT5101NinteiShinseiJoho" dbT5101a
             WHERE
                dbT5101a."shoriJotaiKubun" IN ('0','3')
                <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                AND dbT5101a."shoKisaiHokenshaNo" = #{証記載保険者番号}
                </if>
                AND dbT5101a."logicalDeletedFlag" = FALSE
                AND dbT5101a."ninteiChosaItakusakiCode" = #{認定調査委託先コード}
                <if test="uses調査員コード">
                AND dbT5101a."ninteiChosainCode" = #{認定調査員コード}
                </if>
                <if test="uses支所コード">
                AND dbT5101a."shishoCode" = #{支所コード}
                </if>
                AND dbT5101a."ninteiShinseiShinseijiKubunCode" NOT IN ('A','B')
            ) AS dbT5101
            INNER JOIN
                (SELECT
                    dbT5201Nintei."shinseishoKanriNo" AS "shinseishoKanriNo",
                    dbT5201Nintei."ninteichosaIraiRirekiNo" AS "ninteichosaIraiRirekiNo",
                    dbT5201Nintei."ninteichosaItakusakiCode" AS "ninteiChosaItakusakiCode"
                 FROM
                    rgdb."DbT5201NinteichosaIraiJoho" AS dbT5201Nintei
                    INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS dbT5105
                        ON dbT5201Nintei."shinseishoKanriNo" = dbT5105."shinseishoKanriNo"
                           AND dbT5105."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
                           AND dbT5105."ninteiShinsakaiWariateKanryoYMD" IS NULL
                           AND dbT5105."ninteiShinsakaiKanryoYMD" IS NULL
                           AND dbT5105."centerSoshinYMD" IS NULL
                    INNER JOIN
                        (SELECT
                            MAX(dbT5201NinteichosaIraiJoho."ninteichosaIraiRirekiNo") AS "ninteichosaIraiRirekiNo",
                            dbT5201NinteichosaIraiJoho."shinseishoKanriNo" AS "shinseishoKanriNo"
                         FROM
                            rgdb."DbT5201NinteichosaIraiJoho" AS dbT5201NinteichosaIraiJoho
                         GROUP BY
                            dbT5201NinteichosaIraiJoho."shinseishoKanriNo"
                        ) AS shinseishosaidairirekishoNo
                        ON dbT5201Nintei."shinseishoKanriNo" = shinseishosaidairirekishoNo."shinseishoKanriNo"
                           AND dbT5201Nintei."ninteichosaIraiRirekiNo" = shinseishosaidairirekishoNo."ninteichosaIraiRirekiNo"
                           AND dbT5201Nintei."logicalDeletedFlag" = FALSE
                ) AS dbT5201Waritukezumi
                ON dbT5101."shinseishoKanriNo" = dbT5201Waritukezumi."shinseishoKanriNo"
                   AND dbT5101."ninteiChosaItakusakiCode" = dbT5201Waritukezumi."ninteiChosaItakusakiCode"
            INNER JOIN rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
                ON dbT7051."shoKisaiHokenshaNo" = dbT5101."shoKisaiHokenshaNo"
            LEFT JOIN rgdb."DbT5913ChosainJoho" AS dbT5913
                ON dbT5913."shichosonCode" = dbT7051."shichosonCode"
                   AND dbT5913."ninteiChosaItakusakiCode" = dbT5101."ninteiChosaItakusakiCode"
                   AND dbT5913."ninteiChosainCode" = dbT5101."ninteiChosainCode"
            LEFT JOIN rgdb."DbT5910NinteichosaItakusakiJoho" AS dbT5910
                ON dbT5910."shichosonCode" = dbT7051."shichosonCode"
                   AND dbT5910."ninteichosaItakusakiCode" = dbT5913."ninteiChosaItakusakiCode"
            LEFT JOIN rgdb."DbT5911ShujiiIryoKikanJoho" AS dbT5911
                ON dbT5911."shichosonCode" = dbT7051."shichosonCode"
                   AND dbT5911."shujiiIryokikanCode" = dbT5101."shujiiIryokikanCode"
                   <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                   AND dbT5911."shichosonCode" IN (
                        SELECT
                            dbT7051."shichosonCode" AS shichosonCode
                        FROM
                            rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
                        WHERE
                            dbT7051."shoKisaiHokenshaNo" = #{証記載保険者番号}
                   )
                   </if>
                   AND dbT5911."jokyoFlag" = TRUE
            LEFT JOIN rgdb."DbT5912ShujiiJoho" AS dbT5912
                ON dbT5912."shichosonCode" = dbT7051."shichosonCode"
                   AND dbT5912."shujiiIryokikanCode" = dbT5101."shujiiIryokikanCode"
                   <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                   AND dbT5912."shichosonCode" IN (
                        SELECT
                            dbT7051."shichosonCode" AS shichosonCode
                        FROM
                            rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
                        WHERE
                            dbT7051."shoKisaiHokenshaNo" = #{証記載保険者番号}
                   )
                   </if>
                   AND dbT5912."shujiiCode" = dbT5101."shujiiCode"
                   AND dbT5912."jokyoFlag" = TRUE
            LEFT JOIN rgdb."DbT5121ShinseiRirekiJoho" AS dbT5121
                ON dbT5121."shinseishoKanriNo" = dbT5201Waritukezumi."shinseishoKanriNo"
            LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" AS dbT5101Zenkai
                ON dbT5101Zenkai."shinseishoKanriNo" = dbT5121."zenkaiShinseishoKanriNo"
            LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" AS dbT7051Zenkai
                ON dbT7051Zenkai."shoKisaiHokenshaNo" = dbT5101Zenkai."shoKisaiHokenshaNo"
            LEFT JOIN rgdb."DbT5913ChosainJoho" AS dbT5913Zenkai
                ON dbT5913Zenkai."shichosonCode" = dbT7051Zenkai."shichosonCode"
                   AND dbT5913Zenkai."ninteiChosaItakusakiCode" = dbT5101Zenkai."ninteiChosaItakusakiCode"
                   AND dbT5913Zenkai."ninteiChosainCode" = dbT5101Zenkai."ninteiChosainCode"
                   AND dbT5913Zenkai."jokyoFlag" = TRUE
            LEFT JOIN rgdb."DbT5910NinteichosaItakusakiJoho" AS dbT5910Zenkai
                ON dbT5910Zenkai."shichosonCode" = dbT7051Zenkai."shichosonCode"
                   AND dbT5910Zenkai."ninteichosaItakusakiCode" = dbT5101Zenkai."ninteiChosaItakusakiCode"
                   AND dbT5910Zenkai."jokyoFlag" = TRUE
            LEFT JOIN rgdb."DbT5201NinteichosaIraiJoho" AS "DbT5201NinteichosaIraiJoho"
                ON "DbT5201NinteichosaIraiJoho"."shinseishoKanriNo" = dbT5201Waritukezumi."shinseishoKanriNo"
                   AND "DbT5201NinteichosaIraiJoho"."logicalDeletedFlag" = FALSE
            LEFT JOIN rgdb."DbT5911ShujiiIryoKikanJoho" AS dbT5911Zenkai
                ON dbT5911Zenkai."shujiiIryokikanCode" = dbT5101Zenkai."shujiiIryokikanCode"
                   <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                   AND dbT5911Zenkai."shichosonCode" IN (
                        SELECT
                            dbT7051."shichosonCode" AS shichosonCode
                        FROM
                            rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
                        WHERE
                            dbT7051."shoKisaiHokenshaNo" = #{証記載保険者番号}
                   )
                   </if>
                   AND dbT5911Zenkai."jokyoFlag" = TRUE
            LEFT JOIN rgdb."DbT5912ShujiiJoho" AS dbT5912Zenkai
                ON dbT5912Zenkai."shujiiIryokikanCode" = dbT5101Zenkai."shujiiIryokikanCode"
                   <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                   AND dbT5912Zenkai."shichosonCode" IN (
                        SELECT
                            dbT7051."shichosonCode" AS shichosonCode
                        FROM
                            rgdb."DbT7051KoseiShichosonMaster" AS dbT7051
                        WHERE
                            dbT7051."shoKisaiHokenshaNo" = #{証記載保険者番号}
                   )
                   </if>
                   AND dbT5912Zenkai."shujiiCode" = dbT5101Zenkai."shujiiCode"
                   AND dbT5912Zenkai."jokyoFlag" = TRUE
            INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS "DbT5105NinteiKanryoJoho"
                ON dbT5101."shinseishoKanriNo" = "DbT5105NinteiKanryoJoho"."shinseishoKanriNo"
            LEFT JOIN rgdb."DbT5150RenrakusakiJoho" AS G
                ON dbT5101."shinseishoKanriNo" =  G."shinseishoKanriNo"
                   AND NOT EXISTS (
                        SELECT 'X'
                        FROM rgdb."DbT5150RenrakusakiJoho" AS G1
                        WHERE  G."shinseishoKanriNo" = G1."shinseishoKanriNo"
                               AND G.renban <![CDATA[<]]> G1.renban
                   )
        WHERE
            dbT5913."jokyoFlag" = 'true'
            OR ("DbT5201NinteichosaIraiJoho"."ninteiChosainCode" IS NULL OR "DbT5201NinteichosaIraiJoho"."ninteiChosainCode"  = '')
        ORDER BY
            dbT5101."ninteiChosaItakusakiCode",
            dbT5101."ninteiChosainCode",
            "DbT5201NinteichosaIraiJoho"."iraishoShutsuryokuYMD"
    </select>

    <resultMap id="result_WaritsukeEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousairai.WaritsukeEntity">
        <result property="koroshoIfShikibetsuCode" column="koroshoIfShikibetsuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="hihokenshaNo" column="hihokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="hihokenshaName" column="hihokenshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="seibetsu" column="seibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="ninteiShinseiYMD" column="ninteiShinseiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="ninteiShinseiKubunCode" column="ninteiShinseiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="chikuCode" column="chikuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ChikuCodeTypeHandler"/>
        <result property="chosaKubun" column="chosaKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="jusho" column="jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler"/>
        <result property="hihokenshaKana" column="hihokenshaKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaKanaMeishoTypeHandler"/>
        <result property="seinengappiYMD" column="seinengappiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="yubinNo" column="yubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="telNo" column="telNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="homonChosasakiYubinNo" column="homonChosasakiYubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="homonChosasakiJusho" column="homonChosasakiJusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler"/>
        <result property="homonChosasakiName" column="homonChosasakiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="homonChosasakiTelNo" column="homonChosasakiTelNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="ninteiShinseiYMDKoShin" column="ninteiShinseiYMDKoShin" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="zenkaiNinteiYMD" column="zenkaiNinteiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="zenYokaigoKubunCode" column="zenYokaigoKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="age" column="age" />
        <result property="waritsukeTeiin" column="waritsukeTeiin" />
        <result property="iryoKikanMeisho" column="iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shujiiName" column="shujiiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="chosaKanoNinzuPerMonth" column="chosaKanoNinzuPerMonth" />
        <result property="temp_jigyoshaMeisho" column="Temp_jigyoshaMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="temp_iryoKikanMeisho" column="Temp_iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="temp_shujiiName" column="Temp_shujiiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="temp_chosainShimei" column="Temp_chosainShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shinseishoKanriNo" column="shinseishoKanriNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="ninteichosaIraiRirekiNo" column="ninteichosaIraiRirekiNo"/>
        <result property="hokenshaNo" column="hokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shichosonCode" column="shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="renrakusakiTuzukigara" column="renrakusakiTuzukigara" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="renrakusakiYubinNo" column="renrakusakiYubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="renrakusakiJusho" column="renrakusakiJusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler"/>
        <result property="renrakusakiTelNo" column="renrakusakiTelNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="renrakusakiKeitaiTelNo" column="renrakusakiKeitaiTelNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="renrakusakiShimei" column="renrakusakiShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <association property="ninteiKanryoJohoEntity" resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5105NinteiKanryoJohoMapper.ResultMap_DbT5105NinteiKanryoJohoEntity"/>
        <association property="ninteichosaIraiJohoEntity" resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5201NinteichosaIraiJohoMapper.ResultMap_DbT5201NinteichosaIraiJohoEntity"/>
    </resultMap>

    <select resultOrdered="true" id="select未割付申請者" resultMap="result_ShiteWaritsukeEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.NinnteiChousairaiParameter" fetchSize="1000">
        SELECT
            dbt5101."koroshoIfShikibetsuCode" AS "koroshoIfShikibetsuCode",
            dbt5101."hihokenshaNo" AS "hihokenshaNo",
            dbt5101."hihokenshaName" AS "hihokenshaName",
            dbt5101."seibetsu" AS "seibetsu",
            dbt5101."ninteiShinseiYMD" AS "ninteiShinseiYMD",
            dbt5101."ninteiShinseiShinseijiKubunCode" AS "ninteiShinseiKubunCode",
            dbt5101."chikuCode" AS "chikuCode",
            CASE WHEN dbt5201."shinseishoKanriNo" IS NOT NULL
                THEN '1'
                ELSE '0'
            END AS "chosaKubun",
            dbt5101."jusho" AS "jusho",
            dbt5911shujii."iryoKikanMeisho" AS iryokikanmeisho,
            dbt5912shujii."shujiiName" AS shujiiname,
            dbt5911zenkai."iryoKikanMeisho" AS temp_iryokikanmeisho,
            dbt5912zenkai."shujiiName" AS temp_shujiiname,
            dbt5910zenkai."jigyoshaMeisho" AS jigyoshameisho,
            dbt5913zenkai."chosainShimei" AS chosainshimei,
            dbt5101."shinseishoKanriNo" AS "shinseishoKanriNo",
            dbt5201."ninteichosaIraiRirekiNo" AS "ninteichosaIraiRirekiNo",
            dbt5101."ninteiChosainCode" AS "ninteiChosainCode"
        FROM
            (SELECT *
             FROM rgdb."DbT5101NinteiShinseiJoho" dbt5101a
             WHERE dbt5101a."shoriJotaiKubun" IN ('0', '3')
                   <if test= "証記載保険者番号!=null and !証記載保険者番号.isEmpty()">
                   AND dbt5101a."shoKisaiHokenshaNo" = #{証記載保険者番号}
                   </if>
                   <if test="uses支所コード">
                   AND dbt5101a"shishoCode" = #{支所コード}
                   </if>
                   AND dbt5101a."ninteiShinseiShinseijiKubunCode" NOT IN ('5', '6', 'A', 'B')
                   AND dbt5101a."logicalDeletedFlag" = FALSE
            ) AS dbt5101
            LEFT JOIN rgdb."DbT5201NinteichosaIraiJoho" AS DbT5201
                ON DbT5201."shinseishoKanriNo"=DbT5101."shinseishoKanriNo"
                   AND DbT5201."ninteichosaIraiRirekiNo" = (SELECT MAX(rgdb."DbT5201NinteichosaIraiJoho"."ninteichosaIraiRirekiNo")
                                                            FROM rgdb."DbT5201NinteichosaIraiJoho"
                                                            WHERE DbT5101."shinseishoKanriNo" = "shinseishoKanriNo")
            INNER JOIN rgdb."DbT5105NinteiKanryoJoho" AS dbt5105nintei
                ON dbt5101."shinseishoKanriNo" = dbt5105nintei."shinseishoKanriNo"
                   AND dbt5105nintei."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
                   AND dbt5105nintei."ninteichosaIraiKanryoYMD" IS NULL
            INNER JOIN rgdb."DbT7051KoseiShichosonMaster" AS dbt7051
                ON dbt7051."shoKisaiHokenshaNo" = dbt5101."shoKisaiHokenshaNo"
            LEFT JOIN rgdb."DbT5911ShujiiIryoKikanJoho" AS dbt5911shujii
                ON dbt5911shujii."shichosonCode" = dbt7051."shichosonCode"
                   AND dbt5911shujii."shujiiIryokikanCode" = dbt5101."shujiiIryokikanCode"
            LEFT JOIN rgdb."DbT5912ShujiiJoho" AS dbt5912shujii
                ON dbt5912shujii."shichosonCode" = dbt7051."shichosonCode"
                   AND dbt5912shujii."shujiiIryokikanCode" = dbt5101."shujiiIryokikanCode"
                   AND dbt5912shujii."shujiiCode" = dbt5101."shujiiCode"
            INNER JOIN rgdb."DbT5121ShinseiRirekiJoho" AS dbt5121shinsei
                ON dbt5121shinsei."shinseishoKanriNo" = dbt5101."shinseishoKanriNo"
            LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" AS dbt5101zenkai
                ON dbt5101zenkai."shinseishoKanriNo" = dbt5121shinsei."zenkaiShinseishoKanriNo"
            LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" AS dbt7051zenkai
                ON dbt7051zenkai."shoKisaiHokenshaNo" = dbt5101zenkai."shoKisaiHokenshaNo"
            LEFT JOIN rgdb."DbT5913ChosainJoho" AS dbt5913zenkai
                ON dbt5913zenkai."shichosonCode" = dbt7051zenkai."shichosonCode"
                   AND dbt5913zenkai."ninteiChosaItakusakiCode" = dbt5101zenkai."ninteiChosaItakusakiCode"
                   AND dbt5913zenkai."ninteiChosainCode" = dbt5101zenkai."ninteiChosainCode"
            LEFT JOIN rgdb."DbT5910NinteichosaItakusakiJoho" AS dbt5910zenkai
                ON dbt5910zenkai."shichosonCode" = dbt7051zenkai."shichosonCode"
                   AND dbt5910zenkai."ninteichosaItakusakiCode" = dbt5101zenkai."ninteiChosaItakusakiCode"
            LEFT JOIN rgdb."DbT5911ShujiiIryoKikanJoho" AS dbt5911zenkai
                ON dbt5911zenkai."shujiiIryokikanCode" = dbt5101zenkai."shujiiIryokikanCode"
                   AND dbt5911zenkai."shichosonCode" = dbt7051zenkai."shichosonCode"
            LEFT JOIN rgdb."DbT5912ShujiiJoho" AS dbt5912zenkai
                ON dbt5912zenkai."shujiiIryokikanCode" = dbt5101zenkai."shujiiIryokikanCode"
                   AND dbt5912zenkai."shichosonCode" = dbt7051zenkai."shichosonCode"
                   AND dbt5912zenkai."shujiiCode" = dbt5101zenkai."shujiiCode"
        WHERE
            dbt5201."shinseishoKanriNo" is null
            OR dbt5201."logicalDeletedFlag" = TRUE
        ORDER BY
            dbt5101."chosaKubun",
            dbt5101."ninteiShinseiYMD",
            dbt5101."hihokenshaKana"
    </select>

    <resultMap id="result_ShiteWaritsukeEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousairai.WaritsukeEntity">
        <result property="koroshoIfShikibetsuCode" column="koroshoIfShikibetsuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="hihokenshaNo" column="hihokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="hihokenshaName" column="hihokenshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="seibetsu" column="seibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="ninteiShinseiYMD" column="ninteiShinseiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="ninteiShinseiKubunCode" column="ninteiShinseiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="chikuCode" column="chikuCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.ChikuCodeTypeHandler"/>
        <result property="chosaKubun" column="chosaKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="jusho" column="jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler"/>
        <result property="iryoKikanMeisho" column="iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="temp_iryoKikanMeisho" column="Temp_iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shujiiName" column="shujiiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="temp_shujiiName" column="Temp_shujiiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
        <result property="temp_jigyoshaMeisho" column="jigyoshaMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="temp_chosainShimei" column="chosainShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shinseishoKanriNo" column="shinseishoKanriNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="ninteiChosainCode" column="ninteiChosainCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="ninteichosaIraiRirekiNo" column="ninteichosaIraiRirekiNo" />
    </resultMap>

    <select resultOrdered="true" id="select認定調査依頼情報"
            resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5201NinteichosaIraiJohoMapper.ResultMap_DbT5201NinteichosaIraiJohoEntity"
            parameterType="jp.co.ndensan.reams.uz.uza.lang.RString" fetchSize="1000">
        SELECT
        DbT5201NinteichosaIraiJoho.*
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5201NinteichosaIraiJohoMapper.noDeleted_DbT5201NinteichosaIraiJoho" />) AS DbT5201NinteichosaIraiJoho
        WHERE
        DbT5201NinteichosaIraiJoho."dbT5201NinteichosaIraiJoho_shinseishoKanriNo" = #{申請書管理番号}
        AND DbT5201NinteichosaIraiJoho."dbT5201NinteichosaIraiJoho_ninteichosaIraiRirekiNo"
        = (SELECT
        MAX(dbT5201Nintei."ninteichosaIraiRirekiNo")
        FROM
        rgdb."DbT5201NinteichosaIraiJoho" AS dbT5201Nintei
        WHERE
        dbT5201Nintei."shinseishoKanriNo" = #{申請書管理番号}
        )
    </select>

    <select resultOrdered="true" id="get認定調査票差異チェック票情報" resultMap="result_SaiChekkuhyoEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousairai.SaiChekkuhyoParameter" fetchSize="1000">
        SELECT
        DbT5116IchijiHanteiKekkaJoho."ichijiHanteiKekkaCode" AS "ichijiHanteiKekkaCode",
        DbT5102NinteiKekkaJoho."nijiHanteiYMD" AS "nijiHanteiYMD",
        DbT5102NinteiKekkaJoho."nijiHanteiYokaigoJotaiKubunCode" AS "nijiHanteiYokaigoJotaiKubun",
        DbT5211NinteichosahyoChosaItem."remban" AS "remban",
        DbT5211NinteichosahyoChosaItem."researchItem" AS "researchItem",
        DbT5203NinteichosahyoKihonChosa."ninchishoNichijoSeikatsuJiritsudoCode" AS "ninchishoSeikatsuJiritsudo",
        DbT5203NinteichosahyoKihonChosa."shogaiNichijoSeikatsuJiritsudoCode" AS "shogaiSeikatsuJiritsudo"
        FROM
        rgdb."DbT5101NinteiShinseiJoho" AS DbT5101NinteiShinseiJoho
        INNER JOIN rgdb."DbT5211NinteichosahyoChosaItem" AS DbT5211NinteichosahyoChosaItem
        ON DbT5101NinteiShinseiJoho."shinseishoKanriNo" = DbT5211NinteichosahyoChosaItem."shinseishoKanriNo"
        AND DbT5211NinteichosahyoChosaItem."ninteichosaRirekiNo"
        = (SELECT
        MAX("ninteichosaRirekiNo")
        FROM
        rgdb."DbT5211NinteichosahyoChosaItem" AS DbT5211
        WHERE
        DbT5101NinteiShinseiJoho."shinseishoKanriNo" = DbT5211."shinseishoKanriNo"
        GROUP BY
        "shinseishoKanriNo"
        )
        INNER JOIN rgdb."DbT5116IchijiHanteiKekkaJoho" AS DbT5116IchijiHanteiKekkaJoho
        ON DbT5101NinteiShinseiJoho."shinseishoKanriNo" = DbT5116IchijiHanteiKekkaJoho."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5102NinteiKekkaJoho" AS DbT5102NinteiKekkaJoho
        ON DbT5101NinteiShinseiJoho."shinseishoKanriNo" = DbT5102NinteiKekkaJoho."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5203NinteichosahyoKihonChosa" AS DbT5203NinteichosahyoKihonChosa
        ON DbT5203NinteichosahyoKihonChosa."shinseishoKanriNo" = DbT5101NinteiShinseiJoho."shinseishoKanriNo"
        WHERE
        DbT5101NinteiShinseiJoho."shoriJotaiKubun" IN (#{通常},#{延期})
        AND DbT5101NinteiShinseiJoho."logicalDeletedFlag" = false
        AND DbT5101NinteiShinseiJoho."shinseishoKanriNo"
        = (SELECT
        "zenkaiShinseishoKanriNo"
        FROM
        rgdb."DbT5121ShinseiRirekiJoho"
        WHERE
        "shinseishoKanriNo" = #{申請書管理番号} )
    </select>

    <resultMap id="result_SaiChekkuhyoEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousairai.SaiChekkuhyoEntity">
        <result property="ichijiHanteiKekkaCode" column="ichijiHanteiKekkaCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="nijiHanteiYMD" column="nijiHanteiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="nijiHanteiYokaigoJotaiKubun" column="nijiHanteiYokaigoJotaiKubun" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="remban" column="remban" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="researchItem" column="researchItem" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="ninchishoSeikatsuJiritsudo" column="ninchishoSeikatsuJiritsudo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shogaiSeikatsuJiritsudo" column="shogaiSeikatsuJiritsudo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    </resultMap>
</mapper>
