<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 構成市町村マスタのマッピング用XMLです。 -->
<!-- @reamsid_L DBE-0240-010 dongyabin -->
<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.shujiiiryokikanmaster.IKoseiShujiiIryoKikanMasterMapper">

    <select resultOrdered="true" id="selectShujiiIryoKikanJohoCount"
            resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiiiryokikanjohomaster.KoseiShujiiIryoKikanMasterSearchParameter">
        SELECT
        COUNT(0)
        FROM
        rgdb."DbT5911ShujiiIryoKikanJoho"
        WHERE
        "DbT5911ShujiiIryoKikanJoho"."isDeleted" = FALSE
        AND "DbT5911ShujiiIryoKikanJoho"."shichosonCode" = #{市町村コード}
        AND "DbT5911ShujiiIryoKikanJoho"."shujiiIryokikanCode" = #{主治医医療機関コード}
    </select>

    <select resultOrdered="true" id="selectShujiiJohoCount"
            resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiiiryokikanjohomaster.KoseiShujiiIryoKikanMasterSearchParameter">
        SELECT
        COUNT(0)
        FROM
        rgdb."DbT5912ShujiiJoho"
        WHERE
        "DbT5912ShujiiJoho"."isDeleted" = FALSE
        AND "DbT5912ShujiiJoho"."shichosonCode" = #{市町村コード}
        AND "DbT5912ShujiiJoho"."shujiiIryokikanCode" = #{主治医医療機関コード}
    </select>

    <select resultOrdered="true" id="selectShujiKikanJohoIchiranList"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiiiryokikanjohomaster.KoseiShujiiIryoKikanMasterMapperParameter"
            resultMap="resultMap_KoseiShujiiIryoKikanMasterEntity"            fetchSize="500">
        SELECT
        COUNT(*) OVER () AS "totalCount",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode" AS "dbT5911ShujiiIryoKikanJoho_shichosonCode",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" AS "dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryokikanCode" AS "dbT5911ShujiiIryoKikanJoho_iryokikanCode",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho"AS "dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana"AS "dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_yubinNo" AS "dbT5911ShujiiIryoKikanJoho_yubinNo",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jusho" AS "dbT5911ShujiiIryoKikanJoho_jusho",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_telNo" AS "dbT5911ShujiiIryoKikanJoho_telNo",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_faxNo" AS "dbT5911ShujiiIryoKikanJoho_faxNo",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_daihyoshaName" AS "dbT5911ShujiiIryoKikanJoho_daihyoshaName",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_daihyoshaNameKana" AS "dbT5911ShujiiIryoKikanJoho_daihyoshaNameKana",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jokyoFlag" AS "dbT5911ShujiiIryoKikanJoho_jokyoFlag",
        DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonMeisho" AS "dbT7051KoseiShichosonMaster_shichosonMeisho"
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5911ShujiiIryoKikanJohoMapper.noDeleted_DbT5911ShujiiIryoKikanJoho" />) AS DbT5911ShujiiIryoKikanJoho
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7051KoseiShichosonMasterMapper.noDeleted_DbT7051KoseiShichosonMaster" />) AS DbT7051KoseiShichosonMaster
        ON
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode"  =  DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonCode"
        <where>
            1 = 1
            <if test="状況フラグ">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jokyoFlag" = TRUE
            </if>
            <if test="!状況フラグ">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jokyoFlag" = FALSE
            </if>
            <if test="uses市町村コード">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode" = #{市町村コード}
            </if>
            <if test="uses主治医医療機関コードFrom">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" <![CDATA[>=]]> #{主治医医療機関コードFrom}
            </if>
            <if test="uses主治医医療機関コードTo">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" <![CDATA[<=]]> #{主治医医療機関コードTo}
            </if>

            <if test="uses医療機関名称">
                <if test="医療機関名称前方一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" LIKE #{医療機関名称} || '%'
                </if>
                <if test="医療機関名称後方一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" LIKE '%' || #{医療機関名称}
                </if>
                <if test="医療機関名称完全一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" = #{医療機関名称}
                </if>
                <if test="医療機関名称部分一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" LIKE '%' || #{医療機関名称} || '%'
                </if>
            </if>
            <if test="uses医療機関カナ名称">
                <if test="医療機関カナ名称前方一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" LIKE #{医療機関カナ名称} || '%'
                </if>
                <if test="医療機関カナ名称後方一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" LIKE '%' ||  #{医療機関カナ名称}
                </if>
                <if test="医療機関カナ名称完全一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" = #{医療機関カナ名称}
                </if>
                <if test="医療機関カナ名称部分一致Flag">
                    AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" LIKE '%' || #{医療機関カナ名称} || '%'
                </if>
            </if>
            <if test="市町村識別ID利用Flag">
                AND DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonShokibetsuID" NOT IN (
                SELECT "shichosonShokibetsuID"
                FROM rgdb."DbT7051KoseiShichosonMaster"
                WHERE  "shichosonCode"=(
                SELECT "shichosonCode"  FROM rgdb."DbT7051KoseiShichosonMaster"
                WHERE "shichosonShokibetsuID" = #{市町村識別ID}
                )
                AND "shichosonShokibetsuID" <![CDATA[<>]]> #{市町村識別ID}
                )
            </if>
        </where>
        ORDER BY
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode"
        LIMIT #{saidaiHyojiKensu}
    </select>

    <resultMap id="ResultMap_DbT5911ShujiiIryoKikanJohoEntity" type="jp.co.ndensan.reams.db.dbz.entity.db.basic.DbT5911ShujiiIryoKikanJohoEntity" autoMapping="true">
        <id property="shichosonCode" column="dbT5911ShujiiIryoKikanJoho_shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler"/>
        <id property="shujiiIryokikanCode" column="dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" typeHandler="jp.co.ndensan.reams.db.dbz.entity.typehandlers.ShujiiIryokikanCodeTypeHandler"/>
        <result property="insertDantaiCd" column="dbT5911ShujiiIryoKikanJoho_insertDantaiCd" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="insertTimestamp" column="dbT5911ShujiiIryoKikanJoho_insertTimestamp" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RDateTimeTypeHandler"/>
        <result property="insertReamsLoginId" column="dbT5911ShujiiIryoKikanJoho_insertReamsLoginId" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="insertContextId" column="dbT5911ShujiiIryoKikanJoho_insertContextId" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.UUIDTypeHandler"/>
        <result property="isDeleted" column="dbT5911ShujiiIryoKikanJoho_isDeleted" />
        <result property="updateCount" column="dbT5911ShujiiIryoKikanJoho_updateCount" />
        <result property="lastUpdateTimestamp" column="dbT5911ShujiiIryoKikanJoho_lastUpdateTimestamp" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RDateTimeTypeHandler"/>
        <result property="lastUpdateReamsLoginId" column="dbT5911ShujiiIryoKikanJoho_lastUpdateReamsLoginId" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="iryokikanCode" column="dbT5911ShujiiIryoKikanJoho_iryokikanCode" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.IryoKikanCodeTypeHandler"/>
        <result property="iryoKikanMeisho" column="dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="iryoKikanMeishoKana" column="dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="yubinNo" column="dbT5911ShujiiIryoKikanJoho_yubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="jusho" column="dbT5911ShujiiIryoKikanJoho_jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="telNo" column="dbT5911ShujiiIryoKikanJoho_telNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="faxNo" column="dbT5911ShujiiIryoKikanJoho_faxNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="daihyoshaName" column="dbT5911ShujiiIryoKikanJoho_daihyoshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="daihyoshaNameKana" column="dbT5911ShujiiIryoKikanJoho_daihyoshaNameKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jokyoFlag" column="dbT5911ShujiiIryoKikanJoho_jokyoFlag" />
    </resultMap>

    <select resultOrdered="true" id="selectShujiiIryoKikanJohoList"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiiiryokikanjohomaster.KoseiShujiiIryoKikanMasterMapperParameter"
            resultMap="ResultMap_DbT5911ShujiiIryoKikanJohoEntity" fetchSize="500">
        SELECT
        DbT5911ShujiiIryoKikanJoho.*
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5911ShujiiIryoKikanJohoMapper.noDeleted_DbT5911ShujiiIryoKikanJoho" />) AS DbT5911ShujiiIryoKikanJoho
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7051KoseiShichosonMasterMapper.noDeleted_DbT7051KoseiShichosonMaster" />) AS DbT7051KoseiShichosonMaster
        ON
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode"  =  DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonCode"
        <where>
            1 = 1
            <if test="状況フラグ">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jokyoFlag" = TRUE
            </if>
            <if test="!状況フラグ">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_jokyoFlag" = FALSE
            </if>
            <if test="uses市町村コード">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode" = #{市町村コード}
            </if>
            <if test="uses主治医医療機関コードFrom">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" <![CDATA[>=]]> #{主治医医療機関コードFrom}
            </if>
            <if test="uses主治医医療機関コードTo">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" <![CDATA[<=]]> #{主治医医療機関コードTo}
            </if>
            <if test="uses医療機関名称">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" LIKE '%' || #{医療機関名称} || '%'
            </if>
            <if test="uses医療機関カナ名称">
                AND DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" LIKE '%' || #{医療機関カナ名称} || '%'
            </if>
        </where>
        ORDER BY
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode",
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode"
        <if test="usesSaidaiHyojiKensu">
            LIMIT #{saidaiHyojiKensu}
        </if>
    </select>

    <resultMap id="resultMap_KoseiShujiiIryoKikanMasterEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.shujiiiryokikanjohomaster.KoseiShujiiIryoKikanMasterRelateEntity" autoMapping="true">
        <id property="shichosonCode" column="dbT5911ShujiiIryoKikanJoho_shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler"/>
        <id property="shujiiIryokikanCode" column="dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="totalCount" column="totalCount" />
        <result property="iryokikanCode" column="dbT5911ShujiiIryoKikanJoho_iryokikanCode" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.IryoKikanCodeTypeHandler"/>
        <result property="iryoKikanMeisho" column="dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="iryoKikanMeishoKana" column="dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="yubinNo" column="dbT5911ShujiiIryoKikanJoho_yubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler"/>
        <result property="jusho" column="dbT5911ShujiiIryoKikanJoho_jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="telNo" column="dbT5911ShujiiIryoKikanJoho_telNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="faxNo" column="dbT5911ShujiiIryoKikanJoho_faxNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler"/>
        <result property="daihyoshaName" column="dbT5911ShujiiIryoKikanJoho_daihyoshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="daihyoshaNameKana" column="dbT5911ShujiiIryoKikanJoho_daihyoshaNameKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="jokyoFlag" column="dbT5911ShujiiIryoKikanJoho_jokyoFlag" />
        <result property="shichosonMeisho" column="dbT7051KoseiShichosonMaster_shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    </resultMap>
</mapper>
