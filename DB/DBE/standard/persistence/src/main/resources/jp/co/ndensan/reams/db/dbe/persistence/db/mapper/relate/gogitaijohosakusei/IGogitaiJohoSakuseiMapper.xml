<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 合議体情報のマッピング用XMLです。 -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.gogitaijohosakusei.IGogitaiJohoSakuseiMapper">

    <select id="getGogitaiJohoSakuseiGridList" parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatis.param.gogitaijohosakusei.GogitaiJohoSakuseiParameter" resultMap="resultMap_GogitaiJohoSakuseiRelateEntity" fetchSize="500">
        <include refid="selectGogitaiJohoSakuseiGridList" />        
    </select>
    <sql id="selectGogitaiJohoSakuseiGridList">
        SELECT
            DbT5591GogitaiJoho."gogitaiNo" as "dbT5591GogitaiJoho_gogitaiNo",
            DbT5591GogitaiJoho."gogitaiYukoKikanKaishiYMD" as "dbT5591GogitaiJoho_gogitaiYukoKikanKaishiYMD",
            DbT5591GogitaiJoho."gogitaiMei" as "dbT5591GogitaiJoho_gogitaiMei",
            DbT5591GogitaiJoho."gogitaiYukoKikanShuryoYMD" as "dbT5591GogitaiJoho_gogitaiYukoKikanShuryoYMD",
            DbT5591GogitaiJoho."gogitaiKaishiYoteiTime" as "dbT5591GogitaiJoho_gogitaiKaishiYoteiTime",
            DbT5591GogitaiJoho."gogitaiShuryoYoteiTime" as "dbT5591GogitaiJoho_gogitaiShuryoYoteiTime",
            DbT5591GogitaiJoho."shinsakaiKaisaiBashoCode" as "dbT5591GogitaiJoho_shinsakaiKaisaiBashoCode",
            DbT5591GogitaiJoho."shinsakaiYoteiTeiin" as "dbT5591GogitaiJoho_shinsakaiYoteiTeiin",
            DbT5591GogitaiJoho."shinsakaiJidoWariateTeiin" as "dbT5591GogitaiJoho_shinsakaiJidoWariateTeiin",
            DbT5591GogitaiJoho."shinsakaiIinTeiin" as "dbT5591GogitaiJoho_shinsakaiIinTeiin",
            DbT5591GogitaiJoho."gogitaiSeishinkaSonzaiFlag" as "dbT5591GogitaiJoho_gogitaiSeishinkaSonzaiFlag",
            DbT5591GogitaiJoho."gogitaiDummyFlag" as "dbT5591GogitaiJoho_gogitaiDummyFlag",
            DbT5592ShinsakaiKaisaiBashoJoho."shinsakaiKaisaiBashoName" as "dbT5592ShinsakaiKaisaiBashoJoho_shinsakaiKaisaiBashoName"
        FROM
            rgdb."DbT5591GogitaiJoho" AS DbT5591GogitaiJoho
        LEFT JOIN
            rgdb."DbT5592ShinsakaiKaisaiBashoJoho" AS DbT5592ShinsakaiKaisaiBashoJoho
        ON
        DbT5591GogitaiJoho."shinsakaiKaisaiBashoCode" = DbT5592ShinsakaiKaisaiBashoJoho."shinsakaiKaisaiBashoCode"
        <where>
            AND DbT5591GogitaiJoho."isDeleted" <![CDATA[<>]]> true
            <if test="is現在有効な合議体のみ">
                AND DbT5591GogitaiJoho."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> #{nowDate}
                AND #{nowDate} <![CDATA[<=]]> DbT5591GogitaiJoho."gogitaiYukoKikanShuryoYMD"
            </if>
        </where>
        ORDER BY 
            DbT5591GogitaiJoho."gogitaiNo"
    </sql>
    
    
    <select id="getShinsainList" parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatis.param.gogitaijohosakusei.GogitaiJohoSakuseiParameter" resultMap="resultMap_GogitaiJohoSakuseiRelateEntity" fetchSize="500">
        SELECT
            DbT5593GogitaiWariateIinJoho."gogitaichoKubunCode" AS "dbT5593GogitaiWariateIinJoho_gogitaichoKubunCode",
            DbT5593GogitaiWariateIinJoho."shinsakaiIinCode" AS "dbT5593GogitaiWariateIinJoho_shinsakaiIinCode",
            DbT5594ShinsakaiIinJoho."shinsakaiIinShimei" AS "dbT5594ShinsakaiIinJoho_shinsakaiIinShimei",
            DbT5593GogitaiWariateIinJoho."substituteFlag" AS "dbT5593GogitaiWariateIinJoho_substituteFlag"
        FROM
            rgdb."DbT5593GogitaiWariateIinJoho" AS DbT5593GogitaiWariateIinJoho
        LEFT JOIN rgdb."DbT5594ShinsakaiIinJoho" AS DbT5594ShinsakaiIinJoho
            ON DbT5593GogitaiWariateIinJoho."shinsakaiIinCode" = DbT5594ShinsakaiIinJoho."shinsakaiIinCode"
        WHERE
                    DbT5593GogitaiWariateIinJoho."gogitaiNo" = #{合議体番号}
            AND DbT5593GogitaiWariateIinJoho."gogitaiYukoKikanKaishiYMD" = #{合議体有効期間開始年月日}
        ORDER BY DbT5593GogitaiWariateIinJoho."gogitaichoKubunCode" ASC, DbT5593GogitaiWariateIinJoho."shinsakaiIinCode" DESC
    </select>
    
    
    <select id="getGogitaiJohoForCSV" parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatis.param.gogitaijohosakusei.GogitaiJohoSakuseiParameter" resultMap="resultMap_GogitaiJohoSakuseiRelateEntity" fetchSize="500">
        <include refid="selectGogitaiJohoForCSV" />        
    </select>
    <sql id="selectGogitaiJohoForCSV">
        SELECT
            DbT5591GogitaiJoho."gogitaiNo" as "dbT5591GogitaiJoho_gogitaiNo",
            DbT5591GogitaiJoho."gogitaiYukoKikanKaishiYMD" as "dbT5591GogitaiJoho_gogitaiYukoKikanKaishiYMD",
            DbT5591GogitaiJoho."gogitaiMei" as "dbT5591GogitaiJoho_gogitaiMei",
            DbT5591GogitaiJoho."gogitaiYukoKikanShuryoYMD" as "dbT5591GogitaiJoho_gogitaiYukoKikanShuryoYMD",
            DbT5591GogitaiJoho."gogitaiKaishiYoteiTime" as "dbT5591GogitaiJoho_gogitaiKaishiYoteiTime",
            DbT5591GogitaiJoho."gogitaiShuryoYoteiTime" as "dbT5591GogitaiJoho_gogitaiShuryoYoteiTime",
            DbT5591GogitaiJoho."shinsakaiKaisaiBashoCode" as "dbT5591GogitaiJoho_shinsakaiKaisaiBashoCode",
            DbT5591GogitaiJoho."shinsakaiYoteiTeiin" as "dbT5591GogitaiJoho_shinsakaiYoteiTeiin",
            DbT5591GogitaiJoho."shinsakaiJidoWariateTeiin" as "dbT5591GogitaiJoho_shinsakaiJidoWariateTeiin",
            DbT5591GogitaiJoho."shinsakaiIinTeiin" as "dbT5591GogitaiJoho_shinsakaiIinTeiin",
            DbT5591GogitaiJoho."gogitaiSeishinkaSonzaiFlag" as "dbT5591GogitaiJoho_gogitaiSeishinkaSonzaiFlag",
            DbT5591GogitaiJoho."gogitaiDummyFlag" as "dbT5591GogitaiJoho_gogitaiDummyFlag",
            DbT5593GogitaiWariateIinJoho."gogitaichoKubunCode" AS "dbT5593GogitaiWariateIinJoho_gogitaichoKubunCode",
            DbT5593GogitaiWariateIinJoho."shinsakaiIinCode" AS "dbT5593GogitaiWariateIinJoho_shinsakaiIinCode",
            DbT5593GogitaiWariateIinJoho."substituteFlag" AS "dbT5593GogitaiWariateIinJoho_substituteFlag"
        FROM
            rgdb."DbT5591GogitaiJoho" AS DbT5591GogitaiJoho
        LEFT JOIN
            rgdb."DbT5593GogitaiWariateIinJoho" AS DbT5593GogitaiWariateIinJoho
        ON
        DbT5591GogitaiJoho."gogitaiNo" = DbT5593GogitaiWariateIinJoho."gogitaiNo"
        <where>
            AND DbT5591GogitaiJoho."isDeleted" <![CDATA[<>]]> true
            <if test="is現在有効な合議体のみ">
                AND DbT5591GogitaiJoho."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> #{nowDate}
                AND #{nowDate} <![CDATA[<=]]> DbT5591GogitaiJoho."gogitaiYukoKikanShuryoYMD"
            </if>
        </where>
        ORDER BY 
            DbT5591GogitaiJoho."gogitaiNo"
    </sql>
    
    <select id="getKaisaiBashoJohoCount" parameterType="jp.co.ndensan.reams.uz.uza.lang.RString" resultType="int">
        SELECT 
            COUNT(0)
        FROM 
            rgdb."DbT5592ShinsakaiKaisaiBashoJoho" AS DbT5592ShinsakaiKaisaiBashoJoho
        WHERE 
            DbT5592ShinsakaiKaisaiBashoJoho."shinsakaiKaisaiBashoCode" = #{shinsakaiKaisaiBashoCode} 
    </select>
    
    <select id="getShinsakaiIinJohoCount" parameterType="jp.co.ndensan.reams.uz.uza.lang.RString" resultType="int">
        SELECT 
            COUNT(0)
        FROM 
            rgdb."DbT5594ShinsakaiIinJoho" AS DbT5594ShinsakaiIinJoho
        WHERE 
            DbT5594ShinsakaiIinJoho."shinsakaiIinCode" = #{shinsakaiIinCode} 
    </select>
    
    <select id="getGogitaiJohoCount" parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatis.param.gogitaijohosakusei.GogitaiJohoSakuseiParameter" resultType="int">
        SELECT 
            COUNT(0)
        FROM 
            rgdb."DbT5591GogitaiJoho" AS DbT5591GogitaiJoho
        WHERE 
            DbT5591GogitaiJoho."gogitaiNo" = #{合議体番号} AND
            DbT5591GogitaiJoho."gogitaiYukoKikanKaishiYMD" = #{合議体有効期間開始年月日}
    </select>
    
    <select id="getGogitaiWariateIinJohoCount" parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatis.param.gogitaijohosakusei.GogitaiJohoSakuseiParameter" resultType="int">
        SELECT 
            COUNT(0)
        FROM 
            rgdb."DbT5593GogitaiWariateIinJoho" AS DbT5593GogitaiWariateIinJoho
        WHERE 
            DbT5593GogitaiWariateIinJoho."gogitaiNo" = #{合議体番号} AND
            DbT5593GogitaiWariateIinJoho."gogitaiYukoKikanKaishiYMD" = #{合議体有効期間開始年月日} AND
            DbT5593GogitaiWariateIinJoho."shinsakaiIinCode" = #{審査会委員コード}
    </select>

    <resultMap id="resultMap_GogitaiJohoSakuseiRelateEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.gogitaijohosakusei.GogitaiJohoSakuseiRelateEntity" autoMapping="true">
        <result property="gogitaiNo" column="dbT5591GogitaiJoho_gogitaiNo" />
        <result property="gogitaiYukoKikanKaishiYMD" column="dbT5591GogitaiJoho_gogitaiYukoKikanKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="gogitaiMei" column="dbT5591GogitaiJoho_gogitaiMei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="gogitaiYukoKikanShuryoYMD" column="dbT5591GogitaiJoho_gogitaiYukoKikanShuryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="gogitaiKaishiYoteiTime" column="dbT5591GogitaiJoho_gogitaiKaishiYoteiTime" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="gogitaiShuryoYoteiTime" column="dbT5591GogitaiJoho_gogitaiShuryoYoteiTime" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shinsakaiKaisaiBashoCode" column="dbT5591GogitaiJoho_shinsakaiKaisaiBashoCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shinsakaiYoteiTeiin" column="dbT5591GogitaiJoho_shinsakaiYoteiTeiin" />
        <result property="shinsakaiJidoWariateTeiin" column="dbT5591GogitaiJoho_shinsakaiJidoWariateTeiin" />
        <result property="shinsakaiIinTeiin" column="dbT5591GogitaiJoho_shinsakaiIinTeiin" />
        <result property="gogitaiSeishinkaSonzaiFlag" column="dbT5591GogitaiJoho_gogitaiSeishinkaSonzaiFlag" />
        <result property="gogitaiDummyFlag" column="dbT5591GogitaiJoho_gogitaiDummyFlag" />
        <result property="shinsakaiKaisaiBashoName" column="dbT5592ShinsakaiKaisaiBashoJoho_shinsakaiKaisaiBashoName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="shinsakaiIinCode" column="dbT5593GogitaiWariateIinJoho_shinsakaiIinCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
        <result property="gogitaichoKubunCode" column="dbT5593GogitaiWariateIinJoho_gogitaichoKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
        <result property="substituteFlag" column="dbT5593GogitaiWariateIinJoho_substituteFlag" />
        <result property="shinsakaiIinShimei" column="dbT5594ShinsakaiIinJoho_shinsakaiIinShimei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
    </resultMap>
</mapper>
