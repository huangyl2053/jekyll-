<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- どのマッパーインターフェースと対応するかを指定する -->
<!-- @reamsid_L DBE-0170-010 wangkun -->

<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.shinsakaitoroku.IShinsakaiTorokuMapper">
    <select resultOrdered="true" id="get審査会登録" resultMap="resultMap_ShinsakaiTorokuRelateEntity" 
            parameterType="jp.co.ndensan.reams.db.dbz.definition.mybatisprm.yokaigoninteitasklist.YokaigoNinteiTaskListParameter" fetchSize="500">
        SELECT
            DbT5101."shinseishoKanriNo",
            DbT5101."hihokenshaNo",
            DbT5101."hihokenshaName",
            DbT5101."ninteiShinseiShinseijiKubunCode",
            DbT5101."ninteiShinseiHoreiKubunCode",
            DbT5101."ninteiShinseiYMD",
            DbT5101."shinsakaiYusenWaritsukeKubunCode",
            DbT7051."shichosonMeisho",
            DbT5105."ninteichosaKanryoYMD",
            DbT5105."ikenshoTorokuKanryoYMD",
            DbT5105."maskingKanryoYMD",
            DbT5105."ninteiShinsakaiKanryoYMD",
            DbT5105."ninteiShinsakaiWariateKanryoYMD",
            DbT5501."shinsakaiKaisaiYoteiYMD",
            DbT5501."shinsakaiKaishiYoteiTime",
            DbT5501."shinsakaiKaisaiNo",
            DbT5501."gogitaiNo",
            DbT5502."shinsakaiWariateYMD",
            DbT5591."gogitaiMei"
        FROM
            rgdb."DbT5101NinteiShinseiJoho" DbT5101
            INNER  JOIN  rgdb."DbT7051KoseiShichosonMaster" DbT7051
                ON  DbT7051."shoKisaiHokenshaNo" = DbT5101."shoKisaiHokenshaNo"
            INNER  JOIN  rgdb."DbT5105NinteiKanryoJoho" DbT5105
                ON  DbT5105."shinseishoKanriNo" = DbT5101."shinseishoKanriNo"
            LEFT   JOIN  rgdb."DbT5502ShinsakaiWariateJoho" DbT5502
                ON  DbT5502."shinseishoKanriNo" = DbT5101."shinseishoKanriNo"
            LEFT   JOIN  rgdb."DbT5501ShinsakaiKaisaiYoteiJoho" DbT5501
                ON  DbT5501."shinsakaiKaisaiNo" = DbT5502."shinsakaiKaisaiNo"
            LEFT   JOIN  rgdb."DbT5591GogitaiJoho" DbT5591
                ON DbT5591."gogitaiNo" = DbT5501."gogitaiNo"
                AND DbT5591."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]>  DbT5501."shinsakaiKaisaiYoteiYMD"
                AND DbT5591."gogitaiYukoKikanShuryoYMD" <![CDATA[>=]]>  DbT5501."shinsakaiKaisaiYoteiYMD"
        WHERE
                (DbT5105."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
            AND DbT5105."ninteiShinseiJohoTorokuKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ninteichosaIraiKanryoYMD" IS NOT NULL
            AND DbT5105."ninteichosaIraiKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ninteichosaIraiKanryoYMD" IS NOT NULL
            AND DbT5105."ninteichosaIraiKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ikenshoSakuseiIraiKanryoYMD" IS NOT NULL
            AND DbT5105."ikenshoSakuseiIraiKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ikenshoTorokuKanryoYMD" IS NOT NULL
            AND DbT5105."ikenshoTorokuKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ichijiHanteiKanryoYMD" IS NOT NULL
            AND DbT5105."ichijiHanteiKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."maskingKanryoYMD" IS NOT NULL
            AND DbT5105."maskingKanryoYMD" <![CDATA[<>]]> '')
            AND (DbT5105."ninteiShinsakaiKanryoYMD" IS NULL
            OR  DbT5105."ninteiShinsakaiKanryoYMD" = '')
            AND (DbT5105."centerSoshinYMD" IS NULL
            OR  DbT5105."centerSoshinYMD" = '')
            AND DbT5101."shoriJotaiKubun" in (#{通常},#{延期})
            AND DbT5101."logicalDeletedFlag" = FALSE            
        <if test="状態区分 == 1" >
            AND (DbT5502."shinsakaiWariateYMD" is NULL
            OR  DbT5502."shinsakaiWariateYMD" = '')
        </if>
        <if test="状態区分 == 2" >
            AND (DbT5502."shinsakaiWariateYMD" is NOT NULL
            AND  DbT5502."shinsakaiWariateYMD" <![CDATA[<>]]> '')
        </if>
        ORDER BY  DbT5101."hihokenshaKana",
                  DbT5101."ninteiShinseiYMD",
                  DbT5101."shoKisaiHokenshaNo"
    </select>
    <resultMap id="resultMap_ShinSaKaiToRoKuRelate" type="jp.co.ndensan.reams.db.dbz.entity.db.relate.yokaigoninteitasklist.ShinSaKaiToRoKuRelate" autoMapping="true">
        <association property="要介護認定完了情報EntityLsit" resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5105NinteiKanryoJohoMapper.ResultMap_DbT5105NinteiKanryoJohoEntity"/>
    </resultMap>
    <select resultOrdered="true" id="get前審査会登録" resultMap="resultMap_ShinSaKaiToRoKuRelate" 
            parameterType="jp.co.ndensan.reams.db.dbz.definition.mybatisprm.yokaigoninteitasklist.YokaigoNinteiTaskListParameter" fetchSize="500">
        SELECT
            <include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5105NinteiKanryoJohoMapper.allColumns_DbT5105NinteiKanryoJoho" />
        FROM
            rgdb."DbT5101NinteiShinseiJoho"
            INNER  JOIN  rgdb."DbT7051KoseiShichosonMaster" DbT7051
                ON  DbT7051."shoKisaiHokenshaNo" = "DbT5101NinteiShinseiJoho"."shoKisaiHokenshaNo"
            INNER  JOIN  rgdb."DbT5105NinteiKanryoJoho"
                ON  "DbT5105NinteiKanryoJoho"."shinseishoKanriNo" = "DbT5101NinteiShinseiJoho"."shinseishoKanriNo"
            LEFT  JOIN  rgdb."DbT5502ShinsakaiWariateJoho" DbT5502
                ON  DbT5502."shinseishoKanriNo" = "DbT5101NinteiShinseiJoho"."shinseishoKanriNo"
            LEFT  JOIN  rgdb."DbT5501ShinsakaiKaisaiYoteiJoho" DbT5501
                ON  DbT5501."shinsakaiKaisaiNo" = DbT5502."shinsakaiKaisaiNo"
            LEFT   JOIN  rgdb."DbT5591GogitaiJoho" DbT5591
                ON DbT5591."gogitaiNo" = DbT5501."gogitaiNo"
                AND DbT5591."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]>  DbT5501."shinsakaiKaisaiYoteiYMD"
                AND DbT5591."gogitaiYukoKikanShuryoYMD" <![CDATA[>=]]>  DbT5501."shinsakaiKaisaiYoteiYMD"
        WHERE
                ("DbT5105NinteiKanryoJoho"."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ninteiShinseiJohoTorokuKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ninteichosaIraiKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ninteichosaIraiKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ninteichosaIraiKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ninteichosaIraiKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ikenshoSakuseiIraiKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ikenshoSakuseiIraiKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ikenshoTorokuKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ikenshoTorokuKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ichijiHanteiKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."ichijiHanteiKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."maskingKanryoYMD" IS NOT NULL
            AND "DbT5105NinteiKanryoJoho"."maskingKanryoYMD" <![CDATA[<>]]> '')
            AND ("DbT5105NinteiKanryoJoho"."ninteiShinsakaiKanryoYMD" IS NULL
            OR  "DbT5105NinteiKanryoJoho"."ninteiShinsakaiKanryoYMD" = '')
            AND ("DbT5105NinteiKanryoJoho"."centerSoshinYMD" IS NULL
            OR  "DbT5105NinteiKanryoJoho"."centerSoshinYMD" = '')
            AND "DbT5101NinteiShinseiJoho"."shoriJotaiKubun" in (#{通常},#{延期})
            AND "DbT5101NinteiShinseiJoho"."logicalDeletedFlag" = FALSE            
        <if test="状態区分 == 1" >
            AND (DbT5502."shinsakaiWariateYMD" is NULL
            OR  DbT5502."shinsakaiWariateYMD" = '')
        </if>
        <if test="状態区分 == 2" >
            AND (DbT5502."shinsakaiWariateYMD" is NOT NULL
            AND  DbT5502."shinsakaiWariateYMD" <![CDATA[<>]]> '')
        </if>
        ORDER BY  "DbT5101NinteiShinseiJoho"."hihokenshaKana",
                  "DbT5101NinteiShinseiJoho"."ninteiShinseiYMD",
                  "DbT5101NinteiShinseiJoho"."shoKisaiHokenshaNo"
    </select>
    <resultMap id="resultMap_ShinsakaiTorokuRelateEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.shinsakaitoroku.ShinsakaiTorokuRelateEntity" autoMapping="true">
    <result property="shinseishoKanriNo"  column="shinseishoKanriNo" typeHandler="jp.co.ndensan.reams.db.dbx.entity.typehandlers.ShinseishoKanriNoTypeHandler"/>
    <result property="hihokenshaNo"  column="hihokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    <result property="hihokenshaName"  column="hihokenshaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaMeishoTypeHandler"/>
    <result property="shinseijiKubunCode"  column="ninteiShinseiShinseijiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
    <result property="ninteiShinseiHoreiKubunCode"  column="ninteiShinseiHoreiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
    <result property="ninteiShinseiYMD"  column="ninteiShinseiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="yusenWaritsukeKubunCode"  column="shinsakaiYusenWaritsukeKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler"/>
    <result property="shichosonMeisho"  column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    <result property="ninteichosaKanryoYMD"  column="ninteichosaKanryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="ikenshoTorokuKanryoYMD"  column="ikenshoTorokuKanryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="maskingKanryoYMD"  column="maskingKanryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="ninteiShinsakaiKanryoYMD"  column="ninteiShinsakaiKanryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="kaiWariateKanryoYMD"  column="ninteiShinsakaiWariateKanryoYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="shinsakaiKaishiYoteiTime"  column="shinsakaiKaishiYoteiTime" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    <result property="shinsakaiKaisaiYoteiYMD"  column="shinsakaiKaisaiYoteiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="shinsakaiKaisaiNo"  column="shinsakaiKaisaiNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
    <result property="gogitaiNo"  column="gogitaiNo" />
    <result property="shinsakaiWariateYMD"  column="shinsakaiWariateYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
    <result property="gogitaiMei"  column="gogitaiMei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler"/>
   </resultMap>

</mapper>
