<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： DbT5115Imageマスタとエンティティのマッピング用XMLです。 -->
<!-- @reamsid_L DBE-0250-010 suguangjun -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.shujiijoho.IShujiiMasterJohoMapper">
    <resultMap id="resultMap_ShujiiJohoRelateEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.shujiijoho.ShujiiMasterRelateEntity" autoMapping="true">
        <id property="shichosonCode" column="dbT5912ShujiiJoho_shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler" />
        <id property="shujiiCode" column="dbT5912ShujiiJoho_shujiiCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <id property="shujiiIryokikanCode" column="dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shichosonMeisho" column="dbT7051KoseiShichosonMaster_shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shujiiName" column="dbT5912ShujiiJoho_shujiiName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shujiiKana" column="dbT5912ShujiiJoho_shujiiKana" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="iryoKikanMeisho" column="dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shinryokaName" column="dbT5912ShujiiJoho_shinryokaName" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shiteiiFlag" column="dbT5912ShujiiJoho_shiteiiFlag" />
        <result property="jokyoFlag" column="dbT5912ShujiiJoho_jokyoFlag" />
        <result property="yubinNo" column="dbT5912ShujiiJoho_yubinNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.YubinNoTypeHandler" />
        <result property="jusho" column="dbT5912ShujiiJoho_jusho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.AtenaJushoTypeHandler" />
        <result property="telNo" column="dbT5912ShujiiJoho_telNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler" />
        <result property="faxNo" column="dbT5912ShujiiJoho_faxNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.TelNoTypeHandler" />
        <result property="seibetsu" column="dbT5912ShujiiJoho_seibetsu" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>

    <select resultOrdered="true" id="selectShujiiIchiranList"
            resultMap="resultMap_ShujiiJohoRelateEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterMapperParameter" fetchSize="500">
        SELECT
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode" AS dbT5912ShujiiJoho_shichosonCode,
        DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonMeisho" AS dbT7051KoseiShichosonMaster_shichosonMeisho,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName" AS dbT5912ShujiiJoho_shujiiName,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana" AS dbT5912ShujiiJoho_shujiiKana,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode" AS dbT5912ShujiiJoho_shujiiCode,
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode" AS dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode,
        DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" AS dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shinryokaName" AS dbT5912ShujiiJoho_shinryokaName,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shiteiiFlag" AS dbT5912ShujiiJoho_shiteiiFlag,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_jokyoFlag" AS dbT5912ShujiiJoho_jokyoFlag,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_yubinNo" AS dbT5912ShujiiJoho_yubinNo,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_jusho" AS dbT5912ShujiiJoho_jusho,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_telNo" AS dbT5912ShujiiJoho_telNo,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_faxNo" AS dbT5912ShujiiJoho_faxNo,
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_seibetsu" AS dbT5912ShujiiJoho_seibetsu
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5912ShujiiJohoMapper.noDeleted_DbT5912ShujiiJoho" />) AS DbT5912ShujiiJoho
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7051KoseiShichosonMasterMapper.noDeleted_DbT7051KoseiShichosonMaster" />) AS DbT7051KoseiShichosonMaster
        ON
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode"  =  DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonCode"
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5911ShujiiIryoKikanJohoMapper.noDeleted_DbT5911ShujiiIryoKikanJoho" />) AS DbT5911ShujiiIryoKikanJoho
        ON
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode" = DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode"
        AND DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" = DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode"
        <where>
            <if test="uses市町村コード">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode" = #{市町村コード}
            </if>
            <if test="状況フラグ">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_jokyoFlag" = true
            </if>
            <if test="!状況フラグ">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_jokyoFlag" = false
            </if>
            <if test="uses主治医医療機関コードFrom">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" <![CDATA[>=]]> #{主治医医療機関コードFrom}
            </if>
            <if test="uses主治医医療機関コードTo">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" <![CDATA[<=]]> #{主治医医療機関コードTo}
            </if>
            <if test="uses主治医医療機関名称">
                <if test="uses0主治医医療機関名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho"  LIKE #{主治医医療機関名称} || '%'
                </if>
                <if test="uses1主治医医療機関名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho"  LIKE '%' || #{主治医医療機関名称}
                </if>
                <if test="uses2主治医医療機関名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho" = #{主治医医療機関名称}
                </if>
                <if test="uses3主治医医療機関名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho"  LIKE '%' || #{主治医医療機関名称} || '%'
                </if>
            </if>
            <if test="uses主治医医療機関カナ名称">
                <if test="uses0主治医医療機関カナ名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana"  LIKE #{主治医医療機関カナ名称} || '%'
                </if>
                <if test="uses1主治医医療機関カナ名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana"  LIKE '%' || #{主治医医療機関カナ名称}
                </if>
                <if test="uses2主治医医療機関カナ名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana" = #{主治医医療機関カナ名称}
                </if>
                <if test="uses3主治医医療機関カナ名称">
                    AND
                    DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana"  LIKE '%' || #{主治医医療機関カナ名称} || '%'
                </if>
            </if>

            <if test="uses主治医コードFrom">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode" <![CDATA[>=]]> #{主治医コードFrom}
            </if>
            <if test="uses主治医コードTo">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode" <![CDATA[<=]]> #{主治医コードTo}
            </if>
            <if test="uses主治医氏名">
                <if test="uses0主治医氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName"  LIKE #{主治医氏名} || '%'
                </if>
                <if test="uses1主治医氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName"  LIKE '%' || #{主治医氏名}
                </if>
                <if test="uses2主治医氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName" = #{主治医氏名}
                </if>
                <if test="uses3主治医氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName"  LIKE '%' || #{主治医氏名} || '%'
                </if>
            </if>
            <if test="uses主治医カナ氏名">
                <if test="uses0主治医カナ氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana"  LIKE #{主治医カナ氏名} || '%'
                </if>
                <if test="uses1主治医カナ氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana"  LIKE '%' || #{主治医カナ氏名}
                </if>
                <if test="uses2主治医カナ氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana" = #{主治医カナ氏名}
                </if>
                <if test="uses3主治医カナ氏名">
                    AND
                    DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana"  LIKE '%' || #{主治医カナ氏名} || '%'
                </if>
            </if>
            <if test="市町村識別ID利用Flag">
                AND DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonShokibetsuID" NOT IN (
                        SELECT "shichosonShokibetsuID"
                        FROM rgdb."DbT7051KoseiShichosonMaster"
                        WHERE  "shichosonCode"=(
                                                SELECT "shichosonCode"  FROM rgdb."DbT7051KoseiShichosonMaster"
                                                WHERE "shichosonShokibetsuID" = #{市町村識別ID}
                                                )
                        AND "shichosonShokibetsuID" <![CDATA[<>]]> #{市町村識別ID}
                        )
            </if>
        </where>
        ORDER BY
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode",
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode",
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode"
        <if test="usesSaidaiHyojiKensu">
            LIMIT #{saidaiHyojiKensu}
        </if>
    </select>
    <!--主治医情報の重複チェック-->
    <select resultOrdered="true" id="selectShujiiJohoCount"
            resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterSearchParameter" fetchSize="500">
        SELECT
        COUNT(0)
        FROM
        rgdb."DbT5912ShujiiJoho" AS DbT5912
        WHERE
        DbT5912."shichosonCode" = #{市町村コード}
        AND
        DbT5912."shujiiIryokikanCode" = #{主治医医療機関コード}
        AND
        DbT5912."shujiiCode" = #{主治医コード}
    </select>

    <!-- 主治医情報の削除処理-->
    <select resultOrdered="true" id="selectNinteiShinseiJohoCount"
            resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterSearchParameter">
        SELECT
        COUNT(0)
        FROM
        rgdb."DbT5101NinteiShinseiJoho" AS DbT5101Nintei
        INNER JOIN
        rgdb."DbT7051KoseiShichosonMaster" AS DbT7051Kosei
        ON
        DbT7051Kosei."shoKisaiHokenshaNo" = DbT5101Nintei."shoKisaiHokenshaNo"
        WHERE
        DbT7051Kosei."shichosonCode" = #{市町村コード}
        AND
        DbT5101Nintei."shujiiIryokikanCode" = #{主治医医療機関コード}
        AND
        DbT5101Nintei."shujiiCode" = #{主治医コード}
    </select>

    <select resultOrdered="true" id="selectIkenshoIraiJohoCount"
            resultType="int"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterSearchParameter">
        SELECT
        COUNT(0)
        FROM
        rgdb."DbT5301ShujiiIkenshoIraiJoho"	AS DbT5301Shuji
        INNER JOIN
        rgdb."DbT5101NinteiShinseiJoho" AS DbT5101Nintei
        ON
        DbT5301Shuji."shinseishoKanriNo" = DbT5101Nintei."shinseishoKanriNo"
        INNER JOIN
        rgdb."DbT7051KoseiShichosonMaster" AS DbT7051Kosei
        ON
        DbT7051Kosei."shoKisaiHokenshaNo" = DbT5101Nintei."shoKisaiHokenshaNo"
        WHERE
        DbT7051Kosei."shichosonCode" = #{市町村コード}
        AND
        DbT5301Shuji."shujiiIryokikanCode" = #{主治医医療機関コード}
        AND
        DbT5301Shuji."shujiiCode" = #{主治医コード}
    </select>

    <select resultOrdered="true" id="selectShujiiJohoList"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterMapperParameter"
            resultMap="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5912ShujiiJohoMapper.ResultMap_DbT5912ShujiiJohoEntity"  fetchSize="500" >
        SELECT
        DbT5912ShujiiJoho.*
        FROM
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5912ShujiiJohoMapper.noDeleted_DbT5912ShujiiJoho" />) AS DbT5912ShujiiJoho
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbx.persistence.db.mapper.basic.IDbT7051KoseiShichosonMasterMapper.noDeleted_DbT7051KoseiShichosonMaster" />) AS DbT7051KoseiShichosonMaster
        ON
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode"  =  DbT7051KoseiShichosonMaster."dbT7051KoseiShichosonMaster_shichosonCode"
        INNER JOIN
        (<include refid="jp.co.ndensan.reams.db.dbz.persistence.db.mapper.basic.IDbT5911ShujiiIryoKikanJohoMapper.noDeleted_DbT5911ShujiiIryoKikanJoho" />) AS DbT5911ShujiiIryoKikanJoho
        ON
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode" = DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shichosonCode"
        AND DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" = DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_shujiiIryokikanCode"
        <where>
            <if test="uses市町村コード">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode" = #{市町村コード}
            </if>
            <if test="状況フラグ">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_jokyoFlag" = true
            </if>
            <if test="!状況フラグ">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_jokyoFlag" = false
            </if>
            <if test="uses主治医医療機関コードFrom">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" <![CDATA[>=]]> #{主治医医療機関コードFrom}
            </if>
            <if test="uses主治医医療機関コードTo">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode" <![CDATA[<=]]> #{主治医医療機関コードTo}
            </if>
            <if test="uses主治医医療機関名称">
                AND
                DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeisho"  LIKE '%' || #{主治医医療機関名称} || '%'
            </if>
            <if test="uses主治医医療機関カナ名称">
                AND
                DbT5911ShujiiIryoKikanJoho."dbT5911ShujiiIryoKikanJoho_iryoKikanMeishoKana"  LIKE '%' || #{主治医医療機関カナ名称} || '%'
            </if>

            <if test="uses主治医コードFrom">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode" <![CDATA[>=]]> #{主治医コードFrom}
            </if>
            <if test="uses主治医コードTo">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode" <![CDATA[<=]]> #{主治医コードTo}
            </if>
            <if test="uses主治医氏名">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiName"  LIKE '%' || #{主治医氏名} || '%'
            </if>
            <if test="uses主治医カナ氏名">
                AND
                DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiKana"  LIKE '%' || #{主治医カナ氏名} || '%'
            </if>
        </where>
        ORDER BY
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shichosonCode",
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiIryokikanCode",
        DbT5912ShujiiJoho."dbT5912ShujiiJoho_shujiiCode";
    </select>

    <select resultOrdered="true" id="selectShujiiIryoKikanJoho"
            resultType="jp.co.ndensan.reams.uz.uza.lang.RString"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterSearchParameter">
        SELECT
          "DbT5911ShujiiIryoKikanJoho"."iryoKikanMeisho"
        FROM
         rgdb."DbT5911ShujiiIryoKikanJoho"
        WHERE
         "DbT5911ShujiiIryoKikanJoho"."isDeleted" = FALSE
        AND  "DbT5911ShujiiIryoKikanJoho"."shichosonCode" = #{市町村コード}
        AND  "DbT5911ShujiiIryoKikanJoho"."shujiiIryokikanCode" = #{主治医医療機関コード}
    </select>

    <select resultOrdered="true" id="selectShichosonMeisho"
            resultType="jp.co.ndensan.reams.uz.uza.lang.RString"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.shujiijoho.ShujiiMasterSearchParameter" fetchSize="500">
        SELECT
        DbT7051KoseiShi."shichosonMeisho"
        FROM
        rgdb."DbT7051KoseiShichosonMaster" AS DbT7051KoseiShi
        WHERE
        DbT7051KoseiShi."shichosonCode" = #{市町村コード}
    </select>
</mapper>
