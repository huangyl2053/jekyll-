<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 報告資料発行のマッピング用XMLです。 -->
<!-- @reamsid_L DBE-1450-010 wangxiaodong -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.hokokushiryosakusei.IHokokuShiryoSakuSeiMapper">

    <select id="getJisshiJokyoTokei"
            resultMap="hokokushiryosakusei_JisshiJokyoTokei"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.JisshiJokyoTokeiMyBatisParameter"
            fetchSize="500">
        SELECT F."shichosonMeisho"
        ,A."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
        ,COUNT(A."shoKisaiHokenshaNo") AS countKensu
        FROM
        rgdb."DbT5101NinteiShinseiJoho" A
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" B
        ON A."shinseishoKanriNo" = B."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" C
        ON A."shinseishoKanriNo" = C."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5202NinteichosahyoGaikyoChosa" G
        ON A."shinseishoKanriNo" = G."shinseishoKanriNo"
        AND G."ninteichosaRirekiNo" = (
        SELECT MAX("ninteichosaRirekiNo")
        FROM rgdb."DbT5202NinteichosahyoGaikyoChosa"
        WHERE "shinseishoKanriNo" = A."shinseishoKanriNo")
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" D
        ON A."shinseishoKanriNo" = D."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5501ShinsakaiKaisaiYoteiJoho" E
        ON D."shinsakaiKaisaiNo" = E."shinsakaiKaisaiNo"
        INNER JOIN rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" H
        ON D."shinsakaiKaisaiNo" = H."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" F
        ON A."shoKisaiHokenshaNo" = F."shoKisaiHokenshaNo"
        WHERE A."logicalDeletedFlag" = FALSE
        <if test="!isEmptyHokensyaNo">
            AND A."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND A."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND A."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND A."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND A."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND A."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND A."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND A."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        <choose>
            <when test="#{niTeiJokyo=='0'}">
                <choose>
                    <when test="isTaishoTsukiKubun">
                        AND SUBSTR(B."ninteiShinseiJohoTorokuKanryoYMD", 1, 6) = #{taishoNendoYM}
                    </when>
                    <otherwise>
                        <choose>
                            <when test="!isEmptyTaishoGeppiFrom">
                                <if test="isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."ninteiShinseiJohoTorokuKanryoYMD"
                                </if>
                                <if test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."ninteiShinseiJohoTorokuKanryoYMD"
                                    AND B."ninteiShinseiJohoTorokuKanryoYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </if>
                            </when>
                            <otherwise>
                                AND B."ninteiShinseiJohoTorokuKanryoYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                            </otherwise>
                        </choose>
                    </otherwise>
                </choose>
            </when>
            <when test="#{niTeiJokyo=='1'}">
                <choose>
                    <when test="isTaishoTsukiKubun">
                        AND SUBSTR(G."ninteichosaJisshiYMD", 1, 6) = #{taishoNendoYM}
                    </when>
                    <otherwise>
                        <choose>
                            <when test="!isEmptyTaishoGeppiFrom">
                                <if test="isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> G."ninteichosaJisshiYMD"
                                </if>
                                <if test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> G."ninteichosaJisshiYMD"
                                    AND G."ninteichosaJisshiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </if>
                            </when>
                            <otherwise>
                                AND G."ninteichosaJisshiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                            </otherwise>
                        </choose>
                    </otherwise>
                </choose>
            </when>
            <when test="#{niTeiJokyo=='2'}">
                <choose>
                    <when test="isTaishoTsukiKubun">
                        AND SUBSTR(B."ninteiShinsakaiWariateKanryoYMD", 1, 6) = #{taishoNendoYM}
                    </when>
                    <otherwise>
                        <choose>
                            <when test="!isEmptyTaishoGeppiFrom">
                                <if test="isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."ninteiShinsakaiWariateKanryoYMD"
                                </if>
                                <if test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."ninteiShinsakaiWariateKanryoYMD"
                                    AND B."ninteichosaJisshiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </if>
                            </when>
                            <otherwise>
                                AND B."ninteiShinsakaiWariateKanryoYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                            </otherwise>
                        </choose>
                    </otherwise>
                </choose>
            </when>
            <when test="#{niTeiJokyo=='3'}">
                <choose>
                    <when test="isTaishoTsukiKubun">
                        AND SUBSTR(C."nijiHanteiYMD", 1, 6) = #{taishoNendoYM}
                    </when>
                    <otherwise>
                        <choose>
                            <when test="!isEmptyTaishoGeppiFrom">
                                <if test="isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> C."nijiHanteiYMD"
                                </if>
                                <if test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> C."nijiHanteiYMD"
                                    AND B."nijiHanteiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </if>
                            </when>
                            <otherwise>
                                AND C."nijiHanteiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                            </otherwise>
                        </choose>
                    </otherwise>
                </choose>
            </when>
        </choose>
        <if test="isShinseiji">
            AND A."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND A."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        F."shichosonCode"
        ,F."shichosonMeisho"
        ,A."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        F."shichosonCode"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getGogitaiNo"
            resultMap="hokokushiryosakusei_gogitaiNo"
            parameterType="jp.co.ndensan.reams.uz.uza.lang.FlexibleDate"
            fetchSize="500">
        SELECT dbt5591."gogitaiNo"
        ,dbt5591."gogitaiMei"
        ,dbt5591."gogitaiYukoKikanKaishiYMD"
        FROM rgdb."DbT5591GogitaiJoho" dbt5591
        WHERE dbt5591."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> #{systemDate}
        AND #{systemDate} <![CDATA[<=]]> dbt5591."gogitaiYukoKikanShuryoYMD"
    </select>

    <select id="getJigyoJyokyoHokokuHeader"
            resultMap="hokokushiryosakusei_JigyoJyokyoHokokuHeader"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.JigyoJyokyoHokokuMyBatisParameter"
            fetchSize="500">
        SELECT SUBSTR(B."nijiHanteiYMD", 1, 6) AS nijiHanteiYM
        ,B."nijiHanteiYokaigoJotaiKubunCode"
        ,A."hihokenshaKubunCode"
        ,A."age"
        ,A."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
        ,C."shichosonCode"
        ,C."shichosonMeisho"
        FROM rgdb."DbT5101NinteiShinseiJoho" A
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" B
        ON A."shinseishoKanriNo" = B."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" D
        ON A."shinseishoKanriNo" = D."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" C
        ON A."shoKisaiHokenshaNo" =  C."shoKisaiHokenshaNo"
        WHERE A."logicalDeletedFlag" = FALSE
        AND D."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND D."ninteichosaIraiKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        AND D."ikenshoSakuseiIraiKanryoYMD" IS NOT NULL
        AND D."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND D."ichijiHanteiKanryoYMD" IS NOT NULL
        AND D."maskingKanryoYMD" IS NOT NULL
        AND D."ninteiShinsakaiWariateKanryoYMD" IS NOT NULL
        AND D."ninteiShinsakaiKanryoYMD" IS NOT NULL
        AND A."hihokenshaKubunCode" IN ('1', '2')
        AND B."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
        <if test="!isEmptyHokensyaNo">
            AND A."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(B."nijiHanteiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."nijiHanteiYMD"
                                    AND B."nijiHanteiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> B."nijiHanteiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND B."nijiHanteiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>
        <if test="isShinseiji">
            AND A."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND A."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        C."shichosonCode"
        ,C."shichosonMeisho"
        ,A."shoKisaiHokenshaNo"
        ,A."hihokenshaKubunCode"
        ,A."age"
        ,B."nijiHanteiYokaigoJotaiKubunCode"
        ,B."nijiHanteiYMD"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        C."shichosonCode"
        ,A."shoKisaiHokenshaNo"
        ,A."hihokenshaKubunCode"
        ,A."age"
        <if test="isShinseiji">
            ,A."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,A."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getJigyoJyokyoHokoku"
            resultMap="hokokushiryosakusei_JigyoJyokyoHokoku"
            fetchSize="500">
        SELECT A."nijiHanteiYM"
        ,A."shichosonCode"
        ,A."shichosonMeisho"
        ,A."shoKisaiHokenshaNo"
        ,A."nijiHanteiYokaigoJotaiKubunCode"
        ,A."hihokenshaKubunCode"
        ,COUNT(0) AS countHokensha
        FROM "JigyoJyokyoHokokuTemp" A
        GROUP BY
        A."nijiHanteiYM"
        ,A."shichosonCode"
        ,A."shichosonMeisho"
        ,A."shoKisaiHokenshaNo"
        ,A."nijiHanteiYokaigoJotaiKubunCode"
        ,A."hihokenshaKubunCode"
        ORDER BY
        A."nijiHanteiYM"
        ,A."shichosonCode"
        ,A."hihokenshaKubunCode"
        ,A."nijiHanteiYokaigoJotaiKubunCode"
    </select>

    <select id="getSinsakaiHanteiJyokyoHeader"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyoHeader"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.SinsakaiHanteiJyokyoMyBatisParameter"
            fetchSize="500">
        SELECT S.* ,
        (SELECT COUNT(1)
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" G
        WHERE S.gogitaiNo = G."gogitaiNo"
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(G."shinsakaiKaisaiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> G."shinsakaiKaisaiYMD"
                                    AND G."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> G."shinsakaiKaisaiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND G."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>) AS shinsakaiKaisaiNoCount
        FROM
        (SELECT A."gogitaiNo" AS gogitaiNo
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        ,C."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ,MIN(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMin
        ,MAX(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMax
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" D
        ON D."shinseishoKanriNo" = C."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" E
        ON A."gogitaiNo" = E."gogitaiNo"
        AND E."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> E."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" F
        ON C."shoKisaiHokenshaNo" = F."shoKisaiHokenshaNo"
        WHERE D."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        AND D."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND D."ichijiHanteiKanryoYMD" IS NOT NULL
        AND D."maskingKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(A."shinsakaiKaisaiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                    AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        <if test="isShinseiji">
            AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND C."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        A."gogitaiNo"
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        ,C."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        A."gogitaiNo"
        ,F."shichosonCode"
        ,C."shoKisaiHokenshaNo"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>) AS S
    </select>

    <select id="getSinsakaiHanteiJyokyo"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyo"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.SinsakaiHanteiJyokyoMyBatisParameter"
            fetchSize="500">
        SELECT E."ichijiHanteiKekkaCode"
        , D."nijiHanteiYokaigoJotaiKubunCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        , COUNT(C."hihokenshaNo") AS hihokenshaCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" D
        ON C."shinseishoKanriNo" = D."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5116IchijiHanteiKekkaJoho" E
        ON C."shinseishoKanriNo" = E."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" F
        ON C."shinseishoKanriNo" = F."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" G
        ON A."gogitaiNo" = G."gogitaiNo"
        AND G."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> G."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" H
        ON C."shoKisaiHokenshaNo" = H."shoKisaiHokenshaNo"
        WHERE A."gogitaiNo" = #{gogitaiNo}
        AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
        AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
        AND H."shichosonCode" = #{shichosonCode}
        AND F."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND F."ninteichosaKanryoYMD" IS NOT NULL
        AND F."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND F."ichijiHanteiKanryoYMD" IS NOT NULL
        AND F."maskingKanryoYMD" IS NOT NULL
        AND F."ninteichosaKanryoYMD" IS NOT NULL
        AND E."ichijiHanteiKekkaCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
        AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25', '31')
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <if test="isShinseiji">
            AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND C."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        E."ichijiHanteiKekkaCode"
        , D."nijiHanteiYokaigoJotaiKubunCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        E."ichijiHanteiKekkaCode"
        , D."nijiHanteiYokaigoJotaiKubunCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getJotaikubumbetsuhanteiHeader"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyoHeader"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.SinsakaiHanteiJyokyoMyBatisParameter"
            fetchSize="500">
        SELECT A."gogitaiNo"
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ,MIN(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMin
        ,MAX(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMax
        ,COUNT(A."shinsakaiKaisaiNo") AS shinsakaiKaisaiNoCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" D
        ON D."shinseishoKanriNo" = C."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" E
        ON A."gogitaiNo" = E."gogitaiNo"
        AND E."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> E."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" F
        ON C."shoKisaiHokenshaNo" = F."shoKisaiHokenshaNo"
        WHERE D."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        AND D."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND D."ichijiHanteiKanryoYMD" IS NOT NULL
        AND D."maskingKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(A."shinsakaiKaisaiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                    AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        <if test="isShinseiji">
            AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND C."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        A."gogitaiNo"
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        A."gogitaiNo"
        ,F."shichosonCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getShinsahanteinoHenkojokyoHeader"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyoHeader"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.ShinsahanteinoHenkojokyoMyBatisParameter"
            fetchSize="500">
        SELECT A."gogitaiNo"
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ,MIN(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMin
        ,MAX(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMax
        ,COUNT(A."shinsakaiKaisaiNo") AS shinsakaiKaisaiNoCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" D
        ON D."shinseishoKanriNo" = C."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" E
        ON A."gogitaiNo" = E."gogitaiNo"
        AND E."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> E."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" F
        ON C."shoKisaiHokenshaNo" = F."shoKisaiHokenshaNo"
        WHERE D."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        AND D."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND D."ichijiHanteiKanryoYMD" IS NOT NULL
        AND D."maskingKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(A."shinsakaiKaisaiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                    AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        <if test="isShinseiji">
            AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND C."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        A."gogitaiNo"
        ,E."gogitaiMei"
        ,F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        A."gogitaiNo"
        ,F."shichosonCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getShinsahanteinoHenkojokyo"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyo"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.ShinsahanteinoHenkojokyoMyBatisParameter"
            fetchSize="500">
        SELECT D."nijiHanteiYokaigoJotaiKubunCode"
        , COUNT(C."hihokenshaNo") AS hihokenshaCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        INNER JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        INNER JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" D
        ON C."shinseishoKanriNo" = D."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" E
        ON C."shinseishoKanriNo" = E."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" F
        ON A."gogitaiNo" = F."gogitaiNo"
        AND F."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> F."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" G
        ON C."shoKisaiHokenshaNo" = G."shoKisaiHokenshaNo"
        WHERE A."gogitaiNo" = #{gogitaiNo}
        AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
        AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
        AND G."shichosonCode" = #{shichosonCode}
        AND E."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND E."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND E."ichijiHanteiKanryoYMD" IS NOT NULL
        AND E."maskingKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND D."nijiHanteiYMD" IS NOT NULL
        AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <if test="isShinseiji">
            <choose>
                <when test="#{ninteiShinseiKubun == '1'}">
                    AND C."ninteiShinseiShinseijiKubunCode" = '1'
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND C."ninteiShinseiShinseijiKubunCode" = '2'
                </when>
                <when test="#{ninteiShinseiKubun == '3'}">
                    AND C."ninteiShinseiShinseijiKubunCode" = '3'
                </when>
            </choose>
        </if>
        <if test="isHorei">
            <choose>
                <when test="#{ninteiShinseiKubun == '1'}">
                    AND C."ninteiShinseiHoreiKubunCode" = '1'
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND C."ninteiShinseiHoreiKubunCode" = '2'
                </when>
                <when test="#{ninteiShinseiKubun == '3'}">
                    AND C."ninteiShinseiHoreiKubunCode" = '3'
                </when>
            </choose>
        </if>
        <if test="!isShinseiji and !isHorei">
            <choose>
                <when test="#{ninteiShinseiKubun == '1'}">
                    AND (C."ninteiShinseiShinseijiKubunCode" = '1'
                    OR C."ninteiShinseiHoreiKubunCode" = '1')
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND (C."ninteiShinseiShinseijiKubunCode" = '2'
                    OR C."ninteiShinseiHoreiKubunCode" = '2')
                </when>
                <when test="#{ninteiShinseiKubun == '3'}">
                    AND (C."ninteiShinseiShinseijiKubunCode" = '3'
                    OR C."ninteiShinseiHoreiKubunCode" = '3')
                </when>
            </choose>
        </if>
        <choose>
            <when test="yukoKikan == 3">
                AND D."nijiHanteiNinteiYukoKikan" = 3
            </when>
            <when test="yukoKikan == 6">
                AND D."nijiHanteiNinteiYukoKikan" = 6
            </when>
            <when test="yukoKikan == 12">
                AND D."nijiHanteiNinteiYukoKikan" = 12
            </when>
            <when test="yukoKikan == 24">
                AND D."nijiHanteiNinteiYukoKikan" = 24
            </when>
            <otherwise>
                AND D."nijiHanteiNinteiYukoKikan" NOT IN (3, 6, 12, 24)
            </otherwise>
        </choose>
        GROUP BY D."nijiHanteiYokaigoJotaiKubunCode"
        ORDER BY D."nijiHanteiYokaigoJotaiKubunCode"
    </select>

    <select id="getShinsahanteinoHenkojokyoYukoKikanEntyo"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyo"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.ShinsahanteinoHenkojokyoMyBatisParameter"
            fetchSize="500">
        SELECT D."nijiHanteiYokaigoJotaiKubunCode"
        , COUNT(C."hihokenshaNo") AS hihokenshaCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        INNER JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        INNER JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" D
        ON C."shinseishoKanriNo" = D."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" E
        ON C."shinseishoKanriNo" = E."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" F
        ON A."gogitaiNo" = F."gogitaiNo"
        AND F."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> F."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" G
        ON C."shoKisaiHokenshaNo" = G."shoKisaiHokenshaNo"
        LEFT JOIN rgdb."DbT5121ShinseiRirekiJoho" H
        ON C."shinseishoKanriNo" = H."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" I
        ON I."shinseishoKanriNo" = H."zenkaiShinseishoKanriNo"
        WHERE A."gogitaiNo" = #{gogitaiNo}
        AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
        AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
        AND G."shichosonCode" = #{shichosonCode}
        AND E."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND E."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND E."ichijiHanteiKanryoYMD" IS NOT NULL
        AND E."maskingKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND D."nijiHanteiYMD" IS NOT NULL
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <if test="isShinseiji">
            <choose>
                <when test="#{ninteiShinseiKubun == '0'}">
                    AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '3')
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND C."ninteiShinseiShinseijiKubunCode" = '2'
                </when>
            </choose>
        </if>
        <if test="isHorei">
            <choose>
                <when test="#{ninteiShinseiKubun == '0'}">
                    AND C."ninteiShinseiHoreiKubunCode" IN ('1', '3')
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND C."ninteiShinseiHoreiKubunCode" = '2'
                </when>
            </choose>
        </if>
        <if test="!isShinseiji and !isHorei">
            <choose>
                <when test="#{ninteiShinseiKubun == '0'}">
                    AND (C."ninteiShinseiShinseijiKubunCode" ('1', '3')
                    OR C."ninteiShinseiHoreiKubunCode" = ('1', '3'))
                </when>
                <when test="#{ninteiShinseiKubun == '2'}">
                    AND (C."ninteiShinseiShinseijiKubunCode" = '2'
                    OR C."ninteiShinseiHoreiKubunCode" = '2')
                </when>
            </choose>
        </if>
        <choose>
            <when test="#{ninteiShinseiKubun == '0'}">
                AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
                AND 6 <![CDATA[<=]]> D."nijiHanteiNinteiYukoKikan"
                AND D."nijiHanteiNinteiYukoKikan" <![CDATA[<=]]> 12
            </when>
            <otherwise>
                <choose>
                    <when test="isJissiZumi">
                        AND (I."nijiHanteiYokaigoJotaiKubunCode" <![CDATA[<>]]> '01'
                        AND D."nijiHanteiYokaigoJotaiKubunCode" <![CDATA[<>]]> '01'
                        AND 12 <![CDATA[<=]]> D."nijiHanteiNinteiYukoKikan"
                        AND D."nijiHanteiNinteiYukoKikan" <![CDATA[<=]]> 24)
                    </when>
                    <otherwise>
                        <choose>
                            <when test="#{jyotaiHenkoKubun == '0'}">
                                AND (I."nijiHanteiYokaigoJotaiKubunCode" IN ('12', '13')
                                AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('12', '13')
                                AND D."nijiHanteiNinteiYukoKikan" = 12)
                            </when>
                            <when test="#{jyotaiHenkoKubun == '1'}">
                                AND (I."nijiHanteiYokaigoJotaiKubunCode" IN ('12', '13')
                                AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('21', '22', '23', '24', '25')
                                AND 6 <![CDATA[<=]]> D."nijiHanteiNinteiYukoKikan"
                                AND D."nijiHanteiNinteiYukoKikan" <![CDATA[<=]]> 12)
                            </when>
                            <when test="#{jyotaiHenkoKubun == '2'}">
                                AND (I."nijiHanteiYokaigoJotaiKubunCode" IN ('21', '22', '23', '24', '25')
                                AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('12', '13')
                                AND 6 <![CDATA[<=]]> D."nijiHanteiNinteiYukoKikan"
                                AND D."nijiHanteiNinteiYukoKikan" <![CDATA[<=]]> 12)
                            </when>
                            <when test="#{jyotaiHenkoKubun == '3'}">
                                AND (I."nijiHanteiYokaigoJotaiKubunCode" IN ('21', '22', '23', '24', '25')
                                AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('21', '22', '23', '24', '25')
                                AND 12 <![CDATA[<=]]> D."nijiHanteiNinteiYukoKikan"
                                AND D."nijiHanteiNinteiYukoKikan" <![CDATA[<=]]> 24)
                            </when>
                        </choose>
                    </otherwise>
                </choose>
            </otherwise>
        </choose>
        GROUP BY D."nijiHanteiYokaigoJotaiKubunCode"
        ORDER BY D."nijiHanteiYokaigoJotaiKubunCode"
    </select>

    <select id="getShinsakaishukeihyoHanteiBetsuHeader"
            resultMap="hokokushiryosakusei_SinsakaiHanteiJyokyoHeader"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.SinsakaiHanteiJyokyoMyBatisParameter"
            fetchSize="500">
        SELECT F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ,MIN(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMin
        ,MAX(A."shinsakaiKaisaiYMD") AS shinsakaiKaisaiYMDMax
        ,COUNT(A."shinsakaiKaisaiNo") AS shinsakaiKaisaiNoCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" D
        ON D."shinseishoKanriNo" = C."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" E
        ON A."gogitaiNo" = E."gogitaiNo"
        AND E."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> E."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" F
        ON C."shoKisaiHokenshaNo" = F."shoKisaiHokenshaNo"
        WHERE D."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        AND D."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND D."ichijiHanteiKanryoYMD" IS NOT NULL
        AND D."maskingKanryoYMD" IS NOT NULL
        AND D."ninteichosaKanryoYMD" IS NOT NULL
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <choose>
            <when test="isTaishoTsukiKubun">
                <if test="!isTaishoGeppiKubun">
                    AND SUBSTR(A."shinsakaiKaisaiYMD", 1, 6) = #{taishoNendoYM}
                </if>
            </when>
            <otherwise>
                <if test="isTaishoGeppiKubun">
                    <choose>
                        <when test="!isEmptyTaishoGeppiFrom">
                            <choose>
                                <when test="!isEmptyTaishoGeppiTo">
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                    AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                                </when>
                                <otherwise>
                                    AND #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
                                </otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
                        </otherwise>
                    </choose>
                </if>
            </otherwise>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        <if test="isShinseiji">
            AND C."ninteiShinseiShinseijiKubunCode" IN ('1', '2', '3')
        </if>
        <if test="isHorei">
            AND C."ninteiShinseiHoreiKubunCode" IN ('1', '2', '3')
        </if>
        GROUP BY
        F."shichosonCode"
        ,F."shichosonMeisho"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
        ORDER BY
        F."shichosonCode"
        <if test="isShinseiji">
            ,C."ninteiShinseiShinseijiKubunCode"
        </if>
        <if test="isHorei">
            ,C."ninteiShinseiHoreiKubunCode"
        </if>
    </select>

    <select id="getShinsakaishukeihyoHanteiBetsu"
            resultMap="hokokushiryosakusei_ShinsakaishukeihyoHanteiBetsu"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.hokokushiryosakusei.SinsakaiHanteiJyokyoMyBatisParameter"
            fetchSize="500">
        SELECT I."nijiHanteiYokaigoJotaiKubunCode" AS zenkaiNijiHantei
        , D."nijiHanteiYokaigoJotaiKubunCode" AS konkaiNijiHantei
        , COUNT(C."hihokenshaNo") AS hihokenshaCount
        FROM rgdb."DbT5511ShinsakaiKaisaiKekkaJoho" A
        LEFT JOIN rgdb."DbT5502ShinsakaiWariateJoho" B
        ON A."shinsakaiKaisaiNo" = B."shinsakaiKaisaiNo"
        LEFT JOIN rgdb."DbT5101NinteiShinseiJoho" C
        ON B."shinseishoKanriNo" = C."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" D
        ON C."shinseishoKanriNo" = D."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5105NinteiKanryoJoho" E
        ON C."shinseishoKanriNo" = E."shinseishoKanriNo"
        LEFT JOIN rgdb."DbT5591GogitaiJoho" F
        ON A."gogitaiNo" = F."gogitaiNo"
        AND F."gogitaiYukoKikanKaishiYMD" <![CDATA[<=]]> TO_CHAR(NOW(), 'YYYYMMDD')
        AND TO_CHAR(NOW(), 'YYYYMMDD') <![CDATA[<=]]> F."gogitaiYukoKikanShuryoYMD"
        LEFT JOIN rgdb."DbT7051KoseiShichosonMaster" G
        ON C."shoKisaiHokenshaNo" = G."shoKisaiHokenshaNo"
        LEFT JOIN rgdb."DbT5121ShinseiRirekiJoho" H
        ON C."shinseishoKanriNo" = H."shinseishoKanriNo"
        INNER JOIN rgdb."DbT5102NinteiKekkaJoho" I
        ON I."shinseishoKanriNo" = H."zenkaiShinseishoKanriNo"
        WHERE #{taishoGeppiFrom} <![CDATA[<=]]> A."shinsakaiKaisaiYMD"
        AND A."shinsakaiKaisaiYMD" <![CDATA[<=]]> #{taishoGeppiTo}
        AND G."shichosonCode" = #{shichosonCode}
        AND E."ninteiShinseiJohoTorokuKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND E."ikenshoTorokuKanryoYMD" IS NOT NULL
        AND E."ichijiHanteiKanryoYMD" IS NOT NULL
        AND E."maskingKanryoYMD" IS NOT NULL
        AND E."ninteichosaKanryoYMD" IS NOT NULL
        AND D."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
        AND I."nijiHanteiYokaigoJotaiKubunCode" IN ('01', '12', '13', '21', '22', '23', '24', '25')
        <if test="!isEmptyHokensyaNo">
            AND C."shoKisaiHokenshaNo" = #{hokensyaNo}
        </if>
        <choose>
            <when test="#{hihokenshaKubun=='0'}">
                AND C."hihokenshaKubunCode" IN ('1', '2', '3')
            </when>
            <when test="#{hihokenshaKubun=='1'}">
                AND C."hihokenshaKubunCode" = '1'
            </when>
            <when test="#{hihokenshaKubun=='2'}">
                AND C."hihokenshaKubunCode" = '2'
            </when>
            <when test="#{hihokenshaKubun=='3'}">
                AND C."hihokenshaKubunCode" = '3'
            </when>
            <when test="#{hihokenshaKubun=='4'}">
                AND C."hihokenshaKubunCode" IN ('1', '2')
            </when>
            <when test="#{hihokenshaKubun=='5'}">
                AND C."hihokenshaKubunCode" IN ('1', '3')
            </when>
            <when test="#{hihokenshaKubun=='6'}">
                AND C."hihokenshaKubunCode" IN ('2', '3')
            </when>
        </choose>
        <if test="!isEmptyGogitaiNo">
            AND A."gogitaiNo" = #{gogitaiNo}
        </if>
        GROUP BY I."nijiHanteiYokaigoJotaiKubunCode"
        ,D."nijiHanteiYokaigoJotaiKubunCode"
        ORDER BY I."nijiHanteiYokaigoJotaiKubunCode"
        ,D."nijiHanteiYokaigoJotaiKubunCode"
    </select>

    <resultMap id="hokokushiryosakusei_JisshiJokyoTokei"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.JisshiJokyoTokeiEntity"
               autoMapping="true">
        <result property="shichosonMeisho" column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shoKisaiHokenshaNo" column="shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="ninteiShinseiShinseijiKubunCode" column="ninteiShinseiShinseijiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="ninteiShinseiHoreiKubunCode" column="ninteiShinseiHoreiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="countKensu" column="countKensu" />
    </resultMap>

    <resultMap id="hokokushiryosakusei_JigyoJyokyoHokokuHeader"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.JigyoJyokyoHokokuHeaderEntity"
               autoMapping="true">
        <result property="nijiHanteiYM" column="nijiHanteiYM" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearMonthTypeHandler" />
        <result property="nijiHanteiYokaigoJotaiKubunCode" column="nijiHanteiYokaigoJotaiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="hihokenshaKubunCode" column="hihokenshaKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="age" column="age" />
        <result property="shoKisaiHokenshaNo" column="shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="ninteiShinseiShinseijiKubunCode" column="ninteiShinseiShinseijiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="ninteiShinseiHoreiKubunCode" column="ninteiShinseiHoreiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="shichosonCode" column="shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler" />
        <result property="shichosonMeisho" column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>

    <resultMap id="hokokushiryosakusei_JigyoJyokyoHokoku"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.JigyoJyokyoHokokuEntity"
               autoMapping="true">
        <result property="nijiHanteiYM" column="nijiHanteiYM" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleYearMonthTypeHandler" />
        <result property="shichosonCode" column="shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler" />
        <result property="shichosonMeisho" column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shoKisaiHokenshaNo" column="shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="nijiHanteiYokaigoJotaiKubunCode" column="nijiHanteiYokaigoJotaiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="hihokenshaKubunCode" column="hihokenshaKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="countHokensha" column="countHokensha" />
    </resultMap>

    <resultMap id="hokokushiryosakusei_gogitaiNo" type="jp.co.ndensan.reams.db.dbz.entity.db.basic.DbT5591GogitaiJohoEntity" autoMapping="true">
        <id column="gogitaiNo" property="gogitaiNo"/>
        <id column="gogitaiYukoKikanKaishiYMD" property="gogitaiYukoKikanKaishiYMD" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.FlexibleDateTypeHandler"/>
        <result property="gogitaiMei" column="gogitaiMei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>

    <resultMap id="hokokushiryosakusei_SinsakaiHanteiJyokyoHeader"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.SinsakaiHanteiJyokyoHeaderEntity"
               autoMapping="true">
        <result property="gogitaiNo" column="gogitaiNo"/>
        <result property="gogitaiMei" column="gogitaiMei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shichosonCode" column="shichosonCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.LasdecCodeTypeHandler" />
        <result property="shichosonMeisho" column="shichosonMeisho" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shoKisaiHokenshaNo" column="shoKisaiHokenshaNo" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="ninteiShinseiShinseijiKubunCode" column="ninteiShinseiShinseijiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="ninteiShinseiHoreiKubunCode" column="ninteiShinseiHoreiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="shinsakaiKaisaiYMDMin" column="shinsakaiKaisaiYMDMin" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shinsakaiKaisaiYMDMax" column="shinsakaiKaisaiYMDMax" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="shinsakaiKaisaiNoCount" column="shinsakaiKaisaiNoCount" />
    </resultMap>

    <resultMap id="hokokushiryosakusei_SinsakaiHanteiJyokyo"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.SinsakaiHanteiJyokyoEntity"
               autoMapping="true">
        <result property="ichijiHanteiKekkaCode" column="ichijiHanteiKekkaCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="nijiHanteiYokaigoJotaiKubunCode" column="nijiHanteiYokaigoJotaiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="ninteiShinseiShinseijiKubunCode" column="ninteiShinseiShinseijiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="ninteiShinseiHoreiKubunCode" column="ninteiShinseiHoreiKubunCode" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="hihokenshaCount" column="hihokenshaCount" />
    </resultMap>
    <resultMap id="hokokushiryosakusei_ShinsakaishukeihyoHanteiBetsu"
               type="jp.co.ndensan.reams.db.dbe.entity.db.relate.hokokushiryosakusei.ShinsakaishukeihyoHanteiBetsuEntity"
               autoMapping="true">
        <result property="zenkaiNijiHantei" column="zenkaiNijiHantei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="konkaiNijiHantei" column="konkaiNijiHantei" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.CodeTypeHandler" />
        <result property="hihokenshaCount" column="hihokenshaCount" />
    </resultMap>
</mapper>
