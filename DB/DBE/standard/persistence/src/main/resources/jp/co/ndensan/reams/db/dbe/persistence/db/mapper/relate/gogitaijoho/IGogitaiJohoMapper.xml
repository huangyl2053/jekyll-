<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 概要： 合議体情報のマッピング用XMLです。 -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.gogitaijoho.IGogitaiJohoMapper">


    <sql id="selectGogitaiJohoEntity">
        SELECT
        FdT1301SeishinTecho.*,
        FdT1309SeishinTechoNini.*
        FROM
        (<include refid="jp.co.ndensan.reams.fd.fdz.persistence.db.mapper.basic.fda.IFdT1301SeishinTechoMapper.selectFdT1301SeishinTechoNotDeleted" />) AS FdT1301SeishinTecho
        LEFT JOIN
        (<include refid="jp.co.ndensan.reams.fd.fdz.persistence.db.mapper.basic.fda.IFdT1309SeishinTechoNiniMapper.selectFdT1309SeishinTechoNiniNotDeleted" />) AS FdT1309SeishinTechoNini
        ON
        FdT1301SeishinTecho."fdT1301SeishinTecho_shikibetsuCode" = FdT1309SeishinTechoNini."fdT1309SeishinTechoNini_shikibetsuCode" and
        FdT1301SeishinTecho."fdT1301SeishinTecho_seishinTechoTimestamp" = FdT1309SeishinTechoNini."fdT1309SeishinTechoNini_seishinTechoTimestamp"
        <where>
            <if test="uses識別コード != null">
                AND FdT1301SeishinTecho."fdT1301SeishinTecho_shikibetsuCode" = #{識別コード}
            </if>
            <if test="uses精神手帳履歴日時 != null">
                and FdT1301SeishinTecho."fdT1301SeishinTecho_seishinTechoTimestamp" = #{精神手帳履歴日時}
            </if>
        </where>
    </sql>
    
    <select id="getGogitaiJohoRelateEntity" 
             resultMap="resultMap_GogitaiJohoRelateEntity" 
             parameterType="jp.co.ndensan.reams.db.dbe.entity.db.relate.gogitaiJoho.GogitaiJohoParameter" fetchSize="500">
     SELECT
        dbT5591GogitaiJoho.*,
        dbT5592ShinsakaiKaisaiBashoJoho.*,
        dbT5593GogitaiWariateIinJoho.*,
        dbT5594ShinsakaiIinJoho.*
     FROM
     (
        SELECT
        <include refid="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5591GogitaiJohoMapper.allColumns_DbT5591GogitaiJoho"/>
        FROM
        rgba."DbT5591GogitaiJoho"
        WHERE
        "gogitaiNo"=#{gogitaiNo}
        AND
        "gogitaiYukoKikanKaishiYMD"=#{gogitaiYukoKikanKaishiYMD}
        AND
        "shinsakaiKaisaiBashoCode"=#{shinsakaiKaisaiBashoCode}
     ) AS dbT5591GogitaiJoho
    LEFT OUTER JOIN
    (
        SELECT
        <include refid="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5592ShinsakaiKaisaiBashoJohoMapper.allColumns_DbT5592ShinsakaiKaisaiBashoJoho"/>
        FROM
        rgba."DbT5592ShinsakaiKaisaiBashoJoho"
     ) AS dbT5592ShinsakaiKaisaiBashoJoho
     ON
        dbT5591GogitaiJoho."dbT5591GogitaiJoho_shinsakaiKaisaiBashoCode" = dbT5592ShinsakaiKaisaiBashoJoho."dbT5592ShinsakaiKaisaiBashoJoho_shinsakaiKaisaiBashoCode"
    LEFT OUTER JOIN
    (
        SELECT
        <include refid="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5593GogitaiWariateIinJohoMapper.allColumns_DbT5593GogitaiWariateIinJoho"/>
        FROM
        rgba."DbT5593GogitaiWariateIinJoho"
    ) AS dbT5593GogitaiWariateIinJoho
    ON
      dbT5591GogitaiJoho."dbT5591GogitaiJoho_gogitaiNo" = dbT5593GogitaiWariateIinJoho."dbT5593GogitaiWariateIinJoho_gogitaiNo"  
      AND
      dbT5591GogitaiJoho."dbT5591GogitaiJoho_gogitaiYukoKikanKaishiYMD" = dbT5593GogitaiWariateIinJoho."dbT5593GogitaiWariateIinJoho_gogitaiYukoKikanKaishiYMD"
   LEFT OUTER JOIN
   (
        SELECT
        <include refid="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5594ShinsakaiIinJohoMapper.allColumns_DbT5594ShinsakaiIinJoho"/>
        FROM
        rgba."DbT5594ShinsakaiIinJoho"
    ) AS dbT5594ShinsakaiIinJoho
    ON
        dbT5593GogitaiWariateIinJoho."dbT5593GogitaiWariateIinJoho_shinsakaiKaisaiBashoCode" =  dbT5594ShinsakaiIinJoho."dbT5594ShinsakaiIinJoho_shinsakaiKaisaiBashoCode"
    ;       
    </select>
    

    <resultMap id="resultMap_GogitaiJohoEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.gogitaijoho.GogitaiJohoRelateEntity" autoMapping="true">
        <id  column="dbT5591GogitaiJoho_shinsakaiKaisaiBashoCode" />
        <id  column="dbT5591GogitaiJoho_gogitaiYukoKikanKaishiYMD"/>
        <association property="gogitaiJohoEntity" 
                     resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5591GogitaiJohoMapper.resultMap_DbT5591GogitaiJohoEntity"/>
        <collection property="shinsakaiKaisaiBashoJohoEntity" 
                    ofType="jp.co.ndensan.reams.db.dbe.entity.db.basic.DbT5592ShinsakaiKaisaiBashoJohoEntity"
                    resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5592ShinsakaiKaisaiBashoJohoMapper.resultMap_DbT5592ShinsakaiKaisaiBashoJohoEntity">
        </collection>
        <collection property="gogitaiWariateIinJohoEntity" 
                    ofType="jp.co.ndensan.reams.db.dbe.entity.db.basic.DbT5593GogitaiWariateIinJohoEntity"
                    resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5593GogitaiWariateIinJohoMapper.resultMap_DbT5593GogitaiWariateIinJohoEntity">
        </collection>
    </resultMap>
    
    <resultMap id="resultMap_GogitaiWariateIinJohoEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.gogitaiWariateIinJoho.GogitaiWariateIinJohoEntity" autoMapping="true">
        <id  column="dbT5593GogitaiWariateIinJoho_shinsakaiKaisaiBashoCode" />
        <association property="gogitaiWariateIinJoho" 
                     resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5593GogitaiWariateIinJohoMapper.resultMap_DbT5593GogitaiWariateIinJohoEntity"/>
        <collection property="shinsakaiKaisaiBashoJohoEntity" 
                    ofType="jp.co.ndensan.reams.db.dbe.entity.db.basic.DbT5594ShinsakaiIinJohoEntity"
                    resultMap="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.basic.IDbT5594ShinsakaiIinJohoMapper.resultMap_DbT5594ShinsakaiIinJohoEntity">
        </collection>
    </resultMap>

</mapper>
