<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- @reamsid_L DBE-0040-010 xuyue -->

<!-- どのマッパーインターフェースと対応するかを指定する -->
<mapper namespace="jp.co.ndensan.reams.db.dbe.persistence.db.mapper.relate.ninnteichousakekkatouroku1.INinnteiChousaKekkaTouroku1RelateMapper">

    <!-- NinteiChosaJohoEntityの項目にマッピングします。-->
    <resultMap id="resultMap_NinteiChosaJohoEntity" type="jp.co.ndensan.reams.db.dbe.entity.db.relate.ninnteichousakekkatouroku1.TempDataEntity" autoMapping="true">
        <result property="temp_厚労省IF識別コード" column="temp_厚労省IF識別コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_認定調査依頼区分コード" column="temp_認定調査依頼区分コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_概況調査テキストイメージ区分" column="temp_概況調査テキストイメージ区分" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_現在の状況コード" column="temp_現在の状況コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_現在のサービス区分コード" column="temp_現在のサービス区分コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_利用施設名" column="temp_利用施設名" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_利用施設住所" column="temp_利用施設住所" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_利用施設電話番号" column="temp_利用施設電話番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_利用施設郵便番号" column="temp_利用施設郵便番号" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_特記" column="temp_特記" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_認定調査回数" column="temp_認定調査回数" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_認定調査委託区分コード" column="temp_認定調査委託区分コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_調査実施場所コード" column="temp_調査実施場所コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_調査実施場所名称" column="temp_調査実施場所名称" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_調査委託先コード" column="temp_調査委託先コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_調査員コード" column="temp_調査員コード" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
        <result property="temp_調査実施年月日" column="temp_調査実施年月日" typeHandler="jp.co.ndensan.reams.uz.uza.util.db.typehandlers.RStringTypeHandler" />
    </resultMap>
    <select resultOrdered="true" id="get認定調査情報"
            resultMap="resultMap_NinteiChosaJohoEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousakekkatouroku1.NinteiChosaJohoMybatisParameter"
            fetchSize="500">
        SELECT
        DbT5101NinteiShinseiJoho."koroshoIfShikibetsuCode"  AS  temp_厚労省IF識別コード,
        DbT5201NinteichosaIraiJoho."ninteichosaIraiKubunCode"  AS  temp_認定調査依頼区分コード,
        DbT5201NinteichosaIraiJoho."ninteichosaIraiKaisu"  AS  temp_認定調査回数,
        DbT5910NinteichosaItakusakiJoho."chosaItakuKubun"  AS  temp_認定調査委託区分コード
        FROM
        rgdb."DbT5101NinteiShinseiJoho"  AS  DbT5101NinteiShinseiJoho
        LEFT JOIN
        rgdb."DbT5201NinteichosaIraiJoho"  AS  DbT5201NinteichosaIraiJoho
        ON  DbT5201NinteichosaIraiJoho."shinseishoKanriNo" = DbT5101NinteiShinseiJoho."shinseishoKanriNo"
        AND DbT5201NinteichosaIraiJoho."ninteichosaIraiRirekiNo" = #{temp_認定調査依頼履歴番号}
        AND DbT5201NinteichosaIraiJoho."logicalDeletedFlag" = FALSE
        LEFT JOIN
        rgdb."DbT7051KoseiShichosonMaster"  AS DbT7051KoseiShichosonMaster
        ON  DbT7051KoseiShichosonMaster."shoKisaiHokenshaNo" = DbT5101NinteiShinseiJoho."shoKisaiHokenshaNo"
        LEFT JOIN
        rgdb."DbT5910NinteichosaItakusakiJoho"  AS  DbT5910NinteichosaItakusakiJoho
        ON  DbT5910NinteichosaItakusakiJoho."shichosonCode" = DbT7051KoseiShichosonMaster."shichosonCode"
        AND DbT5910NinteichosaItakusakiJoho."ninteichosaItakusakiCode" = #{temp_認定調査委託先コード}
        WHERE
        DbT5101NinteiShinseiJoho."shinseishoKanriNo" = #{temp_申請書管理番号}
        AND  DbT5101NinteiShinseiJoho."logicalDeletedFlag" = FALSE
    </select>

    <select resultOrdered="true" id="get既存概況調査情報"
            resultMap="resultMap_NinteiChosaJohoEntity"
            parameterType="jp.co.ndensan.reams.db.dbe.definition.mybatisprm.ninnteichousakekkatouroku1.NinteiChosaJohoMybatisParameter"
            fetchSize="500">
        SELECT
        DbT5202NinteichosahyoGaikyoChosa."gaikyoChosaTextImageKubun" AS temp_概況調査テキストイメージ区分,
        CASE DbT5210NinteichosahyoShisetsuRiyo."shisetsuRiyoFlag"
        WHEN True THEN '在宅'
        ELSE '施設'  END AS temp_現在の状況コード,
        DbT5202NinteichosahyoGaikyoChosa."serviceKubunCode" AS temp_現在のサービス区分コード,
        DbT5202NinteichosahyoGaikyoChosa."riyoShisetsuShimei" AS temp_利用施設名,
        DbT5202NinteichosahyoGaikyoChosa."riyoShisetsuJusho" AS temp_利用施設住所,
        DbT5202NinteichosahyoGaikyoChosa."riyoShisetsuTelNo" AS temp_利用施設電話番号,
        DbT5202NinteichosahyoGaikyoChosa."riyoShisetsuYubinNo" AS temp_利用施設郵便番号,
        DbT5202NinteichosahyoGaikyoChosa."tokki" AS temp_特記,
        DbT5202NinteichosahyoGaikyoChosa."chosaJisshiBashoCode" AS temp_調査実施場所コード,
        DbT5202NinteichosahyoGaikyoChosa."chosaJisshiBashoMeisho" AS temp_調査実施場所名称,
        DbT5202NinteichosahyoGaikyoChosa."chosaItakusakiCode" AS temp_調査委託先コード,
        DbT5202NinteichosahyoGaikyoChosa."chosainCode" AS temp_調査員コード,
        DbT5202NinteichosahyoGaikyoChosa."ninteichosaJisshiYMD" AS temp_調査実施年月日
        FROM
        rgdb."DbT5202NinteichosahyoGaikyoChosa"  AS  DbT5202NinteichosahyoGaikyoChosa
        LEFT JOIN
        rgdb."DbT5210NinteichosahyoShisetsuRiyo"  AS  DbT5210NinteichosahyoShisetsuRiyo
        ON  DbT5202NinteichosahyoGaikyoChosa."shinseishoKanriNo" = DbT5210NinteichosahyoShisetsuRiyo."shinseishoKanriNo"
        AND DbT5202NinteichosahyoGaikyoChosa."ninteichosaRirekiNo" = DbT5210NinteichosahyoShisetsuRiyo."ninteichosaRirekiNo"
        WHERE
        DbT5202NinteichosahyoGaikyoChosa."shinseishoKanriNo" = #{temp_申請書管理番号}
        AND DbT5202NinteichosahyoGaikyoChosa."ninteichosaRirekiNo" = #{temp_認定調査依頼履歴番号}
        AND DbT5210NinteichosahyoShisetsuRiyo."remban" = 1
        ORDER BY temp_概況調査テキストイメージ区分 DESC
        LIMIT (1)
    </select>
</mapper>